@tailwind base;
@tailwind components;
@tailwind utilities;

/* Global CSS Reset & Box Sizing */
*, *::before, *::after {
  box-sizing: border-box;
}

html, body {
  margin: 0;
  padding: 0;
  overflow-x: hidden; /* Prevent horizontal scrolling */
  width: 100%;
  max-width: 100%;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
    'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
    sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Images and Media - Responsive by default */
img, video, iframe, embed, object {
  max-width: 100%;
  height: auto;
}

/* Defensive CSS for flex items */
.flex-item {
  min-width: 0; /* Prevent flex items from pushing out their parents */
}

/* Container utility - Mobile First */
@layer utilities {
  .container-responsive {
    width: 100%;
    max-width: 1280px; /* Adjust based on your design */
    margin-left: auto;
    margin-right: auto;
    padding-left: 1.25rem; /* 20px - safe zone for mobile */
    padding-right: 1.25rem;
  }
  
  @media (min-width: 640px) {
    .container-responsive {
      padding-left: 1.5rem; /* 24px */
      padding-right: 1.5rem;
    }
  }
  
  @media (min-width: 1024px) {
    .container-responsive {
      padding-left: 2rem; /* 32px */
      padding-right: 2rem;
    }
  }
}

/* Adaptive Typography with clamp() - Mobile First */
:root {
  /* Fluid Typography Scale */
  --font-size-xs: clamp(0.75rem, 0.7rem + 0.25vw, 0.875rem); /* 12-14px */
  --font-size-sm: clamp(0.875rem, 0.8rem + 0.375vw, 1rem); /* 14-16px */
  --font-size-base: clamp(1rem, 0.95rem + 0.25vw, 1.125rem); /* 16-18px */
  --font-size-lg: clamp(1.125rem, 1rem + 0.625vw, 1.5rem); /* 18-24px */
  --font-size-xl: clamp(1.25rem, 1.1rem + 0.75vw, 1.875rem); /* 20-30px */
  --font-size-2xl: clamp(1.5rem, 1.3rem + 1vw, 2.25rem); /* 24-36px */
  --font-size-3xl: clamp(1.875rem, 1.5rem + 1.875vw, 3rem); /* 30-48px */
  
  /* Adaptive Spacing */
  --spacing-xs: clamp(0.25rem, 0.2rem + 0.25vw, 0.5rem); /* 4-8px */
  --spacing-sm: clamp(0.5rem, 0.4rem + 0.5vw, 1rem); /* 8-16px */
  --spacing-md: clamp(0.75rem, 0.6rem + 0.75vw, 1.5rem); /* 12-24px */
  --spacing-lg: clamp(1rem, 0.8rem + 1vw, 2rem); /* 16-32px */
  --spacing-xl: clamp(1.5rem, 1.2rem + 1.5vw, 3rem); /* 24-48px */
  
  /* Touch-friendly minimum sizes */
  --touch-target-min: 44px; /* Apple HIG recommendation */
  --touch-target-comfortable: 48px; /* Better for most users */
}

/* Prevent text overflow issues */
p, h1, h2, h3, h4, h5, h6 {
  overflow-wrap: break-word;
  word-wrap: break-word;
}

/* Code blocks should scroll horizontally if needed */
code, pre {
  max-width: 100%;
  overflow-x: auto;
}

/* Hide scrollbar but allow scrolling (for horizontal scroll containers) */
@layer utilities {
  .scrollbar-hide {
    -ms-overflow-style: none;  /* IE and Edge */
    scrollbar-width: none;  /* Firefox */
  }
  
  .scrollbar-hide::-webkit-scrollbar {
    display: none;  /* Chrome, Safari and Opera */
  }
  
  /* Touch manipulation for better mobile performance */
  .touch-manipulation {
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;
  }
  
  /* Icon-only buttons on mobile (<640px) */
  @media (max-width: 639px) {
    .btn-icon-only-mobile .btn-text {
      display: none;
    }
    /* Кнопки с подписью всегда видимой — только адаптивный размер шрифта */
    .btn-label-adaptive.btn-icon-only-mobile .btn-text {
      display: inline;
      font-size: clamp(0.7rem, 2.2vw, 0.875rem);
    }
    .btn-icon-only-mobile {
      padding-left: 0.75rem;
      padding-right: 0.75rem;
      min-width: 44px;
    }
  }
  
  /* Flexible spacing with clamp() */
  .section-spacing {
    padding: clamp(1rem, 0.8rem + 1vw, 2rem);
    margin-bottom: clamp(1rem, 0.8rem + 1vw, 2rem);
  }
  
  .section-spacing-sm {
    padding: clamp(0.75rem, 0.6rem + 0.75vw, 1.5rem);
    margin-bottom: clamp(0.75rem, 0.6rem + 0.75vw, 1.5rem);
  }
  
  /* Background images with proper scaling */
  .bg-responsive {
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
  }
  
  @media (max-width: 639px) {
    .bg-responsive {
      background-size: contain;
    }
  }
}

/* Card layout for tables on mobile */
@media (max-width: 767px) {
  .table-card-mobile {
    display: block;
  }
  
  .table-card-mobile thead {
    display: none;
  }
  
  .table-card-mobile tbody {
    display: block;
  }
  
  .table-card-mobile tr {
    display: block;
    margin-bottom: 1rem;
    background: rgb(30 41 59);
    border-radius: 0.5rem;
    padding: 1rem;
    border: 1px solid rgb(51 65 85);
  }
  
  .table-card-mobile td {
    display: block;
    text-align: left !important;
    padding: 0.5rem 0;
    border: none;
    border-bottom: 1px solid rgb(51 65 85);
  }
  
  .table-card-mobile td:last-child {
    border-bottom: none;
  }
  
  .table-card-mobile td::before {
    content: attr(data-label);
    font-weight: 600;
    color: rgb(148 163 184);
    display: block;
    margin-bottom: 0.25rem;
    font-size: 0.75rem;
    text-transform: uppercase;
  }
}

/* Нижняя панель: отступ под safe area (вырез/индикатор домой) */
.safe-area-pb {
  padding-bottom: max(0.5rem, env(safe-area-inset-bottom, 0px));
}

/* Анимация оверлея бокового меню */
@keyframes sidebarOverlayFadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}
.sidebar-overlay {
  animation: sidebarOverlayFadeIn 0.2s ease-out;
}

/* Анимация смены раздела в личном кабинете */
@keyframes dashboardTabEnter {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
.dashboard-tab-enter {
  animation: dashboardTabEnter 0.28s ease-out;
}

/* Defensive CSS: Prevent flex items from overflowing */
@layer utilities {
  .min-w-0 {
    min-width: 0;
  }
  
  /* Ensure containers don't overflow */
  .overflow-safe {
    overflow-x: hidden;
    overflow-y: auto;
  }
  
  /* Safe text truncation */
  .truncate-safe {
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
    min-width: 0;
  }
}

