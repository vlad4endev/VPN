version: '3.8'

services:
  frontend:
    build:
      context: .
      dockerfile: Dockerfile
    ports:
      - "3001:3001"
    environment:
      # –ù–µ—Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
      - NODE_ENV=production
      - PROXY_PORT=3001
      - ALLOWED_ORIGINS=${ALLOWED_ORIGINS:-http://localhost:5173}
    
    # ‚ö†Ô∏è –í–ê–ñ–ù–û: –°–µ–∫—Ä–µ—Ç—ã —á–µ—Ä–µ–∑ —Ñ–∞–π–ª—ã, –∞ –Ω–µ —á–µ—Ä–µ–∑ environment –Ω–∞–ø—Ä—è–º—É—é
    env_file:
      - .env.production  # –ú–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ volume, –ù–ï –∫–æ–ø–∏—Ä—É–µ—Ç—Å—è –≤ –æ–±—Ä–∞–∑
    
    # –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Docker Secrets –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
    # secrets:
    #   - xui_username
    #   - xui_password
    #   - xui_host
    
    volumes:
      # –ú–æ–Ω—Ç–∏—Ä—É–µ–º .env –∫–∞–∫ volume (–ù–ï –≤–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –æ–±—Ä–∞–∑)
      - ./.env.production:/app/.env.production:ro
    
    restart: unless-stopped
    networks:
      - vpn-network

# ========================================
# üîê DOCKER SECRETS (–¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
# ========================================
# –†–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è Docker Secrets
# secrets:
#   xui_username:
#     file: ./secrets/xui_username.txt
#   xui_password:
#     file: ./secrets/xui_password.txt
#   xui_host:
#     file: ./secrets/xui_host.txt

networks:
  vpn-network:
    driver: bridge
