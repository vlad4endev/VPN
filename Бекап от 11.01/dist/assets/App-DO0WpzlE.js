const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dashboard-CUbPo_Y1.js","assets/firebase-vendor-BkZVVcGE.js","assets/vendor-DMb609Cv.js","assets/react-vendor-6qOBSu6s.js","assets/admin-Vghk5KXC.js"])))=>i.map(i=>d[i]);
import{_ as je,D as bs,d as Qe}from"./dashboard-CUbPo_Y1.js";import{r as m,j as o,c as lt,X as dt,Z as Ze,d as et,J as tt,G as st,k as xs,U as ws,p as Ss}from"./react-vendor-6qOBSu6s.js";import{h as ce,q as Ue,w as Re,j as ue,l as at,d as y,f as Ie,i as Is,g as vs,a as As,b as Cs,e as Ps,G as ys,c as rt,o as Ds,s as se,m as Es,u as O,n as Ns,p as ks,r as Ts,k as Fe}from"./firebase-vendor-BkZVVcGE.js";import{a as js}from"./vendor-DMb609Cv.js";import{l as a,v as Us,a as ct,i as Y,b as Rs,c as Fs}from"./admin-Vghk5KXC.js";import{L as Ls,v as nt,a as it}from"./auth-CRN6UXKx.js";const ot=x=>x?new Date(x).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"–ù–µ —É–∫–∞–∑–∞–Ω–æ",_s=x=>{if(!x||x===0)return"0 B";const A=["B","KB","MB","GB","TB"];let Z=x,ae=0;for(;Z>=1024&&ae<A.length-1;)Z/=1024,ae++;return`${Z.toFixed(2)} ${A[ae]}`},$s=()=>"vladislav4endev@gmail.com".split(",").map(A=>A.trim().toLowerCase()).filter(A=>A.length>0),Os=x=>{if(!x)return!1;const A=x.trim().toLowerCase();return $s().includes(A)},v="skyputh";a.info("App","üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è...");const me=Us();if(me.isValid)a.info("App","‚úÖ –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ");else{const x=ct(me);console.error(`–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
`,x),a.error("App","‚ùå –û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è",{validation:me})}const F={apiKey:"AIzaSyBiqe1iDUOYxFoUgNhtXoPBKdjXuEhlTVY",authDomain:"skypathvpn.firebaseapp.com",projectId:"skypathvpn",storageBucket:"skypathvpn.firebasestorage.app",messagingSenderId:"269116595714",appId:"1:269116595714:web:9f26a4ed0445150a5b911b"};console.log("üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è Firebase:");console.log("  VITE_FIREBASE_API_KEY:",`${F.apiKey.substring(0,10)}...`);console.log("  VITE_FIREBASE_AUTH_DOMAIN:",F.authDomain);console.log("  VITE_FIREBASE_PROJECT_ID:",F.projectId);console.log("  VITE_FIREBASE_STORAGE_BUCKET:",F.storageBucket);console.log("  VITE_FIREBASE_MESSAGING_SENDER_ID:",F.messagingSenderId);console.log("  VITE_FIREBASE_APP_ID:",F.appId);const N={apiKey:F.apiKey,authDomain:F.authDomain,projectId:F.projectId,storageBucket:F.storageBucket,messagingSenderId:F.messagingSenderId,appId:F.appId};if(!N.apiKey||!N.projectId){const x=[];N.apiKey||x.push("VITE_FIREBASE_API_KEY"),N.authDomain||x.push("VITE_FIREBASE_AUTH_DOMAIN"),N.projectId||x.push("VITE_FIREBASE_PROJECT_ID"),N.storageBucket||x.push("VITE_FIREBASE_STORAGE_BUCKET"),N.messagingSenderId||x.push("VITE_FIREBASE_MESSAGING_SENDER_ID"),N.appId||x.push("VITE_FIREBASE_APP_ID"),console.error("‚ùå Firebase –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–µ–ø–æ–ª–Ω–∞—è!"),console.error("–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:",x.join(", ")),console.error(""),console.error("üîß –†–ï–®–ï–ù–ò–ï:"),console.error("1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª .env —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞"),console.error('2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã (–Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç "your_" –∏–ª–∏ "here")'),console.error("3. –û–°–¢–ê–ù–û–í–ò–¢–ï dev —Å–µ—Ä–≤–µ—Ä (Ctrl+C)"),console.error("4. –ó–ê–ü–£–°–¢–ò–¢–ï dev —Å–µ—Ä–≤–µ—Ä –ó–ê–ù–û–í–û: npm run dev"),console.error("5. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ"),console.error(""),console.error("‚ö†Ô∏è  –í–ê–ñ–ù–û: Vite –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¢–û–õ–¨–ö–û –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞!"),console.error("   –ï—Å–ª–∏ –≤—ã –∏–∑–º–µ–Ω–∏–ª–∏ .env –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ù–ï –∑–∞–≥—Ä—É–∑—è—Ç—Å—è!"),a.error("Firebase","–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase –Ω–µ–ø–æ–ª–Ω–∞—è",{missing:x,config:{...N,apiKey:N.apiKey?"***":null}})}let Q=null,D=null,h=null,fe=null,he=null;try{if(N.apiKey&&N.projectId){a.info("Firebase","üî• –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase...");try{Q=Is(N)}catch(x){if(x.code==="app/duplicate-app")Q=vs(),a.debug("Firebase","–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —ç–∫–∑–µ–º–ø–ª—è—Ä Firebase (hot reload)",null);else throw x}D=As(Q),h=Cs(Q);try{Ps(h).catch(x=>{x.code!=="failed-precondition"&&(x.code==="unimplemented"?a.warn("Firebase","–û—Ñ–ª–∞–π–Ω-–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞: –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç",null):a.debug("Firebase","–û—à–∏–±–∫–∞ –≤–∫–ª—é—á–µ–Ω–∏—è –æ—Ñ–ª–∞–π–Ω-–ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏",null,x))})}catch(x){x.code==="failed-precondition"||a.debug("Firebase","–°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤–∫–ª—é—á–µ–Ω–∏–∏ persistence",null,x)}fe=new ys,fe.setCustomParameters({prompt:"select_account"}),a.info("Firebase","‚úÖ Firebase —É—Å–ø–µ—à–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω",{projectId:N.projectId,authDomain:N.authDomain})}else{const x=[];N.apiKey||x.push("apiKey"),N.projectId||x.push("projectId"),he=`–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏: ${x.join(", ")}`,a.warn("Firebase","‚ö†Ô∏è Firebase –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω",{missing:x,hasApiKey:!!N.apiKey,hasProjectId:!!N.projectId})}}catch(x){x.code==="failed-precondition"&&x.message?.includes("persistence")?a.debug("Firebase","–û—à–∏–±–∫–∞ persistence –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (hot reload)",null):(he=x.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞",a.error("Firebase","‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase",null,x),console.error("–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:",{code:x.code,message:x.message,stack:x.stack}))}const Ms=x=>!x||x.trim()===""?"–ò–º—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è":x.trim().length<2?"–ò–º—è –¥–æ–ª–∂–Ω–æ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 2 —Å–∏–º–≤–æ–ª–∞":x.length>100?"–ò–º—è —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω–æ–µ (–º–∞–∫—Å–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤)":/^[a-zA-Z–∞-—è–ê-–Ø—ë–Å\s-]+$/.test(x.trim())?null:"–ò–º—è –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã, –ø—Ä–æ–±–µ–ª—ã –∏ –¥–µ—Ñ–∏—Å—ã",Bs=({configError:x})=>o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950 p-4",children:o.jsxs("div",{className:"max-w-2xl w-full bg-slate-900 rounded-lg shadow-xl p-8 border border-red-800",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx(lt,{className:"w-8 h-8 text-red-400"}),o.jsx("h1",{className:"text-2xl font-bold text-red-400",children:"–û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"})]}),o.jsx("div",{className:"bg-slate-800 rounded p-4 mb-4",children:o.jsx("pre",{className:"text-slate-300 text-sm whitespace-pre-wrap font-mono",children:x})}),o.jsxs("div",{className:"text-slate-400 text-sm space-y-2",children:[o.jsx("p",{children:o.jsx("strong",{className:"text-slate-300",children:"–ß—Ç–æ –¥–µ–ª–∞—Ç—å:"})}),o.jsxs("ol",{className:"list-decimal list-inside space-y-1 ml-2",children:[o.jsxs("li",{children:["–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª ",o.jsx("code",{className:"bg-slate-800 px-2 py-1 rounded",children:".env"})," –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞"]}),o.jsxs("li",{children:["–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø—Ä–∏–º–µ—Ä –∏–∑ ",o.jsx("code",{className:"bg-slate-800 px-2 py-1 rounded",children:".env.example"})," (–µ—Å–ª–∏ –µ—Å—Ç—å)"]}),o.jsx("li",{children:"–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å–≤–æ–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏"}),o.jsx("li",{children:"–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"})]})]})]})}),Le=({onSetView:x})=>o.jsxs("div",{className:"min-h-screen bg-slate-950 text-slate-200 overflow-x-hidden selection:bg-blue-500/30",children:[o.jsx("div",{className:"relative pt-20 pb-16 px-6 lg:px-8 bg-[radial-gradient(circle_at_top,_var(--tw-gradient-stops))] from-blue-900/20 via-slate-950 to-slate-950",children:o.jsxs("div",{className:"max-w-7xl mx-auto text-center",children:[o.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-full bg-blue-500/10 border border-blue-500/20 text-blue-400 text-sm font-bold mb-8 animate-bounce",children:[o.jsx(Ze,{size:14})," –ù–æ–≤—ã–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç –∞–Ω–æ–Ω–∏–º–Ω–æ—Å—Ç–∏"]}),o.jsxs("h1",{className:"text-5xl lg:text-7xl font-black text-white mb-6 tracking-tighter italic",children:[o.jsx("span",{className:"text-blue-600",children:"SKYPATH"})," VPN"]}),o.jsxs("p",{className:"text-xl text-slate-400 max-w-2xl mx-auto mb-10 leading-relaxed",children:["–°—É–ø–µ—Ä–∑–∞—â–∏—â–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª ",o.jsx("span",{className:"text-white font-bold",children:"VLESS"})," –∏ ",o.jsx("span",{className:"text-white font-bold",children:"–æ–±—Ö–æ–¥ –±–µ–ª—ã—Ö —Å–ø–∏—Å–∫–æ–≤ –≤ –†–æ—Å—Å–∏–∏"})," –¥–ª—è –ø–æ–ª–Ω–æ–π —Å–≤–æ–±–æ–¥—ã –≤ —Å–µ—Ç–∏."]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[o.jsx("button",{onClick:()=>x("register"),className:"w-full sm:w-64 bg-blue-600 hover:bg-blue-500 py-5 rounded-3xl font-black text-white text-xl transition-all shadow-2xl shadow-blue-600/30 active:scale-95",children:"–ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É"}),o.jsx("button",{onClick:()=>x("login"),className:"w-full sm:w-64 bg-slate-900 hover:bg-slate-800 py-5 rounded-3xl font-black text-white text-xl border border-slate-800 transition-all active:scale-95",children:"–í–æ–π—Ç–∏ –≤ –∫–∞–±–∏–Ω–µ—Ç"})]})]})}),o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-20 grid grid-cols-1 md:grid-cols-3 gap-8",children:[o.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 p-8 rounded-[2.5rem] group hover:border-blue-500/40 transition-all",children:[o.jsx("div",{className:"bg-blue-500/10 w-14 h-14 rounded-2xl flex items-center justify-center text-blue-500 mb-6 group-hover:scale-110 transition-transform",children:o.jsx(et,{size:28})}),o.jsx("h3",{className:"text-xl font-black text-white mb-3 uppercase tracking-tight",children:"–°—É–ø–µ—Ä–∑–∞—â–∏—â–µ–Ω–Ω—ã–π VLESS"}),o.jsx("p",{className:"text-slate-500 font-medium",children:"–°–∞–º—ã–π —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–±–Ω–∞—Ä—É–∂–∏—Ç—å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ DPI."})]}),o.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 p-8 rounded-[2.5rem] group hover:border-blue-500/40 transition-all",children:[o.jsx("div",{className:"bg-blue-500/10 w-14 h-14 rounded-2xl flex items-center justify-center text-blue-500 mb-6 group-hover:scale-110 transition-transform",children:o.jsx(tt,{size:28})}),o.jsx("h3",{className:"text-xl font-black text-white mb-3 uppercase tracking-tight",children:"–û–±—Ö–æ–¥ –±–µ–ª—ã—Ö —Å–ø–∏—Å–∫–æ–≤"}),o.jsx("p",{className:"text-slate-500 font-medium",children:"–°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è –æ–±—Ö–æ–¥–∞ –±–µ–ª—ã—Ö —Å–ø–∏—Å–∫–æ–≤ –≤ –†–æ—Å—Å–∏–∏, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤ –ª—é–±—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö."})]}),o.jsxs("div",{className:"bg-slate-900/50 border border-slate-800 p-8 rounded-[2.5rem] group hover:border-blue-500/40 transition-all",children:[o.jsx("div",{className:"bg-blue-500/10 w-14 h-14 rounded-2xl flex items-center justify-center text-blue-500 mb-6 group-hover:scale-110 transition-transform",children:o.jsx(st,{size:28})}),o.jsx("h3",{className:"text-xl font-black text-white mb-3 uppercase tracking-tight",children:"–õ–æ–∫–∞—Ü–∏–∏"}),o.jsx("p",{className:"text-slate-500 font-medium",children:"–°–µ—Ä–≤–µ—Ä–∞ –≤ –°–®–ê, –ù–∏–¥–µ—Ä–ª–∞–Ω–¥–∞—Ö, –®–≤–µ–π—Ü–∞—Ä–∏–∏, –ì–µ—Ä–º–∞–Ω–∏–∏ –∏ –†–æ—Å—Å–∏–∏ –¥–ª—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–∏–Ω–≥–∞."})]})]}),o.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-20",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h2",{className:"text-4xl lg:text-5xl font-black text-white mb-4 tracking-tighter",children:"–í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π —Ç–∞—Ä–∏—Ñ"}),o.jsx("p",{className:"text-slate-500 font-bold uppercase tracking-widest text-sm",children:"–ü—Ä–æ–∑—Ä–∞—á–Ω—ã–µ —Ü–µ–Ω—ã –±–µ–∑ —Å–∫—Ä—ã—Ç—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π"})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-4xl mx-auto",children:[o.jsxs("div",{className:"relative bg-slate-900 border border-slate-800 p-10 rounded-[3rem] shadow-2xl transition-transform hover:scale-[1.02]",children:[o.jsx("div",{className:"absolute top-8 right-8 bg-blue-600 text-[10px] font-black px-3 py-1 rounded-full uppercase text-white tracking-widest shadow-lg",children:"–•–ò–¢"}),o.jsx("h3",{className:"text-3xl font-black text-white mb-2 italic",children:"Super"}),o.jsxs("div",{className:"flex items-baseline gap-1 mb-8",children:[o.jsx("span",{className:"text-5xl font-black text-blue-500",children:"150"}),o.jsx("span",{className:"text-xl font-bold text-slate-500 italic",children:"‚ÇΩ/–º–µ—Å"})]}),o.jsxs("ul",{className:"space-y-4 mb-10",children:[o.jsxs("li",{className:"flex items-center gap-3 text-slate-300 font-bold",children:[o.jsx(xs,{className:"text-blue-500",size:20})," ",o.jsx("span",{children:"1 –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ"})]}),o.jsxs("li",{className:"flex items-center gap-3 text-slate-300 font-bold",children:[o.jsx(tt,{className:"text-blue-500",size:20})," ",o.jsx("span",{children:"–û–±—Ö–æ–¥ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞"})]}),o.jsxs("li",{className:"flex items-center gap-3 text-slate-300 font-bold",children:[o.jsx(et,{className:"text-blue-500",size:20})," ",o.jsx("span",{children:"–ü—Ä–æ—Ç–æ–∫–æ–ª VLESS"})]})]}),o.jsx("button",{onClick:()=>x("register"),className:"w-full bg-blue-600 hover:bg-blue-500 py-5 rounded-2xl font-black text-white transition-all shadow-xl shadow-blue-600/20 active:scale-95",children:"–í—ã–±—Ä–∞—Ç—å Super"})]}),o.jsxs("div",{className:"bg-slate-900 border border-slate-800 p-10 rounded-[3rem] shadow-2xl transition-transform hover:scale-[1.02]",children:[o.jsx("h3",{className:"text-3xl font-black text-white mb-2 italic",children:"MULTI"}),o.jsxs("div",{className:"flex items-baseline gap-1 mb-8",children:[o.jsx("span",{className:"text-5xl font-black text-blue-500",children:"250"}),o.jsx("span",{className:"text-xl font-bold text-slate-500 italic",children:"‚ÇΩ/–º–µ—Å"})]}),o.jsxs("ul",{className:"space-y-4 mb-10",children:[o.jsxs("li",{className:"flex items-center gap-3 text-slate-300 font-bold",children:[o.jsx(ws,{className:"text-blue-500",size:20})," ",o.jsx("span",{children:"5 –£—Å—Ç—Ä–æ–π—Å—Ç–≤"})]}),o.jsxs("li",{className:"flex items-center gap-3 text-slate-300 font-bold",children:[o.jsx(Ze,{className:"text-blue-500",size:20})," ",o.jsx("span",{children:"–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ç—Ä–∞—Ñ–∏–∫–∞"})]}),o.jsxs("li",{className:"flex items-center gap-3 text-slate-400 font-medium",children:[o.jsx(dt,{className:"text-red-500",size:20})," ",o.jsx("span",{children:"–ë–µ–∑ –æ–±—Ö–æ–¥–∞ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞"})]})]}),o.jsx("button",{onClick:()=>x("register"),className:"w-full bg-slate-800 hover:bg-slate-700 py-5 rounded-2xl font-black text-white transition-all shadow-xl active:scale-95",children:"–í—ã–±—Ä–∞—Ç—å MULTI"})]})]})]}),o.jsx("div",{className:"bg-slate-900/30 py-20 px-6 border-y border-slate-900",children:o.jsx("div",{className:"max-w-7xl mx-auto",children:o.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between gap-12",children:[o.jsxs("div",{className:"lg:w-1/2",children:[o.jsx("h2",{className:"text-4xl font-black text-white mb-6 leading-none italic",children:"–ì–ª–æ–±–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤"}),o.jsx("p",{className:"text-slate-400 text-lg mb-8 font-medium",children:"–ú—ã —Ä–∞–∑–º–µ—â–∞–µ–º –Ω–∞—à–∏ —É–∑–ª—ã –≤ –ª—É—á—à–∏—Ö –¥–∞—Ç–∞-—Ü–µ–Ω—Ç—Ä–∞—Ö –º–∏—Ä–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–∏ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –ø—Ä–æ–ø—É—Å–∫–Ω–æ–π —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏."}),o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:["–°–®–ê","–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã","–®–≤–µ–π—Ü–∞—Ä–∏—è","–ì–µ—Ä–º–∞–Ω–∏—è","–†–æ—Å—Å–∏—è"].map(A=>o.jsxs("div",{className:"bg-slate-900 border border-slate-800 p-4 rounded-2xl flex items-center gap-3 font-bold text-white",children:[o.jsx(st,{size:18,className:"text-blue-600"})," ",A]},A))})]}),o.jsx("div",{className:"lg:w-1/2 flex justify-center",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 bg-blue-600 blur-[100px] opacity-20 animate-pulse"}),o.jsx(Ss,{size:320,className:"text-slate-800 relative z-10"})]})})]})})}),o.jsx("footer",{className:"py-12 border-t border-slate-900 text-center",children:o.jsx("p",{className:"text-slate-500 font-black text-xs uppercase tracking-[0.5em]",children:"SKYPATH VPN ¬© 2026"})})]});function Ws(){const x=()=>{try{const e=localStorage.getItem("vpn_current_view"),t=localStorage.getItem("vpn_current_user");if(e&&t&&e!=="login"&&e!=="register"&&e!=="landing")return e}catch(e){a.debug("App","–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è view –∏–∑ localStorage",null,e)}return"login"},[A,Z]=m.useState(x),[ae,ve]=m.useState(!0),[ut,_e]=m.useState(!1),[$e,Oe]=m.useState(!1),[ge,g]=m.useState(null),[Me,w]=m.useState(null),[mt,ft]=m.useState("users"),[re,ht]=m.useState("profile"),[gt,Be]=m.useState(null),[C,j]=m.useState(null),[K,B]=m.useState(null),[Ae,Ve]=m.useState(!1),[ee,pe]=m.useState({name:"",phone:""});m.useCallback(()=>{g(null),w(null)},[]);const E=m.useCallback(e=>{if(Z(e),e&&e!=="landing"&&e!=="login"&&e!=="register")try{localStorage.setItem("vpn_current_view",e),console.log("üíæ View —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ localStorage:",e)}catch(t){a.error("App","–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ view –≤ localStorage",{view:e},t)}else localStorage.removeItem("vpn_current_view")},[]),[k,q]=m.useState([]),[n,pt]=m.useState(null),[M,L]=m.useState(null),[_,ne]=m.useState([]),[He,z]=m.useState(!0),[Ge,Ke]=m.useState(!1),[Ce,be]=m.useState("login"),[bt,ie]=m.useState({email:"",password:"",name:""}),[qe,xt]=m.useState(null),[oe,Pe]=m.useState(null),[wt,St]=m.useState(!0),P=m.useCallback(e=>{if(pt(e),e)try{localStorage.setItem("vpn_current_user",JSON.stringify(e)),console.log("üíæ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ localStorage:",e.email)}catch(t){a.error("App","–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ localStorage",{email:e?.email},t)}else localStorage.removeItem("vpn_current_user"),localStorage.removeItem("vpn_current_view"),console.log("üóëÔ∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω –∏–∑ localStorage")},[]);m.useEffect(()=>{if(a.info("App","–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"),me.isValid)a.info("App","–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ");else{const e=ct(me);Pe(e),z(!1),a.error("App","–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω–æ –∏–∑-–∑–∞ –æ—à–∏–±–æ–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏")}},[]),m.useEffect(()=>{if(!Q||!D||!h){let e=`Firebase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω.

`;he&&(e+=`–û—à–∏–±–∫–∞: ${he}

`),e+=`–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
`,e+=`1. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞)
`,e+=`2. Dev —Å–µ—Ä–≤–µ—Ä –Ω–µ –±—ã–ª –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è .env
`,e+=`3. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ .env —Ñ–∞–π–ª–µ

`,e+="–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏.",console.error("‚ùå Firebase –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω!"),console.error("app:",Q),console.error("auth:",D),console.error("db:",h),console.error("firebaseInitError:",he),A!=="landing"&&Pe(e),z(!1)}else console.log("‚úÖ Firebase –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã:",{app:!!Q,auth:!!D,db:!!h})},[A]);const xe=m.useCallback(async()=>{if(!n||n.role!=="admin"){a.warn("Firestore","–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞");return}if(!h){const e="–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Firebase.";a.error("Firestore","–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞"),g(e),z(!1);return}try{a.info("Firestore","–ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Firestore (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)");const e=ce(h,`artifacts/${v}/public/data/users_v4`),t=await ue(e),s=[];t.forEach(i=>{s.push({id:i.id,...i.data()})}),a.info("Firestore",`–ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${s.length}`,{adminId:n.id,message:"–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ - –≤—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–∏—Å—Ç–µ–º—ã"}),q(s)}catch(e){a.error("Firestore","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π",{code:e.code},e),e.code==="permission-denied"?g("–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Firestore."):e.code==="unavailable"?g("–°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."):g("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö: "+(e.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"))}finally{z(!1)}},[h,n?.id,n?.role]),V=m.useCallback(async(e,t,s=10)=>{for(let i=1;i<=s;i++){const l=Y.generateSubId();try{const u=ce(e,`artifacts/${t}/public/data/users_v4`),c=Ue(u,Re("subId","==",l));if((await ue(c)).empty)return a.info("Auth",`–£–Ω–∏–∫–∞–ª—å–Ω—ã–π subId —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω —Å –ø–æ–ø—ã—Ç–∫–∏ ${i}`,{subId:l}),l;if(a.warn("Auth",`subId ${l} —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π (–ø–æ–ø—ã—Ç–∫–∞ ${i})`),i===s){const d=Date.now(),p=Math.floor(Math.random()*1e10),f=`${d}${p.toString().padStart(10,"0")}`;return a.warn("Auth","–î–æ—Å—Ç–∏–≥–Ω—É—Ç –º–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫, –∏—Å–ø–æ–ª—å–∑—É–µ–º subId —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å—é",{uniqueSubId:f}),f}}catch(u){if(a.error("Auth","–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ subId",{subId:l,attempt:i},u),i===s)return l}}return Y.generateSubId()},[]),W=m.useCallback(async e=>{if(!h||!e)return null;try{const t=y(h,`artifacts/${v}/public/data/users_v4`,e),s=await rt(t);if(s.exists()){const i={id:s.id,...s.data()};return a.debug("Auth","–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã (–∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –ø–æ uid)",{uid:e,email:i.email}),i}return null}catch(t){if(t.code==="unavailable"||t.message?.includes("offline")||t.message?.includes("Failed to get document because the client is offline")){a.warn("Auth","Firebase –æ—Ñ–ª–∞–π–Ω, –ø—ã—Ç–∞–µ–º—Å—è –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏–∑ –∫–µ—à–∞ localStorage",{uid:e});try{const s=localStorage.getItem("vpn_current_user");if(s){const i=JSON.parse(s);if(i.id===e)return a.info("Auth","–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ localStorage (–æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º)",{uid:e,email:i.email}),i}}catch(s){a.warn("Auth","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage",{uid:e},s)}return null}return a.error("Auth","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{uid:e},t),null}},[h]);m.useEffect(()=>{if(!D||!h){z(!1),ve(!1);return}const e=Ds(D,async t=>{if(console.log("üîÑ onAuthStateChanged –≤—ã–∑–≤–∞–Ω:",{user:!!t,uid:t?.uid}),xt(t),t)try{let s=await W(t.uid);if(s){if(!s.subId){a.info("Auth","–£ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç subId, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π",{uid:t.uid,email:t.email});try{const r=await V(h,v),d=y(h,`artifacts/${v}/public/data/users_v4`,t.uid);await O(d,{subId:r,updatedAt:new Date().toISOString()}),s={...s,subId:r},a.info("Auth","subId –¥–æ–±–∞–≤–ª–µ–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é",{uid:t.uid,subId:r})}catch(r){a.error("Auth","–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ subId –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{uid:t.uid},r)}}if(s.paymentStatus==="unpaid"&&s.uuid&&s.tariffId)try{const{dashboardService:r}=await je(async()=>{const{dashboardService:p}=await import("./dashboard-CUbPo_Y1.js").then(f=>f.a);return{dashboardService:p}},__vite__mapDeps([0,1,2,3,4]));if(await r.checkAndDeleteUnpaidSubscription(s)===null&&(s=await W(t.uid),!s)){P(null),z(!1),ve(!1);return}}catch(r){a.error("Auth","–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏",{uid:t.uid},r)}let i=s.role||"user";const l=(t.email||s.email||"").trim().toLowerCase();if(Os(l)&&i!=="admin")try{const r=y(h,`artifacts/${v}/public/data/users_v4`,t.uid);await O(r,{role:"admin",updatedAt:new Date().toISOString()}),i="admin",a.info("Auth","–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–¥–∞–Ω—ã –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ email",{email:l})}catch(r){a.error("Auth","–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ admin",{email:l},r)}const u={...s,email:t.email||s.email,photoURL:t.photoURL||s.photoURL||null,role:i};P(u),a.info("Firebase","–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã",{uid:t.uid,role:i});const c=localStorage.getItem("vpn_current_view");E(c&&c!=="login"&&c!=="register"&&c!=="landing"?c:i==="admin"?"admin":"dashboard")}else try{const i=localStorage.getItem("vpn_current_user");if(i){const l=JSON.parse(i);if(l.id===t.uid){a.info("Firebase","–ò—Å–ø–æ–ª—å–∑—É–µ–º –∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ localStorage",{uid:t.uid,email:l.email}),P(l);const u=localStorage.getItem("vpn_current_view");E(u&&u!=="login"&&u!=="register"&&u!=="landing"?u:l.role==="admin"?"admin":"dashboard")}else a.warn("Firebase","–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –Ω–æ –¥–∞–Ω–Ω—ã–µ –≤ Firestore –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",{uid:t.uid}),P(null)}else a.warn("Firebase","–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –Ω–æ –¥–∞–Ω–Ω—ã–µ –≤ Firestore –Ω–µ –Ω–∞–π–¥–µ–Ω—ã",{uid:t.uid}),P(null)}catch(i){a.warn("Firebase","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage",{uid:t.uid},i),P(null)}}catch(s){if(s.code==="unavailable"||s.message?.includes("offline")||s.message?.includes("Failed to get document because the client is offline")){a.warn("Firebase","–û—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º Firebase, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–µ—à",{uid:t.uid});try{const l=localStorage.getItem("vpn_current_user");if(l){const u=JSON.parse(l);u.id===t.uid?(a.info("Firebase","–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ –∫–µ—à–∞ (–æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º)",{uid:t.uid,email:u.email}),P(u)):P(null)}else P(null)}catch(l){a.warn("Firebase","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ localStorage",{uid:t.uid},l),P(null)}}else a.error("Firebase","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{uid:t.uid},s),P(null)}else P(null),a.info("Firebase","–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω"),E("login");z(!1),ve(!1)});return()=>e()},[D,h,W,V]);const le=m.useRef(null),[It,ze]=m.useState(null),[U,X]=m.useState([]),ye=m.useRef(!1),De=m.useCallback(async()=>{if(!n||n.role!=="admin"){a.warn("Firestore","–ü–æ–ø—ã—Ç–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞");return}if(ye.current){a.debug("Firestore","–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º");return}if(h){ye.current=!0;try{a.info("Firestore","–ó–∞–≥—Ä—É–∑–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–∏—Å—Ç–µ–º—ã (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)");const e=y(h,`artifacts/${v}/public/settings`),t=await rt(e);if(t.exists()){const s=t.data();L(s);const i=(s.servers||[]).map(l=>{const u={...l,xuiUsername:(l.xuiUsername||"").trim().replace(/^["']|["']$/g,"")};return u.protocol||(u.protocol=u.serverPort===443||u.serverPort===40919?"https":"http"),u});X(l=>{if(a.debug("Firestore","–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤",{firestoreCount:i.length,localCount:l?.length||0,localServerIds:l?.map(d=>d.id)||[]}),!l||l.length===0)return a.debug("Firestore","–ó–∞–≥—Ä—É–∂–µ–Ω—ã —Å–µ—Ä–≤–µ—Ä—ã –∏–∑ Firestore (–ª–æ–∫–∞–ª—å–Ω—ã—Ö –Ω–µ—Ç)",{count:i.length}),i;const u=[...i];let c=0,r=0;return l.forEach(d=>{if(!i.some(f=>f.id===d.id))a.info("Firestore","–î–æ–±–∞–≤–ª–µ–Ω –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä, –Ω–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–π –≤ Firestore",{serverId:d.id,serverName:d.name}),u.push(d),c++;else{const f=u.findIndex(I=>I.id===d.id);if(f!==-1){const I=d.sessionTestedAt||d.sessionError!==void 0,T=u[f].sessionTestedAt||u[f].sessionError!==void 0;I&&(!T||new Date(d.sessionTestedAt||0)>new Date(u[f].sessionTestedAt||0))?(u[f]={...u[f],...d},r++):(u[f]={...u[f],...d,sessionTested:d.sessionTested??u[f].sessionTested,sessionTestedAt:d.sessionTestedAt??u[f].sessionTestedAt,sessionError:d.sessionError??u[f].sessionError},r++)}}}),a.info("Firestore","–û–±—ä–µ–¥–∏–Ω–µ–Ω—ã —Å–µ—Ä–≤–µ—Ä—ã –∏–∑ Firestore –∏ –ª–æ–∫–∞–ª—å–Ω—ã–µ",{firestoreCount:i.length,localCount:l.length,mergedCount:u.length,addedCount:c,updatedCount:r}),u})}else{const s={serverIP:"http://localhost",serverPort:2053,xuiUsername:"vladislav4endev",xuiPassword:"v902l733a00d94%",xuiInboundId:"1",servers:[],updatedAt:new Date().toISOString()};await se(e,s),L(s),X([])}}catch(e){if(e.code==="unavailable"||e.message?.includes("offline")||e.message?.includes("Failed to get document because the client is offline")){a.warn("Admin","–û—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º: –∏—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é",null);const s={serverIP:"http://localhost",serverPort:2053,xuiUsername:"vladislav4endev",xuiPassword:"v902l733a00d94%",xuiInboundId:"1",servers:[],updatedAt:new Date().toISOString()};L(s),X([])}else a.error("Admin","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫",null,e)}finally{St(!1),ye.current=!1}}},[h,n?.id,n?.role]);m.useEffect(()=>{A==="login"&&Ce!=="login"?be("login"):A==="register"&&Ce!=="register"&&be("register")},[A]);const Ee=m.useRef(!1),Xe=m.useRef(null),We=m.useRef(null);m.useEffect(()=>{if(n?.id!==Xe.current||n?.role!==We.current){if(Xe.current=n?.id||null,We.current=n?.role||null,n&&!Ee.current){const e=n.role==="admin"?"admin":"dashboard";A!==e&&(E(e),Ee.current=!0)}n||(Ee.current=!1)}},[n?.id,n?.role,A,E]),m.useEffect(()=>{if(qe)n?.role==="admin"&&xe();else if(!ge&&!oe){const e=setTimeout(()=>{z(t=>t&&!1)},2e3);return()=>clearTimeout(e)}},[qe,xe,De,ge,oe]);const vt=m.useCallback(async e=>{if(e.preventDefault(),g(""),w(""),!D||!h){g("–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Firebase.");return}const t=new FormData(e.target),s=t.get("email")||e.target.querySelector('input[type="email"]')?.value||"",i=t.get("password")||e.target.querySelector('input[type="password"]')?.value||"",l=nt(s);if(l){g(l);return}const u=it(i,!1);if(u){g(u);return}try{a.info("Auth","–ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Firebase Auth",{email:s});const r=(await Es(D,s,i)).user;let d=await W(r.uid);if(!d){a.warn("Auth","–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –≤ Firestore",{uid:r.uid}),g("–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É."),await at(D);return}if(!d.subId){a.info("Auth","–£ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç subId, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π",{uid:r.uid,email:r.email});const f=await V(h,v),I=y(h,`artifacts/${v}/public/data/users_v4`,r.uid);await O(I,{subId:f,updatedAt:new Date().toISOString()}),d={...d,subId:f},a.info("Auth","subId –¥–æ–±–∞–≤–ª–µ–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é",{uid:r.uid,subId:f})}const p={...d,email:r.email||d.email,photoURL:r.photoURL||d.photoURL||null};P(p),a.info("Auth","–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥",{email:s,uid:r.uid,role:d.role}),w("–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ"),ie({email:"",password:""}),E(d.role==="admin"?"admin":"dashboard")}catch(c){a.error("Auth","–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞",{email:s},c);let r="–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.";c.code==="auth/user-not-found"?r="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email –Ω–µ –Ω–∞–π–¥–µ–Ω.":c.code==="auth/wrong-password"?r="–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å.":c.code==="auth/invalid-email"?r="–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email.":c.code==="auth/user-disabled"?r="–ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.":c.code==="auth/too-many-requests"?r="–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.":c.code==="auth/network-request-failed"?r="–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.":c.message&&(r="–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞: "+c.message),g(r)}},[D,h,W,V]),At=m.useCallback(async e=>{if(e.preventDefault(),g(""),w(""),!D||!h){g("–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Firebase.");return}const t=new FormData(e.target),s=t.get("email")||e.target.querySelector('input[type="email"]')?.value||"",i=t.get("password")||e.target.querySelector('input[type="password"]')?.value||"",l=t.get("name")||e.target.querySelector('input[name="name"]')?.value||"",u=nt(s);if(u){g(u);return}const c=Ms(l);if(c){g(c);return}const r=it(i,!0);if(r){g(r);return}let d=null;try{a.info("Auth","–ù–∞—á–∞–ª–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ Firebase Auth",{email:s}),d=(await Ns(D,s,i)).user,l.trim()&&await ks(d,{displayName:l.trim()});const f=Y.generateUUID();a.info("Auth","UUID —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{email:s,uuid:f});const I=await V(h,v);a.info("Auth","–£–Ω–∏–∫–∞–ª—å–Ω—ã–π subId —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{email:s,subId:I});const T=y(h,`artifacts/${v}/public/data/users_v4`,d.uid),H={email:s,name:l.trim(),phone:"",role:"user",plan:"free",uuid:f,subId:I,expiresAt:null,tariffName:"",tariffId:"",photoURL:d.photoURL||null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await se(T,H),a.info("Firestore","–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–∑–¥–∞–Ω—ã –≤ Firestore",{uid:d.uid,email:s});const S={id:d.uid,...H};P(S),a.info("Auth","–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ",{email:s,uid:d.uid}),w("–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –∫–ª—é—á –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ."),ie({email:"",password:"",name:""}),E("dashboard")}catch(p){if(a.error("Auth","–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏",{email:s},p),d)try{await d.delete()}catch(I){a.error("Auth","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ Firebase Auth –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏",{uid:d.uid},I)}let f="–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.";p.code==="auth/email-already-in-use"?f="–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.":p.code==="auth/invalid-email"?f="–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email.":p.code==="auth/operation-not-allowed"?f="–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ email/password –Ω–µ –≤–∫–ª—é—á–µ–Ω–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.":p.code==="auth/weak-password"?f="–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–π. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å.":p.code==="permission-denied"?f="–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Firestore.":p.code==="unavailable"?f="–°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.":p.message&&(f="–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: "+p.message),g(f)}},[D,h,V]),Ct=m.useCallback(async()=>{if(!D||!h||!fe){g("–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Firebase.");return}if(Ge){a.warn("Auth","–ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google, –∫–æ–≥–¥–∞ —É–∂–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –≤—Ö–æ–¥");return}g(""),w(""),Ke(!0);try{a.info("Auth","–ü–æ–ø—ã—Ç–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google");const t=(await Ts(D,fe)).user;let s=await W(t.uid);if(s){if(!s.subId){a.info("Auth","–£ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç subId, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–π",{uid:t.uid,email:t.email});const l=await V(h,v),u=y(h,`artifacts/${v}/public/data/users_v4`,t.uid);await O(u,{subId:l,updatedAt:new Date().toISOString()}),s.subId=l,a.info("Auth","subId –¥–æ–±–∞–≤–ª–µ–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é",{uid:t.uid,subId:l})}if(a.info("Auth","–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–π–¥–µ–Ω –≤ Firestore, –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤—Å–µ –¥–∞–Ω–Ω—ã–µ",{uid:t.uid,email:t.email,hasUuid:!!s.uuid,hasSubId:!!s.subId,hasTariff:!!s.tariffId,tariffName:s.tariffName}),t.photoURL&&s.photoURL!==t.photoURL){const l=y(h,`artifacts/${v}/public/data/users_v4`,t.uid);await O(l,{photoURL:t.photoURL,updatedAt:new Date().toISOString()}),s.photoURL=t.photoURL}}else{a.info("Auth","–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firestore –ø–æ—Å–ª–µ Google Sign-In",{uid:t.uid,email:t.email});const l=Y.generateUUID();a.info("Auth","UUID —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Google)",{email:t.email,uuid:l});const u=await V(h,v);a.info("Auth","–£–Ω–∏–∫–∞–ª—å–Ω—ã–π subId —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (Google)",{email:t.email,subId:u});const c=y(h,`artifacts/${v}/public/data/users_v4`,t.uid),r={email:t.email||"",name:t.displayName||"",phone:"",role:"user",plan:"free",uuid:l,subId:u,expiresAt:null,tariffName:"",tariffId:"",photoURL:t.photoURL||null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};await se(c,r),s={id:t.uid,...r},a.info("Firestore","–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–∑–¥–∞–Ω—ã –≤ Firestore",{uid:t.uid,email:t.email,message:"–í—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ (UUID, –ø–æ–¥–ø–∏—Å–∫–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏) –±—É–¥—É—Ç –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ —ç—Ç–æ–º—É uid"})}const i={...s,email:t.email||s.email,photoURL:t.photoURL||s.photoURL||null,name:t.displayName||s.name||""};P(i),a.info("Auth","–£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ —á–µ—Ä–µ–∑ Google",{email:t.email,uid:t.uid,role:s.role}),w("–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ"),E(s.role==="admin"?"admin":"dashboard")}catch(e){if(a.error("Auth","–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google",null,e),e.code==="auth/cancelled-popup-request"||e.code==="auth/popup-closed-by-user"){a.info("Auth","–í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google –æ—Ç–º–µ–Ω–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º");return}let t="–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.";e.code==="auth/popup-blocked"?t="–í—Å–ø–ª—ã–≤–∞—é—â–µ–µ –æ–∫–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ. –†–∞–∑—Ä–µ—à–∏—Ç–µ –≤—Å–ø–ª—ã–≤–∞—é—â–∏–µ –æ–∫–Ω–∞ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.":e.code==="auth/network-request-failed"?t="–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É.":e.code==="auth/account-exists-with-different-credential"?t="–ê–∫–∫–∞—É–Ω—Ç —Å —Ç–∞–∫–∏–º email —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π —Å–ø–æ—Å–æ–± –≤—Ö–æ–¥–∞.":e.code==="auth/operation-not-allowed"?t="–í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google –Ω–µ –≤–∫–ª—é—á–µ–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.":e.message&&(t="–û—à–∏–±–∫–∞ –≤—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google: "+e.message),g(t)}finally{Ke(!1)}},[D,h,fe,W,V]),we=m.useCallback(async()=>{const e=n?.email;a.info("Auth","–í—ã—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{email:e});try{D&&await at(D)}catch(t){a.error("Auth","–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ",{email:e},t)}P(null),_e(!1),E("landing"),g(""),w("")},[n,D]),Pt=m.useCallback(async e=>{if(!n||n.role!=="admin"){g("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤");return}if(!window.confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è?"))return;const t=k.find(i=>i.id===e);if(!t){g("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω");return}const s="1";try{if(a.info("Admin","–£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{userId:e,email:t.email}),t.uuid&&t.uuid.trim()!=="")try{await Y.deleteClient(s,t.email),a.info("Admin","–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω –∏–∑ 3x-ui",{email:t.email})}catch(l){a.warn("Admin","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ 3x-ui",{email:t.email},l)}const i=y(h,`artifacts/${v}/public/data/users_v4`,e);await Ie(i),a.info("Admin","–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω –∏–∑ Firestore",{userId:e}),q(k.filter(l=>l.id!==e)),w("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª–µ–Ω –∏–∑ —Å–∏—Å—Ç–µ–º—ã –∏ VPN –ø–∞–Ω–µ–ª–∏")}catch(i){a.error("Admin","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{userId:e},i);let l="–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è";i.code==="permission-denied"?l="–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ Firestore.":i.code==="unavailable"?l="–°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.":i.message&&(l="–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è: "+i.message),g(l)}},[n,k]),Je=m.useCallback(async e=>{try{a.debug("App","–ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞",{textLength:e?.length||0}),await navigator.clipboard.writeText(e),a.info("App","–¢–µ–∫—Å—Ç —É—Å–ø–µ—à–Ω–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞"),w("–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞"),setTimeout(()=>w(""),2e3)}catch(t){a.error("App","–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞",{textLength:e?.length||0},t),g("–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è")}},[]),yt=m.useCallback(e=>{ie(t=>({...t,email:e.target.value}))},[]),Dt=m.useCallback(e=>{ie(t=>({...t,password:e.target.value}))},[]),Et=m.useCallback(e=>{ie(t=>({...t,name:e.target.value}))},[]),Nt=m.useCallback(()=>{be("login"),g(""),w("")},[]),kt=m.useCallback(()=>{console.log("üîÑ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ —Ä–µ–∂–∏–º —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏"),be("register"),g(""),w(""),console.log("üîÑ authMode —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ register")},[]),Tt=m.useCallback(async()=>{if(!h||!n){g("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞");return}if(!D?.currentUser){g("–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–∞."),E("login");return}try{g(""),w(""),console.log("üîë –ù–∞—á–∏–Ω–∞–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–∞...");const e=await Qe.getKey(n);console.log("‚úÖ –°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É –ø–æ–ª—É—á–µ–Ω–∞ —á–µ—Ä–µ–∑ Backend Proxy:",e);const t={...n,vpnLink:e,subscriptionLink:e};P(t),q(k.map(i=>i.id===n.id?t:i));const s=y(h,`artifacts/${v}/public/data/users_v4`,n.id);await O(s,{vpnLink:e,subscriptionLink:e,updatedAt:new Date().toISOString()}),a.info("Auth","–°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–∞",{email:n.email,subscriptionLink:e}),w("–°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω–∞! –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –µ—ë –≤ –≤–∞—à–µ VPN –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.")}catch(e){console.error("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–∞:",e),a.error("Auth","–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–∞",{email:n.email},e);let t="–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∫–ª—é—á. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.";e.message&&(e.message.includes("—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")||e.message.includes("already exists")?t="–ö–ª—é—á —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.":e.message.includes("network")||e.message.includes("fetch")?t="–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ VPN –ø–∞–Ω–µ–ª–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.":t="–û—à–∏–±–∫–∞: "+e.message),g(t)}},[h,n,k,D]),[jt,Ut]=m.useState([]),[Rt,Ye]=m.useState(!1),[Vs,Ft]=m.useState(null),[Lt,Se]=m.useState(!1),de=m.useCallback(async()=>{if(!(!h||!n||!n.id))try{Ye(!0);const e=ce(h,`artifacts/${v}/public/data/payments`),t=Ue(e,Re("userId","==",n.id)),s=await ue(t),i=[];s.forEach(l=>{i.push({id:l.id,...l.data()})}),i.sort((l,u)=>{const c=l.createdAt?new Date(l.createdAt).getTime():0;return(u.createdAt?new Date(u.createdAt).getTime():0)-c}),Ut(i)}catch(e){a.error("Dashboard","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π",{userId:n.id},e)}finally{Ye(!1)}},[h,n?.id]);m.useEffect(()=>{re==="payments"&&n&&de()},[re,n?.id,de]),m.useEffect(()=>{n&&!Ae&&pe({name:n.name||"",phone:n.phone||""})},[n?.id,n?.name,n?.phone,Ae]);const _t=m.useCallback(e=>{const t=e.target.value;pe(s=>({...s,name:t}))},[]),$t=m.useCallback(e=>{const t=e.target.value;pe(s=>({...s,phone:t}))},[]),Ot=m.useCallback(async()=>{if(!(!h||!n)){if(!n.id){g("–û—à–∏–±–∫–∞: –Ω–µ —É–∫–∞–∑–∞–Ω ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è");return}try{g("");const e=y(h,`artifacts/${v}/public/data/users_v4`,n.id);await O(e,{name:ee.name.trim(),phone:ee.phone.trim(),updatedAt:new Date().toISOString()});const t={...n,name:ee.name.trim(),phone:ee.phone.trim()};P(t),q(k.map(s=>s.id===n.id?t:s)),Ve(!1),w("–ü—Ä–æ—Ñ–∏–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω"),setTimeout(()=>w(""),3e3),a.info("Dashboard","–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω",{userId:n.id})}catch(e){a.error("Dashboard","–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è",{userId:n.id},e),g("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è")}}},[h,n?.id,ee,k]),Mt=m.useCallback(async()=>{if(!h||!n||!n.id)return;if(!n.id){g("–û—à–∏–±–∫–∞: –Ω–µ —É–∫–∞–∑–∞–Ω ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è");return}const e="–£–î–ê–õ–ò–¢–¨";if(window.prompt(`–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —Å–≤–æ–π –∞–∫–∫–∞—É–Ω—Ç? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ.

–í—Å–µ –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã, –≤–∫–ª—é—á–∞—è –ø–æ–¥–ø–∏—Å–∫—É –∏ –∏—Å—Ç–æ—Ä–∏—é –ø–ª–∞—Ç–µ–∂–µ–π.

–í–≤–µ–¥–∏—Ç–µ "${e}" –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è:`)===e)try{if(g(""),n.uuid)try{await Y.deleteClient("1",n.email),a.info("Dashboard","–ö–ª–∏–µ–Ω—Ç —É–¥–∞–ª–µ–Ω –∏–∑ 3x-ui",{email:n.email})}catch(r){a.warn("Dashboard","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ 3x-ui",{email:n.email},r)}const s=y(h,`artifacts/${v}/public/data/users_v4`,n.id);await Ie(s),a.info("Dashboard","–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–¥–∞–ª–µ–Ω –∏–∑ Firestore",{userId:n.id,message:"–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã –∏ —É–¥–∞–ª–µ–Ω—ã"});const i=ce(h,`artifacts/${v}/public/data/payments`),l=Ue(i,Re("userId","==",n.id)),u=await ue(l),c=[];u.forEach(r=>{c.push(Ie(y(h,`artifacts/${v}/public/data/payments`,r.id)))}),await Promise.all(c),a.info("Dashboard","–ê–∫–∫–∞—É–Ω—Ç —É–¥–∞–ª–µ–Ω",{userId:n.id,email:n.email}),we(),w("–ê–∫–∫–∞—É–Ω—Ç —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω")}catch(s){a.error("Dashboard","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞",{userId:n.id},s),g("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞")}},[h,n?.id,we]),Ne=m.useCallback(async(e,t=null,s=null,i=1,l=!1,u="pay_now",c=0)=>{if(console.log("üéØ App.handleCreateSubscription –≤—ã–∑–≤–∞–Ω —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:",{tariffName:e?.name,tariffId:e?.id,devices:t,natrockPort:s,periodMonths:i,testPeriod:l,paymentMode:u,discount:c,hasDb:!!h,hasCurrentUser:!!n,currentUserId:n?.id}),!h){console.error("‚ùå App.handleCreateSubscription: db –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω");const r=new Error("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞");throw g(r.message),r}if(!n){console.error("‚ùå App.handleCreateSubscription: currentUser –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω");const r=new Error("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω");throw g(r.message),r}if(!e){console.error("‚ùå App.handleCreateSubscription: tariff –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω");const r=new Error("–¢–∞—Ä–∏—Ñ –Ω–µ –≤—ã–±—Ä–∞–Ω");throw g(r.message),r}try{console.log("üîÑ App.handleCreateSubscription: –ù–∞—á–∏–Ω–∞–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏..."),Se(!0),g(""),w(""),console.log("üì§ App.handleCreateSubscription: –í—ã–∑–æ–≤ dashboardService.createSubscription...");const r=await Qe.createSubscription(n,e,t,s,i,l,u,c);if(console.log("‚úÖ App.handleCreateSubscription: dashboardService.createSubscription –≤–µ—Ä–Ω—É–ª –¥–∞–Ω–Ω—ã–µ:",{hasUpdatedData:!!r,uuid:r?.uuid,tariffName:r?.tariffName,devices:r?.devices,periodMonths:r?.periodMonths,paymentStatus:r?.paymentStatus,hasVpnLink:!!r?.vpnLink}),!r)throw console.error("‚ùå App.handleCreateSubscription: dashboardService.createSubscription –≤–µ—Ä–Ω—É–ª undefined"),new Error("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –ø–æ–¥–ø–∏—Å–∫—É: —Å–µ—Ä–≤–∏—Å –Ω–µ –≤–µ—Ä–Ω—É–ª –¥–∞–Ω–Ω—ã–µ");a.info("Dashboard","–ü–æ–¥–ø–∏—Å–∫–∞ —Å–æ–∑–¥–∞–Ω–∞ —á–µ—Ä–µ–∑ Backend Proxy",{email:n.email,uuid:r.uuid,tariffId:e.id,devices:r.devices,periodMonths:r.periodMonths,paymentStatus:r.paymentStatus});const d={...n,uuid:r.uuid||n.uuid,plan:r.plan||n.plan,expiresAt:r.expiresAt||n.expiresAt,tariffName:r.tariffName||n.tariffName||e.name,tariffId:r.tariffId||n.tariffId||e.id,devices:r.devices||t||n.devices||1,natrockPort:r.natrockPort||s||n.natrockPort||null,periodMonths:r.periodMonths||i||n.periodMonths||1,paymentStatus:r.paymentStatus||paymentStatus||n.paymentStatus||"paid",testPeriodStartDate:r.testPeriodStartDate||null,testPeriodEndDate:r.testPeriodEndDate||null,discount:r.discount||c||n.discount||0,vpnLink:r.vpnLink||n.vpnLink||null,updatedAt:new Date().toISOString()};try{const p=y(h,`artifacts/${v}/public/data/users_v4`,n.id);await O(p,{...d,updatedAt:new Date().toISOString()}),a.info("Dashboard","–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ Firestore –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏",{userId:n.id,tariffId:d.tariffId,devices:d.devices,periodMonths:d.periodMonths})}catch(p){a.warn("Dashboard","–ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Firestore",{userId:n.id},p)}return P(d),q(k.map(p=>p.id===n.id?d:p)),Ft(null),{vpnLink:r.vpnLink||null,uuid:r.uuid,tariffName:d.tariffName,devices:d.devices,periodMonths:d.periodMonths,expiresAt:d.expiresAt,paymentStatus:d.paymentStatus,testPeriod:!!d.testPeriodEndDate}}catch(r){console.error("‚ùå App.handleCreateSubscription: –û–®–ò–ë–ö–ê –≤ –±–ª–æ–∫–µ catch:",{errorMessage:r.message,errorType:r.constructor.name,errorStack:r.stack,errorResponse:r.response?.data,errorStatus:r.response?.status}),a.error("Dashboard","–û—à–∏–±–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏",{email:n?.email,tariffId:e?.id,errorStatus:r.response?.status,errorMessage:r.message},r);let d="–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ñ–æ—Ä–º–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.";throw r.message?r.message.includes("—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")||r.message.includes("already exists")?d="–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.":r.message.includes("404")||r.message.includes("Not Found")?d="–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ø–∞–Ω–µ–ª–∏ VPN. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ XUI_HOST –∏ –ø—Ä–æ–∫—Å–∏ –≤ vite.config.js":r.message.includes("ECONNREFUSED")||r.message.includes("Backend Proxy")?d="Backend Proxy –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:3001":r.message.includes("not registered")||r.message.includes("webhook")?d="Webhook –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ n8n. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ workflow –∞–∫—Ç–∏–≤–µ–Ω –∏ webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.":r.message.includes("XUI_HOST")||r.message.includes("–ø—Ä–æ–∫—Å–∏")?d=r.message:r.message.includes("–Ω–µ –Ω–∞–π–¥–µ–Ω")||r.message.includes("not found")?d=`–û—à–∏–±–∫–∞: ${r.message}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å VITE_XUI_INBOUND_ID.`:d="–û—à–∏–±–∫–∞: "+r.message:r.response?.status===404&&(d="–ü–∞–Ω–µ–ª—å VPN –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ (404). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ XUI_HOST –∏ –ø—Ä–æ–∫—Å–∏."),g(d),r}finally{Se(!1)}},[h,n?.id,k,_]),Bt=m.useCallback(async()=>{if(!n||!n.tariffId){g("–ù–µ –Ω–∞–π–¥–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º —Ç–∞—Ä–∏—Ñ–µ");return}const e=_.find(t=>t.id===n.tariffId);if(!e){g("–¢–∞—Ä–∏—Ñ –Ω–µ –Ω–∞–π–¥–µ–Ω");return}await Ne(e)},[n?.id,_,Ne]),Vt=m.useCallback(async()=>{if(!h||!n){g("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏");return}if(!n.uuid){g("–£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è");return}try{Se(!0),g(""),w("");const{dashboardService:e}=await je(async()=>{const{dashboardService:l}=await import("./dashboard-CUbPo_Y1.js").then(u=>u.a);return{dashboardService:l}},__vite__mapDeps([0,1,2,3,4])),t=await e.deleteSubscription(n),s={...n,uuid:null,plan:null,expiresAt:null,tariffName:null,tariffId:null,devices:null,natrockPort:null,periodMonths:null,paymentStatus:null,testPeriodStartDate:null,testPeriodEndDate:null,unpaidStartDate:null,discount:null,vpnLink:null,updatedAt:new Date().toISOString()},i=y(h,`artifacts/${v}/public/data/users_v4`,n.id);await O(i,s),P(s),q(k.map(l=>l.id===n.id?s:l)),t.warning?(w(t.message),g(t.warning),setTimeout(()=>{w(""),g("")},8e3)):(w(t.message||"–ü–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–º–µ–Ω–µ–Ω–∞"),setTimeout(()=>w(""),5e3))}catch(e){a.error("Dashboard","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏",{userId:n?.id,email:n?.email},e);let t="–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.";e.message&&(e.message.includes("Backend Proxy")?t=e.message:e.message.includes("Unused Respond to Webhook")||e.message.includes("workflow")?t="–û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ workflow –≤ n8n. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ workflow —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏: "+e.message:e.message.includes("webhook")||e.message.includes("not registered")?t="Webhook –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.":t="–û—à–∏–±–∫–∞: "+e.message),g(t)}finally{Se(!1)}},[h,n?.id,k,v]);m.useEffect(()=>{re==="payments"&&n&&de()},[re,n?.id,de]);const ke=m.useCallback(async()=>{if(h)try{const e=ce(h,`artifacts/${v}/public/data/tariffs`),t=await ue(e),s=[];t.forEach(l=>{s.push({id:l.id,...l.data()})});const i=s.filter(l=>{const u=l.plan?.toLowerCase(),c=l.name?.toLowerCase();return u==="super"||u==="multi"||c==="super"||c==="multi"});if(s.length===0){const l=[{name:"Super",plan:"super",price:150,devices:1,trafficGB:0,durationDays:30,active:!0},{name:"MULTI",plan:"multi",price:250,devices:5,trafficGB:0,durationDays:30,active:!0}],u=[];for(const c of l)try{const r=await Fe(e,{...c,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});u.push({id:r.id,...c})}catch(r){a.error("Tariffs","–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞",{tariff:c},r)}u.length>0&&(ne(u),a.info("Tariffs","–°–æ–∑–¥–∞–Ω—ã —Ç–∞—Ä–∏—Ñ—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é",{count:u.length}))}else{a.debug("Tariffs","–í—Å–µ —Ç–∞—Ä–∏—Ñ—ã –∏–∑ –±–∞–∑—ã",{total:s.length,tariffs:s.map(r=>({id:r.id,name:r.name,plan:r.plan,active:r.active}))});const l=s.filter(r=>{const d=r.plan?.toLowerCase(),p=r.name?.toLowerCase();return d==="super"||d==="multi"||p==="super"||p==="multi"}),u=[],c=new Set;for(const r of l){const d=r.plan?.toLowerCase(),p=r.name?.toLowerCase();let f=null;d==="super"||p==="super"?f="super":(d==="multi"||p==="multi")&&(f="multi"),f&&!c.has(f)&&r.active!==!1&&(c.add(f),u.push(r))}if(u.length<2){const r=u.some(p=>{const f=p.plan?.toLowerCase(),I=p.name?.toLowerCase();return f==="super"||I==="super"}),d=u.some(p=>{const f=p.plan?.toLowerCase(),I=p.name?.toLowerCase();return f==="multi"||I==="multi"});if(!r)try{const p=await Fe(e,{name:"Super",plan:"super",price:150,devices:1,trafficGB:0,durationDays:30,active:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});u.push({id:p.id,name:"Super",plan:"super",price:150,devices:1,trafficGB:0,durationDays:30,active:!0})}catch(p){a.error("Tariffs","–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞ Super",null,p)}if(!d)try{const p=await Fe(e,{name:"MULTI",plan:"multi",price:250,devices:5,trafficGB:0,durationDays:30,active:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()});u.push({id:p.id,name:"MULTI",plan:"multi",price:250,devices:5,trafficGB:0,durationDays:30,active:!0})}catch(p){a.error("Tariffs","–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞ MULTI",null,p)}}u.sort((r,d)=>{const p=r.plan?.toLowerCase()||r.name?.toLowerCase(),f=d.plan?.toLowerCase()||d.name?.toLowerCase();return p==="super"?-1:f==="super"?1:0}),ne(u),a.info("Tariffs","–ó–∞–≥—Ä—É–∂–µ–Ω—ã —Ç–∞—Ä–∏—Ñ—ã (–¥–µ–¥—É–ø–ª–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã)",{count:u.length,tariffs:u.map(r=>({id:r.id,name:r.name,plan:r.plan}))}),l.length===0&&s.length>0&&a.warn("Tariffs","–¢–∞—Ä–∏—Ñ—ã –≤ –±–∞–∑–µ –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç SUPER/MULTI",{totalInDb:s.length})}}catch(e){a.error("Tariffs","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞—Ä–∏—Ñ–æ–≤",null,e),g("–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞—Ä–∏—Ñ–æ–≤")}},[h]),Te=m.useRef(!1);m.useEffect(()=>{A==="admin"&&n?.role==="admin"?Te.current||(a.info("Admin","–ó–∞–≥—Ä—É–∑–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏",{adminId:n.id}),xe(),De(),ke(),Te.current=!0):Te.current=!1},[A,n?.role,n?.id,xe,De,ke]),m.useCallback(e=>{const t=e.target.value;L(s=>s?{...s,serverIP:t}:null)},[]),m.useCallback(e=>{const t=Number(e.target.value)||443;L(s=>s?{...s,serverPort:t}:null)},[]),m.useCallback(e=>{const t=e.target.value;L(s=>s?{...s,xuiUsername:t}:null)},[]),m.useCallback(e=>{const t=e.target.value;L(s=>s?{...s,xuiPassword:t}:null)},[]),m.useCallback(e=>{const t=e.target.value;L(s=>s?{...s,xuiInboundId:t}:null)},[]);const Ht=m.useCallback(async()=>{if(!n||n.role!=="admin"){g("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫"),a.warn("Admin","–ü–æ–ø—ã—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",{userId:n?.id});return}if(!(!h||!M))try{a.info("Admin","–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —Å–∏—Å—Ç–µ–º—ã",{adminId:n.id,message:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±—É–¥—É—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º"});const e=y(h,`artifacts/${v}/public/settings`);await se(e,{...M,servers:U,updatedAt:new Date().toISOString(),updatedBy:n.id}),a.info("Admin","–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã",{adminId:n.id,message:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º —Å–∏—Å—Ç–µ–º—ã"}),w("–ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫–æ –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º"),setTimeout(()=>w(""),3e3)}catch(e){a.error("Admin","–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫",{adminId:n.id},e),g("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫")}},[h,M,U,n?.id,n?.role]),Gt=m.useCallback(e=>{const t=e.target.value;j(s=>s?{...s,name:t}:null)},[]),Kt=m.useCallback(e=>{const t=e.target.value;j(s=>s?{...s,serverIP:t}:null)},[]),qt=m.useCallback(e=>{const t=Number(e.target.value)||2053;j(s=>{if(!s)return null;const i=s.protocol;return{...s,serverPort:t,protocol:i&&i!==""?i:t===443||t===40919?"https":"http"}})},[]),zt=m.useCallback(e=>{const t=e.target.value;a.debug("Admin","–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ —Å–µ—Ä–≤–µ—Ä–∞",{newProtocol:t,serverId:C?.id,serverName:C?.name}),j(s=>{if(!s)return null;const i={...s,protocol:t};return a.debug("Admin","–ü—Ä–æ—Ç–æ–∫–æ–ª –æ–±–Ω–æ–≤–ª–µ–Ω –≤ editingServer",{protocol:i.protocol,serverId:i.id}),i})},[C?.id,C?.name]),Xt=m.useCallback(e=>{const t=e.target.value;j(s=>s?{...s,randompath:t}:null)},[]),Wt=m.useCallback(e=>{const t=e.target.value.trim(),s=t&&!t.startsWith("/")?"/"+t:t;j(i=>i?{...i,randompath:s}:null)},[]),Jt=m.useCallback(e=>{const t=e.target.value.replace(/^["']|["']$/g,"");j(s=>s?{...s,xuiUsername:t}:null)},[]),Yt=m.useCallback(e=>{const t=e.target.value;j(s=>s?{...s,xuiPassword:t}:null)},[]),Qt=m.useCallback(e=>{const t=e.target.value;j(s=>s?{...s,xuiInboundId:t}:null)},[]),Zt=m.useCallback(e=>{const t=e.target.value;j(s=>s?{...s,location:t}:null)},[]),es=m.useCallback(e=>{const t=e.target.checked;j(s=>s?{...s,active:t}:null)},[]),ts=m.useCallback((e,t)=>{j(s=>{if(!s)return null;const i=s.tariffIds||[],l=t?[...i,e]:i.filter(u=>u!==e);return{...s,tariffIds:l}})},[]),ss=m.useCallback(()=>{le.current||(le.current=`new-server-${Date.now()}-${Math.random().toString(36).substr(2,9)}`);const e={id:le.current,name:"",serverIP:"",serverPort:2053,protocol:"http",randompath:"",xuiUsername:"",xuiPassword:"",xuiInboundId:"",tariffIds:[],location:"",active:!0,sessionTested:!1,sessionTestedAt:null};j(e)},[]),as=m.useCallback(async()=>{if(!C)return;if(!n||n.role!=="admin"){g("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞"),a.warn("Admin","–ü–æ–ø—ã—Ç–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –±–µ–∑ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",{userId:n?.id});return}const e=C.protocol&&C.protocol.trim()!=="",t=e?C.protocol.trim():C.serverPort===443||C.serverPort===40919?"https":"http";a.debug("Admin","–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏",{explicitProtocol:e,editingServerProtocol:C.protocol,serverPort:C.serverPort,finalProtocol:t,serverId:C.id,serverName:C.name});const s=(C.xuiUsername||"").trim().replace(/^["']|["']$/g,""),i={...C,name:(C.name||"").trim(),serverIP:(C.serverIP||"").trim(),protocol:t,xuiUsername:s,xuiPassword:C.xuiPassword||"",xuiInboundId:(C.xuiInboundId||"").trim(),location:(C.location||"").trim(),randompath:(C.randompath||"").trim()};if(!i.name||!i.serverIP||!i.serverPort){g("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: –Ω–∞–∑–≤–∞–Ω–∏–µ, IP –∏ –ø–æ—Ä—Ç");return}if(!i.xuiUsername||!i.xuiPassword||!i.xuiInboundId){g("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–∞—Ä–æ–ª—å –∏ ID –∏–Ω–±–∞—É–Ω–¥–∞");return}if(!h){g("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞");return}try{const l=i.id&&U.find(p=>p.id===i.id);let u=[];l?(u=U.map(p=>p.id===i.id?i:p),a.debug("Admin","–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞",{serverId:i.id,serverName:i.name,prevCount:U.length,updatedCount:u.length})):(u=[...U,i],a.debug("Admin","–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞",{serverId:i.id,serverName:i.name,prevCount:U.length,updatedCount:u.length})),X(u);const r={...M||{serverIP:"http://localhost",serverPort:2053,xuiUsername:"vladislav4endev",xuiPassword:"v902l733a00d94%",xuiInboundId:"1",servers:[]},servers:u,updatedAt:new Date().toISOString(),updatedBy:n.id};L(r),a.info("Admin","–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤ –≤ Firestore",{adminId:n.id,serverId:i.id,serverName:i.name,isUpdate:!!l,totalServers:u.length});const d=y(h,`artifacts/${v}/public/settings`);await se(d,r,{merge:!0}),a.info("Admin","–°–µ—Ä–≤–µ—Ä —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ Firestore",{adminId:n.id,serverId:i.id,serverName:i.name,isUpdate:!!l}),le.current=null,j(null),w("–°–µ—Ä–≤–µ—Ä —Å–æ—Ö—Ä–∞–Ω–µ–Ω"),setTimeout(()=>w(""),2e3)}catch(l){a.error("Admin","–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –≤ Firestore",{adminId:n.id,serverId:i.id},l),g("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞: "+(l.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"))}},[C,n,h,M,U]),rs=m.useCallback(async e=>{if(!n||n.role!=="admin"){g("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞"),a.warn("Admin","–ü–æ–ø—ã—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –±–µ–∑ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",{userId:n?.id});return}if(window.confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Å–µ—Ä–≤–µ—Ä?")){if(!h){g("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞");return}try{const t=U.filter(u=>u.id!==e);X(t);const i={...M||{serverIP:"http://localhost",serverPort:2053,xuiUsername:"vladislav4endev",xuiPassword:"v902l733a00d94%",xuiInboundId:"1",servers:[]},servers:t,updatedAt:new Date().toISOString(),updatedBy:n.id};L(i),a.info("Admin","–£–¥–∞–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑ Firestore",{adminId:n.id,serverId:e,remainingServers:t.length});const l=y(h,`artifacts/${v}/public/settings`);await se(l,i,{merge:!0}),a.info("Admin","–°–µ—Ä–≤–µ—Ä —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω –∏–∑ Firestore",{adminId:n.id,serverId:e}),w("–°–µ—Ä–≤–µ—Ä —É–¥–∞–ª–µ–Ω"),setTimeout(()=>w(""),2e3)}catch(t){a.error("Admin","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑ Firestore",{adminId:n.id,serverId:e},t),g("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞: "+(t.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞")),X(U)}}},[U,n,h,M]),ns=m.useCallback(async e=>{if(!e||!e.id)return;ze(e.id),g(""),w("");const t=U.find(c=>c.id===e.id)||e;a.info("Admin","üîç –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞",{serverId:e.id,serverName:e.name,fromState:t!==e,currentServerHasXuiUsername:!!t.xuiUsername,currentServerHasXuiPassword:!!t.xuiPassword,currentServerXuiUsername:t.xuiUsername||"–ù–ï–¢",currentServerXuiPasswordLength:t.xuiPassword?t.xuiPassword.length:0,passedServerHasXuiUsername:!!e.xuiUsername,passedServerHasXuiPassword:!!e.xuiPassword,passedServerXuiUsername:e.xuiUsername||"–ù–ï–¢",passedServerXuiPasswordLength:e.xuiPassword?e.xuiPassword.length:0,serversCount:U.length,note:"–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –æ–±—ä–µ–∫—Ç –∏–∑ —Å–æ—Å—Ç–æ—è–Ω–∏—è servers"});const s=t.protocol||(t.serverPort===443||t.serverPort===40919?"https":"http"),i=t.randompath?`/${t.randompath.replace(/^\/+|\/+$/g,"")}`:"",l=`${s}://${t.serverIP}:${t.serverPort}${i}`.replace(/\/+$/,""),u=`${l}/login`;try{const c=(t.xuiUsername||"").trim().replace(/^["']|["']$/g,""),r=t.xuiPassword||"";if(a.info("Admin","üîç –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–∏ 3x-ui - –ø—Ä–æ–≤–µ—Ä–∫–∞ credentials",{serverId:e.id,serverName:e.name,hasXuiUsername:!!e.xuiUsername,hasXuiPassword:!!e.xuiPassword,usernameValue:c||"–ü–£–°–¢–û",usernameLength:c.length,passwordLength:r.length,passwordPreview:r?"***":"–ü–£–°–¢–û",usernamePreview:c?`${c.substring(0,Math.min(3,c.length))}***`:"–ü–£–°–¢–û",usernameRaw:e.xuiUsername,passwordRawLength:e.xuiPassword?e.xuiPassword.length:0,allServerFields:Object.keys(e).filter(S=>S.toLowerCase().includes("user")||S.toLowerCase().includes("pass")||S.toLowerCase().includes("xui")||S.toLowerCase().includes("credential")),serverObject:{id:e.id,name:e.name,xuiUsername:e.xuiUsername?`"${e.xuiUsername}"`:"–ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù",xuiPassword:e.xuiPassword?`–¥–ª–∏–Ω–∞ ${e.xuiPassword.length}`:"–ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù"},note:"–ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è server.xuiUsername –∏ server.xuiPassword –∏–∑ —Ñ–æ—Ä–º—ã —Å–µ—Ä–≤–µ—Ä–∞"}),!c||!r){const S=[];c||S.push("Username"),r||S.push("Password");const b=`–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: ${S.join(", ")}

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ "${e.name}":
- Username: ${c?"—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω":"–ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù"}
- Password: ${r?"—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω":"–ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù"}

–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è Username –∏ Password –≤ —Ñ–æ—Ä–º–µ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞.`;throw a.error("Admin","–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç credentials –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏",{serverId:e.id,serverName:e.name,missingFields:S,serverFields:Object.keys(e)}),new Error(b)}a.debug("Admin","–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π URL –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è",{loginURL:u,baseURL:l,normalizedPath:i,originalRandompath:e.randompath,protocol:s,serverProtocol:e.protocol,serverPort:e.serverPort}),a.info("Admin","üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö",{loginURL:u,baseURL:l,protocol:s,username:`${c.substring(0,Math.min(3,c.length))}***`,usernameFull:c,usernameLength:c.length,hasPassword:!!r,passwordLength:r.length,source:"server.xuiUsername –∏ server.xuiPassword –∏–∑ —Ñ–æ—Ä–º—ã —Å–µ—Ä–≤–µ—Ä–∞",serverId:e.id,serverName:e.name});const d={serverIP:e.serverIP,serverPort:e.serverPort,protocol:s,randompath:e.randompath||"",username:c,password:r};a.debug("Admin","üì§ Payload –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö",{serverId:e.id,serverName:e.name,...d,password:"***",passwordLength:r.length,usernameLength:c.length});const p=await js.post("/api/test-session",d,{withCredentials:!0,timeout:1e4,headers:{"Content-Type":"application/json",Accept:"application/json"}}),f=p.data||{};let I=null;const T=p.headers["set-cookie"]||p.headers["Set-Cookie"];if(T){const S=Array.isArray(T)?T:[T];for(const b of S)if(b.includes("3x-ui=")){const R=b.match(/3x-ui=([^;]+)/);if(R){I=R[1];break}}a.info("Admin","üç™ Cookies –∏–∑–≤–ª–µ—á–µ–Ω—ã –∏–∑ –æ—Ç–≤–µ—Ç–∞",{serverId:e.id,serverName:e.name,hasSetCookie:!!T,cookieCount:S.length,hasSessionCookie:!!I,cookiePreview:I?`${I.substring(0,20)}...`:"–Ω–µ—Ç",allCookies:S})}if(a.info("Admin","üì• –û—Ç–≤–µ—Ç –æ—Ç API –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö",{serverId:e.id,serverName:e.name,success:f.success,msg:f.msg,message:f.message,code:f.code,error:f.error,fullResponse:JSON.stringify(f,null,2),status:p.status,statusText:p.statusText,loginURL:u,hasCookies:!!T,hasSessionCookie:!!I,credentialsUsed:{username:c,usernameLength:c.length,passwordLength:r.length,source:"server.xuiUsername –∏ server.xuiPassword"}}),f.success===!1||f.success===0){const S=f.msg||f.message||"–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏",b=S.toLowerCase(),R=b.includes("invalid username")||b.includes("invalid password")||b.includes("invalid")&&(b.includes("username")||b.includes("password"))||b.includes("–Ω–µ–≤–µ—Ä–Ω")||b.includes("–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω")||b.includes("wrong username")||b.includes("wrong password")||b.includes("incorrect username")||b.includes("incorrect password")||p.status===401;if(!R&&(b.includes("two-factor")&&!b.includes("username")&&!b.includes("password")&&!b.includes("invalid")||b.includes("2fa")&&!b.includes("username")&&!b.includes("password")&&!b.includes("invalid")&&(b.includes("required")||b.includes("code"))||b.includes("mfa")&&!b.includes("username")&&!b.includes("password")&&!b.includes("invalid")||b.includes("totp")&&!b.includes("username")&&!b.includes("password")&&!b.includes("invalid")||b.includes("telegram auth")&&!b.includes("username")&&!b.includes("password")||b.includes("authenticator")&&!b.includes("username")&&!b.includes("password")||b.includes("–¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω")&&!b.includes("–ª–æ–≥–∏–Ω")&&!b.includes("–ø–∞—Ä–æ–ª")&&!b.includes("–Ω–µ–≤–µ—Ä–Ω")||f.code==="2FA_REQUIRED"||f.error==="2FA_REQUIRED"||f.code==="TWO_FACTOR_REQUIRED"||f.code==="MFA_REQUIRED"||f.code==="TOTP_REQUIRED"||p.status===402||f.obj&&(f.obj.totp||f.obj.mfa||f.obj.twoFactor)))throw a.error("Admin","üö´ 2FA –í–ö–õ–Æ–ß–ï–ù - API login –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω",{serverId:e.id,serverName:e.name,originalMessage:S,responseStatus:p.status,responseData:JSON.stringify(f,null,2),detectedBy:"2fa_detection",note:"–ï—Å–ª–∏ 2FA –≤–∫–ª—é—á–µ–Ω –≤ –ø–∞–Ω–µ–ª–∏ 3x-ui, API login –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ù—É–∂–µ–Ω backend —Å session store."}),new Error(`üö´ –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (2FA) –í–ö–õ–Æ–ß–ï–ù–ê –≤ –ø–∞–Ω–µ–ª–∏ 3x-ui

‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê:
–ü—Ä–∏ –≤–∫–ª—é—á–µ–Ω–Ω–æ–º 2FA API login –ù–ï –†–ê–ë–û–¢–ê–ï–¢ —á–µ—Ä–µ–∑ –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞!

üìã –ß–¢–û –ü–†–û–í–ï–†–ò–¢–¨ –í –ü–ê–ù–ï–õ–ò 3x-ui:
   1. –ó–∞–π–¥–∏—Ç–µ –≤ –ø–∞–Ω–µ–ª—å: `+u+`
   2. Settings ‚Üí Security
   3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –æ—Ç–∫–ª—é—á–∏—Ç–µ:
      ‚Ä¢ TOTP (Time-based One-Time Password)
      ‚Ä¢ Telegram auth
      ‚Ä¢ MFA (Multi-Factor Authentication)

‚úÖ –†–ï–®–ï–ù–ò–Ø:

1Ô∏è‚É£ –û–¢–ö–õ–Æ–ß–ò–¢–¨ 2FA (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):
   ‚Ä¢ Settings ‚Üí Security ‚Üí –û—Ç–∫–ª—é—á–∏—Ç–µ –≤—Å–µ –º–µ—Ç–æ–¥—ã 2FA
   ‚ö†Ô∏è –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production!

2Ô∏è‚É£ –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨ BACKEND –ü–†–û–ö–°–ò (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è):
   ‚Ä¢ Browser ‚Üí Your Backend (session store) ‚Üí 3x-ui
   ‚Ä¢ Backend –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç 2FA –∏ —Ö—Ä–∞–Ω–∏—Ç —Å–µ—Å—Å–∏—é
   ‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ: server/proxy-server.js
   ‚Ä¢ –°–º. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: PRODUCTION_SETUP.md

üìä –î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏:
   –°–µ—Ä–≤–µ—Ä: ${e.name}
   URL: ${u}
   –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: ${S}
   –°—Ç–∞—Ç—É—Å: ${p.status}

üìö –ü–æ–¥—Ä–æ–±–Ω–µ–µ: —Å–º. 2FA_ARCHITECTURE.md`);if(R){const G=e.xuiUsername||"",te=e.xuiPassword||"";throw a.warn("Admin","–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ",{serverId:e.id,serverName:e.name,username:G?`${G.substring(0,Math.min(3,G.length))}***`:"–Ω–µ —É–∫–∞–∑–∞–Ω",usernameLength:G.length,hasPassword:!!te,passwordLength:te.length,originalMessage:f.msg||f.message,responseStatus:p.status,loginURL:u,note:"–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å Username –∏ Password –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞"}),new Error(`–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å Username –∏ Password –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞:

üìã –°–µ—Ä–≤–µ—Ä: ${e.name}
üîë Username: ${G||"–ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù"}
üîê Password: ${te?"***":"–ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù"}
üìè –î–ª–∏–Ω–∞ username: ${G.length} —Å–∏–º–≤–æ–ª–æ–≤
üìè –î–ª–∏–Ω–∞ password: ${te.length} —Å–∏–º–≤–æ–ª–æ–≤

üåê URL: ${u}

üí° –°–æ–≤–µ—Ç: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞ "${e.name}" –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
   ‚Ä¢ Username —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ª–æ–≥–∏–Ω–æ–º –≤ –ø–∞–Ω–µ–ª–∏ 3x-ui
   ‚Ä¢ Password —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å –ø–∞—Ä–æ–ª–µ–º –≤ –ø–∞–Ω–µ–ª–∏ 3x-ui
   ‚Ä¢ –ù–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –Ω–∞—á–∞–ª–µ –∏–ª–∏ –∫–æ–Ω—Ü–µ
   ‚Ä¢ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞—Å–∫–ª–∞–¥–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã (–Ω–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∞ –Ω–∞ –¥—Ä—É–≥—É—é)`)}const J=f.msg||f.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏";throw new Error(`${J}

–°–µ—Ä–≤–µ—Ä: ${e.name}
URL: ${u}
–°—Ç–∞—Ç—É—Å: ${p.status}`)}const H={sessionTested:!0,sessionTestedAt:new Date().toISOString(),sessionError:null,sessionCookie:I||null,sessionCookieReceivedAt:I?new Date().toISOString():null};X(S=>{const b=S.findIndex(J=>J.id===e.id);if(b===-1)return a.warn("Admin","–°–µ—Ä–≤–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö",{serverId:e.id}),S;const R={...S[b],...H},$=[...S];return $[b]=R,$});try{L(S=>{if(!S)return S;const b={...S},R=(b.servers||[]).findIndex($=>$.id===e.id);return R!==-1&&(b.servers=[...b.servers],b.servers[R]={...b.servers[R],...H},b.updatedAt=new Date().toISOString(),b.updatedBy=n?.id||"system",h&&n?.id&&je(async()=>{const{doc:$,setDoc:J}=await import("./firebase-vendor-BkZVVcGE.js").then(G=>G.t);return{doc:$,setDoc:J}},__vite__mapDeps([1,2,3])).then(({doc:$,setDoc:J})=>{const te=$(h,"artifacts/1:269116595714:web:9f26a4ed0445150a5b911b/public/data/settings_v4",n.id);J(te,b,{merge:!0}).then(()=>{a.info("Admin","‚úÖ –î–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ Firestore (—Å cookies)",{serverId:e.id,serverName:e.name,hasSessionCookie:!!I})}).catch(ps=>{a.error("Admin","–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞ –≤ Firestore",null,ps)})}).catch($=>{a.error("Admin","–û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ firebase/firestore",null,$)})),b})}catch(S){a.error("Admin","–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞",null,S)}a.info("Admin","‚úÖ –î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã",{serverId:e.id,hasSessionCookie:!!I,cookiePreview:I?`${I.substring(0,20)}...`:"–Ω–µ—Ç"}),w(`–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –ø–æ–ª—É—á–µ–Ω—ã –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ "${e.name}"${I?" (—Å–µ—Å—Å–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞)":""}`),setTimeout(()=>w(""),3e3)}catch(c){const r={serverId:e.id,serverName:e.name,error:c.message,responseStatus:c.response?.status,responseData:c.response?.data,loginURL:u,serverIP:e.serverIP,serverPort:e.serverPort,protocol:s,randompath:e.randompath,hasUsername:!!e.xuiUsername,hasPassword:!!e.xuiPassword};a.error("Admin","–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏",r,c),X(f=>{if(a.debug("Admin","–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏ —Ç–µ—Å—Ç–∞",{serverId:e.id,serverName:e.name,prevServersCount:f?.length||0,prevServersIds:f?.map(S=>S.id)||[]}),!f||f.length===0){a.error("Admin","–ú–∞—Å—Å–∏–≤ —Å–µ—Ä–≤–µ—Ä–æ–≤ –ø—É—Å—Ç –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏, –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ—Ä–≤–µ—Ä",{serverId:e.id});const S={...e,sessionTested:!1,sessionTestedAt:new Date().toISOString(),sessionError:c.response?.data?.msg||c.message||"–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"};return a.info("Admin","–°–µ—Ä–≤–µ—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –ø—É—Å—Ç–æ–º –º–∞—Å—Å–∏–≤–µ",{serverId:e.id}),[S]}const I=f.findIndex(S=>S.id===e.id);if(I===-1){a.warn("Admin","–°–µ—Ä–≤–µ—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏ —Ç–µ—Å—Ç–∞, –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞—Ç–Ω–æ",{serverId:e.id,serverName:e.name,currentServersCount:f.length,currentServerIds:f.map(R=>R.id)});const S={...e,sessionTested:!1,sessionTestedAt:new Date().toISOString(),sessionError:c.response?.data?.msg||c.message||"–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"},b=[...f,S];return a.info("Admin","–°–µ—Ä–≤–µ—Ä –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ –º–∞—Å—Å–∏–≤–µ",{serverId:e.id,newServersCount:b.length}),b}const T={...f[I],sessionTested:!1,sessionTestedAt:new Date().toISOString(),sessionError:c.response?.data?.msg||c.message||"–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"},H=[...f];return H[I]=T,a.info("Admin","–°–µ—Ä–≤–µ—Ä –æ–±–Ω–æ–≤–ª–µ–Ω –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏ —Ç–µ—Å—Ç–∞",{serverId:e.id,serverName:e.name,serversCount:H.length,serverIndex:I,sessionError:T.sessionError}),H});let d=c.message||"–ù–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å–µ—Å—Å–∏—é";if(!(c.message?.includes(`

`)||c.message?.includes("–¢—Ä–µ–±—É–µ—Ç—Å—è –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è")||c.message?.includes("–ù–µ–≤–µ—Ä–Ω—ã–µ —É—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ"))&&(c.code==="ERR_NETWORK"||c.message?.includes("Network Error")||c.code==="ERR_FAILED")){const f=c.message?.includes("CORS")||c.message?.includes("Access-Control")||(c.code==="ERR_FAILED"||c.code==="ERR_NETWORK")&&!c.response&&!c.message?.includes("timeout")&&!c.message?.includes("ECONNREFUSED")&&!c.message?.includes("ETIMEDOUT"),I=`–°–µ—Ä–≤–µ—Ä: ${e.serverIP}:${e.serverPort}${e.randompath?e.randompath:""}`,T=`–ü—Ä–æ—Ç–æ–∫–æ–ª: ${s}`;f?(d=`‚ö†Ô∏è –û—à–∏–±–∫–∞ CORS –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —Å–µ—Ä–≤–µ—Ä—É.

${I}
${T}

`,d+=`–ü—Ä–æ–±–ª–µ–º–∞: –ë—Ä–∞—É–∑–µ—Ä –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ –≤–Ω–µ—à–Ω–µ–º—É —Å–µ—Ä–≤–µ—Ä—É –∏–∑-–∑–∞ –ø–æ–ª–∏—Ç–∏–∫–∏ CORS.
`,d+=`–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä—è–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞ –∫ –≤–Ω–µ—à–Ω–∏–º —Å–µ—Ä–≤–µ—Ä–∞–º.

`,d+=`–†–µ—à–µ–Ω–∏—è:
`,d+=`1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ 3x-ui (–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–∞–Ω–µ–ª–∏):
`,d+=`   - –î–æ–±–∞–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–æ–∫: Access-Control-Allow-Origin: *
`,d+=`   - –ò–ª–∏ —Ä–∞–∑—Ä–µ—à–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –¥–æ–º–µ–Ω: Access-Control-Allow-Origin: http://localhost:5173
`,d+=`   - –î–æ–±–∞–≤–∏—Ç—å: Access-Control-Allow-Methods: POST, GET, OPTIONS
`,d+=`   - –î–æ–±–∞–≤–∏—Ç—å: Access-Control-Allow-Headers: Content-Type
`,d+=`2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)
`,d+=`3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞–ø—Ä—è–º—É—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ:
`,d+=`   –û—Ç–∫—Ä–æ–π—Ç–µ: ${u}
`,d+=`   –ï—Å–ª–∏ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è - —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–æ–±–ª–µ–º–∞ —Ç–æ–ª—å–∫–æ –≤ CORS

`,d+="–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–µ—Å—Å–∏–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ CORS –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ–∫—Å–∏."):(d=`–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ —Å–µ—Ä–≤–µ—Ä—É.

${I}
${T}

–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
`,d+=`‚Ä¢ –°–µ—Ä–≤–µ—Ä –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç
`,d+=`‚Ä¢ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π IP –∞–¥—Ä–µ—Å –∏–ª–∏ –ø–æ—Ä—Ç
`,d+=`‚Ä¢ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—Ä–æ—Ç–æ–∫–æ–ª (http/https)
`,d+=`‚Ä¢ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ firewall –∏–ª–∏ CORS –ø–æ–ª–∏—Ç–∏–∫–æ–π
`,d+=`‚Ä¢ –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø—É—Ç—å (randompath)
`,d+=`‚Ä¢ –¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è

`,d+=`–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
`,d+=`- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–µ—Ä–∞ –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞: ${u}
`,d+=`- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ CORS –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ 3x-ui
`,d+="- –ü—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"),a.error("Admin","–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —Å–µ—Å—Å–∏–∏",{serverId:e.id,serverName:e.name,loginURL:u,protocol:s,serverIP:e.serverIP,serverPort:e.serverPort,randompath:e.randompath,errorCode:c.code,errorMessage:c.message},c)}else c.code==="ECONNREFUSED"||c.message?.includes("ECONNREFUSED")?d=`–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–æ. –°–µ—Ä–≤–µ—Ä ${e.serverIP}:${e.serverPort} –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–ª–∏ –Ω–µ –∑–∞–ø—É—â–µ–Ω.`:c.code==="ETIMEDOUT"||c.message?.includes("timeout")?d=`–¢–∞–π–º–∞—É—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è. –°–µ—Ä–≤–µ—Ä ${e.serverIP}:${e.serverPort} –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.`:c.code==="ERR_CERT"||c.message?.includes("certificate")?d=`–û—à–∏–±–∫–∞ SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ HTTPS –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ ${e.serverIP}:${e.serverPort}`:c.response?.status===404?d=`–ü–∞–Ω–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ (404). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- IP –∞–¥—Ä–µ—Å: ${e.serverIP}
- –ü–æ—Ä—Ç: ${e.serverPort}
- –ü—É—Ç—å (randompath): ${e.randompath||"(–Ω–µ —É–∫–∞–∑–∞–Ω)"}
- –ü–æ–ª–Ω—ã–π URL: ${u}`:c.response?.status===401||c.response?.status===403?d=`–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (${c.response.status}). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- Username: ${e.xuiUsername}
- Password: (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å)`:c.response?.status===500?d="–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (500). –°–µ—Ä–≤–µ—Ä 3x-ui –≤–µ—Ä–Ω—É–ª –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –æ—à–∏–±–∫—É.":c.response?.status?d=`–û—à–∏–±–∫–∞ HTTP ${c.response.status}: ${c.response.statusText||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"}`:c.message&&(d=`–û—à–∏–±–∫–∞: ${c.message}`);a.error("Admin","–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏",{serverId:e.id,serverName:e.name,errorCode:c.code,errorMessage:c.message,responseStatus:c.response?.status,loginURL:u},c),g(d),setTimeout(()=>g(""),8e3)}finally{ze(null)}},[U,h,n]),is=m.useCallback(async(e,t)=>{if(h)try{a.info("Admin","–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{userId:e,updates:t});const s=y(h,`artifacts/${v}/public/data/users_v4`,e);await O(s,{...t,updatedAt:new Date().toISOString()}),q(k.map(l=>l.id===e?{...l,...t}:l)),n.id===e&&P({...n,...t});const i=k.find(l=>l.id===e);if(i&&i.uuid&&t.expiresAt!==void 0){const l=M?.xuiInboundId||"1";if(l)try{const u=t.expiresAt?new Date(t.expiresAt).getTime():0;await Y.updateClient(l,i.email,{expiryTime:u,totalGB:t.trafficGB||i.trafficGB||0,limitIp:t.devices||i.devices||0}),a.info("Admin","–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω –≤ 3x-ui",{email:i.email})}catch(u){a.error("Admin","–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ 3x-ui",{email:i.email},u)}}a.info("Admin","–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω",{userId:e}),w("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω"),Be(null),setTimeout(()=>w(""),3e3)}catch(s){a.error("Admin","–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{userId:e},s),g("–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è")}},[h,k,n,M]),os=m.useCallback(e=>{const t=e.target.value;B(s=>s?{...s,name:t}:null)},[]),ls=m.useCallback(e=>{const t=e.target.value;B(s=>s?{...s,plan:t}:null)},[]),ds=m.useCallback(e=>{const t=Number(e.target.value)||0;B(s=>s?{...s,price:t}:null)},[]),cs=m.useCallback(e=>{const t=Number(e.target.value)||1;B(s=>s?{...s,devices:t}:null)},[]),us=m.useCallback(e=>{const t=Number(e.target.value)||0;B(s=>s?{...s,trafficGB:t}:null)},[]),ms=m.useCallback(e=>{const t=Number(e.target.value)||30;B(s=>s?{...s,durationDays:t}:null)},[]),fs=m.useCallback(e=>{const t=e.target.checked;B(s=>s?{...s,active:t}:null)},[]),hs=m.useCallback(async e=>{if(!h)return;if(!K||!K.id||K.id.startsWith("default-")){g("–ú–æ–∂–Ω–æ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞—Ä–∏—Ñ—ã SUPER –∏ MULTI");return}const t=e.plan?.toLowerCase(),s=e.name?.toLowerCase();if(t!=="super"&&t!=="multi"&&s!=="super"&&s!=="multi"){g("–†–∞–∑—Ä–µ—à–µ–Ω—ã —Ç–æ–ª—å–∫–æ —Ç–∞—Ä–∏—Ñ—ã SUPER –∏ MULTI");return}try{const i=y(h,`artifacts/${v}/public/data/tariffs`,K.id);await O(i,{...e,updatedAt:new Date().toISOString()}),ne(_.map(l=>l.id===K.id?{...l,...e}:l)),w("–¢–∞—Ä–∏—Ñ —Å–æ—Ö—Ä–∞–Ω–µ–Ω"),B(null),setTimeout(()=>w(""),3e3)}catch(i){a.error("Admin","–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞",{tariffId:K?.id},i),g("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞")}},[h,_,K]),gs=m.useCallback(async e=>{const t=_.find(l=>l.id===e);if(!t)return;const s=t.plan?.toLowerCase(),i=t.name?.toLowerCase();if(s==="super"||s==="multi"||i==="super"||i==="multi"){g("–ù–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å —Ç–∞—Ä–∏—Ñ—ã SUPER –∏ MULTI"),setTimeout(()=>g(""),3e3);return}if(h&&window.confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–∞—Ä–∏—Ñ?"))try{const l=y(h,`artifacts/${v}/public/data/tariffs`,e);await Ie(l),ne(_.filter(u=>u.id!==e)),w("–¢–∞—Ä–∏—Ñ —É–¥–∞–ª–µ–Ω"),setTimeout(()=>w(""),3e3)}catch(l){a.error("Admin","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞",{tariffId:e},l),g("–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è —Ç–∞—Ä–∏—Ñ–∞")}},[h,_]);return A==="landing"&&!n?oe?o.jsxs(o.Fragment,{children:[o.jsx(Le,{onSetView:E}),o.jsx("div",{className:"fixed bottom-4 right-4 max-w-md bg-red-900/90 border border-red-800 rounded-lg p-4 shadow-xl z-50",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(lt,{className:"w-5 h-5 text-red-400 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-red-300 font-bold mb-2",children:"–í–Ω–∏–º–∞–Ω–∏–µ: –û—à–∏–±–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏"}),o.jsx("p",{className:"text-red-200 text-sm mb-2",children:"Firebase –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–≥—É—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞—Ç—å."}),o.jsx("button",{onClick:()=>E("login"),className:"text-xs text-red-300 hover:text-red-200 underline",children:"–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"})]}),o.jsx("button",{onClick:()=>Pe(null),className:"text-red-400 hover:text-red-300",children:o.jsx(dt,{className:"w-4 h-4"})})]})})]}):o.jsx(Le,{onSetView:E}):oe?o.jsx(Bs,{configError:oe}):He&&n?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-slate-950",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-600 mb-4"}),o.jsx("p",{className:"text-slate-400",children:"–ó–∞–≥—Ä—É–∑–∫–∞..."})]})}):A==="login"||A==="register"?o.jsx(Ls,{authMode:Ce,loginData:bt,error:ge,success:Me,onEmailChange:yt,onPasswordChange:Dt,onNameChange:Et,onAuthModeLogin:Nt,onAuthModeRegister:kt,onLogin:vt,onRegister:At,onGoogleSignIn:Ct,googleSignInLoading:Ge,onSetView:E}):A==="admin"?!n||n.role!=="admin"?(a.warn("Auth","–ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ –±–µ–∑ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",{userId:n?.id,role:n?.role}),E("dashboard"),g("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏"),null):o.jsx(Rs,{currentUser:n,users:k,setUsers:q,setCurrentUser:P,tariffs:_,setTariffs:ne,setError:g,setSuccess:w,children:o.jsx(Fs,{currentUser:n,adminTab:mt,onSetAdminTab:ft,onSetView:E,onHandleLogout:we,users:k,editingUser:gt,onSetEditingUser:Be,onHandleUpdateUser:is,onHandleDeleteUser:Pt,onHandleCopy:Je,servers:U,editingServer:C,onSetEditingServer:j,onHandleAddServer:ss,onHandleSaveServer:as,onHandleDeleteServer:rs,onHandleTestServerSession:ns,testingServerId:It,newServerIdRef:le,settingsLoading:wt,tariffs:_,editingTariff:K,onSetEditingTariff:B,onHandleSaveTariff:hs,onHandleDeleteTariff:gs,onHandleSaveSettings:Ht,formatDate:ot,showLogger:$e,onSetShowLogger:Oe,success:Me,error:ge,onHandleServerNameChange:Gt,onHandleServerIPChange:Kt,onHandleServerPortChange:qt,onHandleServerProtocolChange:zt,onHandleServerRandomPathChange:Xt,onHandleServerRandomPathBlur:Wt,onHandleServerUsernameChange:Jt,onHandleServerPasswordChange:Yt,onHandleServerInboundIdChange:Qt,onHandleServerLocationChange:Zt,onHandleServerActiveChange:es,onHandleServerTariffChange:ts,onHandleTariffNameChange:os,onHandleTariffPlanChange:ls,onHandleTariffPriceChange:ds,onHandleTariffDevicesChange:cs,onHandleTariffTrafficGBChange:us,onHandleTariffDurationDaysChange:ms,onHandleTariffActiveChange:fs})}):n&&(A==="dashboard"||!A||A==="landing")?o.jsx(bs,{currentUser:n,view:A,onSetView:E,onLogout:we,tariffs:_,loadTariffs:ke,dashboardTab:re,onSetDashboardTab:ht,editingProfile:Ae,onSetEditingProfile:Ve,profileData:ee,onSetProfileData:pe,creatingSubscription:Lt,onHandleCreateSubscription:Ne,onHandleRenewSubscription:Bt,onHandleDeleteSubscription:Vt,onHandleUpdateProfile:Ot,onHandleDeleteAccount:Mt,onProfileNameChange:_t,onProfilePhoneChange:$t,payments:jt,paymentsLoading:Rt,loadPayments:de,formatDate:ot,formatTraffic:_s,settings:M,onCopy:Je,showKeyModal:ut,onSetShowKeyModal:_e,showLogger:$e,onSetShowLogger:Oe,onGetKey:Tt}):ae||He?o.jsx("div",{className:"min-h-screen bg-slate-950 flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mb-4"}),o.jsx("p",{className:"text-slate-400 text-sm",children:"–ó–∞–≥—Ä—É–∑–∫–∞..."})]})}):o.jsx(Le,{onSetView:E})}export{Ws as default};
