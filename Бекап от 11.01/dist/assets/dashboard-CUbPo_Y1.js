import{d as O,c as re,u as Z,h as pe,k as Se,f as De,q as Ie,w as ke,j as Pe}from"./firebase-vendor-BkZVVcGE.js";import{l as i,d as v,A as M,g as _e,S as Ae,L as Le}from"./admin-Vghk5KXC.js";import{a as $e}from"./vendor-DMb609Cv.js";import{j as e,G as ye,X as je,e as ve,f as fe,c as le,C as Ne,r as $,J as me,K as ce,o as Re,D as Fe,w as Ce,E as he,k as Oe,N as ze,O as de,h as qe,Q as We,T as Ee,n as ge,Z as Be,d as Ve}from"./react-vendor-6qOBSu6s.js";const Xe="modulepreload",Ke=function(s){return"/"+s},Te={},Me=function(t,a,r){let l=Promise.resolve();if(a&&a.length>0){let g=function(u){return Promise.all(u.map(m=>Promise.resolve(m).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),x=d?.nonce||d?.getAttribute("nonce");l=g(a.map(u=>{if(u=Ke(u),u in Te)return;Te[u]=!0;const m=u.endsWith(".css"),b=m?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${b}`))return;const c=document.createElement("link");if(c.rel=m?"stylesheet":Xe,m||(c.as="script"),c.crossOrigin="",c.href=u,x&&c.setAttribute("nonce",x),document.head.appendChild(c),m)return new Promise((S,f)=>{c.addEventListener("load",S),c.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${u}`)))})}))}function o(d){const x=new Event("vite:preloadError",{cancelable:!0});if(x.payload=d,window.dispatchEvent(x),!x.defaultPrevented)throw d}return l.then(d=>{for(const x of d||[])x.status==="rejected"&&o(x.reason);return t().catch(o)})};class Ge{constructor(){this.interactions=[],this.maxInteractions=500,this.metrics={totalRequests:0,successfulRequests:0,failedRequests:0,totalResponseTime:0,averageResponseTime:0,errorsByType:{},requestsByEndpoint:{}}}logRequest(t,a,r={}){const l=`xui_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,o=Date.now(),d={id:l,timestamp:o,method:t.toUpperCase(),endpoint:a,url:r.url||a,baseURL:r.baseURL,fullURL:r.fullURL||`${r.baseURL||""}${a}`,headers:this.sanitizeHeaders(r.headers||{}),params:r.params||{},data:this.sanitizeData(r.data),status:"pending",startTime:performance.now()};return this.interactions.push(d),this.trimInteractions(),this.metrics.totalRequests++,this.metrics.requestsByEndpoint[a]=(this.metrics.requestsByEndpoint[a]||0)+1,i.info("XUI",`‚Üí ${t.toUpperCase()} ${a}`,{interactionId:l,endpoint:a,method:t.toUpperCase(),headers:d.headers,params:d.params,data:d.data}),l}logResponse(t,a){const r=this.findInteraction(t);if(!r)return;const l=performance.now(),o=l-r.startTime;r.status="success",r.responseTime=o,r.statusCode=a.status,r.statusText=a.statusText,r.data=this.sanitizeData(a.data),r.headers=this.sanitizeHeaders(a.headers||{}),r.endTime=l,this.metrics.successfulRequests++,this.metrics.totalResponseTime+=o,this.metrics.averageResponseTime=this.metrics.totalResponseTime/this.metrics.successfulRequests,i.info("XUI",`‚Üê ${a.status} ${r.method} ${r.endpoint}`,{interactionId:t,status:a.status,statusText:a.statusText,responseTime:`${o.toFixed(2)}ms`,data:r.data,headers:r.headers})}logError(t,a){const r=this.findInteraction(t);if(!r){const x=this.logRequest("ERROR","unknown",{});this.logError(x,a);return}const l=performance.now(),o=l-r.startTime;r.status="error",r.responseTime=o,r.error={message:a.message,code:a.code,status:a.response?.status,statusText:a.response?.statusText,data:this.sanitizeData(a.response?.data),stack:a.stack},r.endTime=l,this.metrics.failedRequests++;const d=a.response?.status?`HTTP_${a.response.status}`:a.code||"UNKNOWN";this.metrics.errorsByType[d]=(this.metrics.errorsByType[d]||0)+1,i.error("XUI",`‚úó ${r.method} ${r.endpoint}`,{interactionId:t,error:r.error,responseTime:`${o.toFixed(2)}ms`,url:r.fullURL},a)}logEvent(t,a={}){const r={id:`event_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now(),type:"event",event:t,data:this.sanitizeData(a),status:"success"};this.interactions.push(r),this.trimInteractions(),i.info("XUI",`üìå ${t}`,a)}getHistory(t={}){let a=[...this.interactions];if(t.status&&(a=a.filter(r=>r.status===t.status)),t.endpoint&&(a=a.filter(r=>r.endpoint?.includes(t.endpoint))),t.method&&(a=a.filter(r=>r.method===t.method.toUpperCase())),t.since){const r=Date.now()-t.since;a=a.filter(l=>l.timestamp>=r)}return t.limit&&(a=a.slice(-t.limit)),a.reverse()}getMetrics(){return{...this.metrics,successRate:this.metrics.totalRequests>0?(this.metrics.successfulRequests/this.metrics.totalRequests*100).toFixed(2)+"%":"0%",errorRate:this.metrics.totalRequests>0?(this.metrics.failedRequests/this.metrics.totalRequests*100).toFixed(2)+"%":"0%"}}clearHistory(){this.interactions=[],i.info("XUI","–ò—Å—Ç–æ—Ä–∏—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π –æ—á–∏—â–µ–Ω–∞")}resetMetrics(){this.metrics={totalRequests:0,successfulRequests:0,failedRequests:0,totalResponseTime:0,averageResponseTime:0,errorsByType:{},requestsByEndpoint:{}},i.info("XUI","–ú–µ—Ç—Ä–∏–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã")}findInteraction(t){return this.interactions.find(a=>a.id===t)}trimInteractions(){if(this.interactions.length>this.maxInteractions){const t=this.interactions.length-this.maxInteractions;this.interactions=this.interactions.slice(-this.maxInteractions),i.debug("XUI",`–ò—Å—Ç–æ—Ä–∏—è –æ–±—Ä–µ–∑–∞–Ω–∞, —É–¥–∞–ª–µ–Ω–æ ${t} –∑–∞–ø–∏—Å–µ–π`)}}sanitizeHeaders(t){if(!t||typeof t!="object")return{};const a={...t},r=["authorization","cookie","x-api-key","set-cookie"];return Object.keys(a).forEach(l=>{r.some(o=>l.toLowerCase().includes(o.toLowerCase()))&&(a[l]="***REDACTED***")}),a}sanitizeData(t){if(!t)return null;if(typeof t=="string")try{const a=JSON.parse(t);return this.sanitizeObject(a)}catch{return t.length>200?t.substring(0,200)+"...":t}return typeof t=="object"?this.sanitizeObject(t):t}sanitizeObject(t){if(!t||typeof t!="object")return t;if(Array.isArray(t))return t.map(l=>this.sanitizeObject(l));const a=["password","token","apiKey","secret","key","auth","credentials","cookie"],r={...t};return Object.keys(r).forEach(l=>{a.some(o=>l.toLowerCase().includes(o.toLowerCase()))?r[l]="***REDACTED***":typeof r[l]=="object"&&r[l]!==null&&(r[l]=this.sanitizeObject(r[l]))}),r}}const ae=new Ge;class V{static instance=null;constructor(){if(V.instance)return V.instance;this.baseURL="/api/vpn",this.api=$e.create({baseURL:this.baseURL,withCredentials:!0,headers:{"Content-Type":"application/json",Accept:"application/json"},timeout:3e4}),this.setupInterceptors(),V.instance=this}static getInstance(){return V.instance||(V.instance=new V),V.instance}setupInterceptors(){this.api.interceptors.request.use(t=>{const a=ae.logRequest(t.method||"GET",t.url||"",{url:t.url,baseURL:t.baseURL,fullURL:`${t.baseURL}${t.url}`,headers:t.headers,params:t.params,data:t.data});return t.metadata=t.metadata||{},t.metadata.interactionId=a,t},t=>(ae.logError(null,t),Promise.reject(t))),this.api.interceptors.response.use(t=>{const a=t.config?.metadata?.interactionId;return a&&ae.logResponse(a,t),t},t=>{const a=t.config?.metadata?.interactionId;return a?ae.logError(a,t):ae.logError(null,t),Promise.reject(t)})}async healthCheck(){try{return{status:"ok",proxy:!0,data:(await this.api.get("/health",{timeout:5e3})).data}}catch(t){return i.error("XUIService","Health check failed",null,t),{status:"error",proxy:!1,error:t.message}}}async addClient(t){try{if(!t.clientId||t.clientId.trim()==="")throw console.error("‚ùå XUIService.addClient: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç clientId!"),console.error("üìã –ü–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (userData):",JSON.stringify(t,null,2)),console.error("üìã –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–∞–Ω–Ω—ã—Ö:",{hasClientId:!!t.clientId,clientId:t.clientId,clientIdType:typeof t.clientId,clientIdLength:t.clientId?t.clientId.length:0,allKeys:Object.keys(t),userId:t.userId,email:t.email,inboundId:t.inboundId}),new Error("–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç clientId. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ user.uuid –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∑–∞–ø—Ä–æ—Å.");i.info("XUIService","–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ Proxy",{userId:t.userId,email:t.email,inboundId:t.inboundId,clientId:t.clientId,hasWebhookUrl:!!t.webhookUrl});const a={headers:{}};t.webhookUrl&&t.webhookUrl.trim()&&(a.headers["X-N8N-Webhook-Url"]=t.webhookUrl.trim(),i.info("XUIService","–ü–µ—Ä–µ–¥–∞—á–∞ webhook URL –∏–∑ Firestore",{webhookUrl:t.webhookUrl.trim()}));const r=await this.api.post("/add-client",t,a);return i.info("XUIService","–ö–ª–∏–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω",{userId:t.userId,email:t.email,vpnUuid:r.data.vpnUuid}),r.data}catch(a){i.error("XUIService","–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞",{userId:t.userId,email:t.email,errorStatus:a.response?.status,errorData:a.response?.data},a);let r=a.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞";if(a.response?.status===500||a.response?.status===400){const l=a.response?.data;if(l?.errorMessage)r=l.errorMessage,r.includes("Unused Respond to Webhook")&&(r=r+`

üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: —Å–º. —Ñ–∞–π–ª N8N_WORKFLOW_SETUP.md –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞`);else if(l?.error||l?.msg){const o=l.error||l.msg;o.includes("not registered")||o.includes("not found")?r=`Webhook –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ n8n. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ workflow –∞–∫—Ç–∏–≤–µ–Ω –∏ webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –î–µ—Ç–∞–ª–∏: ${o}`:r=`–û—à–∏–±–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ n8n: ${o}`}else r="–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (500). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ n8n –∏ backend proxy."}else a.response?.status===404?r="Webhook –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å N8N_WEBHOOK_ID –∏ —á—Ç–æ workflow –∞–∫—Ç–∏–≤–µ–Ω –≤ n8n.":a.response?.data?.errorMessage?(r=a.response.data.errorMessage,r.includes("Unused Respond to Webhook")&&(r=r+`

üìñ –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é: —Å–º. —Ñ–∞–π–ª N8N_WORKFLOW_SETUP.md –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞`),a.response.data.errorDetails&&(r+=`

–î–µ—Ç–∞–ª–∏: ${JSON.stringify(a.response.data.errorDetails,null,2)}`)):a.response?.data?.error||a.response?.data?.msg?r=a.response.data.error||a.response.data.msg:a.code==="ECONNREFUSED"&&(r="–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ backend proxy. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:3001");throw new Error(r)}}async deleteClient(t){try{i.info("XUIService","–£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ —á–µ—Ä–µ–∑ Proxy",{email:t.email,inboundId:t.inboundId,hasWebhookUrl:!!t.webhookUrl});const a={headers:{}};t.webhookUrl&&t.webhookUrl.trim()&&(a.headers["X-N8N-Webhook-Url"]=t.webhookUrl.trim(),i.info("XUIService","–ü–µ—Ä–µ–¥–∞—á–∞ webhook URL –∏–∑ Firestore",{webhookUrl:t.webhookUrl.trim()}));const r=await this.api.post("/delete-client",t,a);return i.info("XUIService","–ö–ª–∏–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω",{email:t.email}),r.data}catch(a){i.error("XUIService","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞",{email:t.email,inboundId:t.inboundId,errorStatus:a.response?.status,errorData:a.response?.data},a);let r=a.message||"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞";if(a.response?.status===500){const l=a.response?.data;if(l?.error||l?.msg){const o=l.error||l.msg;o.includes("Unused Respond to Webhook")?r='–û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ workflow –≤ n8n: –æ–±–Ω–∞—Ä—É–∂–µ–Ω –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —É–∑–µ–ª "Respond to Webhook". –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É workflow –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞.':o.includes("not registered")||o.includes("not found")?r=`Webhook –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –≤ n8n. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ workflow –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –∞–∫—Ç–∏–≤–µ–Ω –∏ webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ. –î–µ—Ç–∞–ª–∏: ${o}`:r=`–û—à–∏–±–∫–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ n8n: ${o}`}else r="–í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (500). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ n8n –∏ backend proxy."}else a.response?.status===404?r="Webhook –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å N8N_WEBHOOK_DELETE_CLIENT –∏ —á—Ç–æ workflow –∞–∫—Ç–∏–≤–µ–Ω –≤ n8n.":a.response?.data?.error||a.response?.data?.msg?r=a.response.data.error||a.response.data.msg:a.code==="ECONNREFUSED"&&(r="–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ backend proxy. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:3001");throw new Error(r)}}async getClientStats(t){try{const a={...t,...t.operation?{}:{operation:"get_client_stats",category:"get_user_data",timestamp:new Date().toISOString()}};return(await this.api.post("/client-stats",a)).data}catch(a){throw i.error("XUIService","–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞",{email:t.email},a),new Error(a.response?.data?.msg||a.response?.data?.error||a.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–ª–∏–µ–Ω—Ç–∞")}}async getInbounds(){try{return(await this.api.get("/inbounds",{params:{operation:"get_inbounds",category:"get_server_data",timestamp:new Date().toISOString()}})).data.inbounds||[]}catch(t){throw i.error("XUIService","–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –∏–Ω–±–∞—É–Ω–¥–æ–≤",null,t),new Error(t.response?.data?.msg||t.response?.data?.error||t.message||"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–Ω–±–∞—É–Ω–¥–æ–≤")}}async getInbound(t){try{return(await this.api.get(`/inbounds/${t}`,{params:{operation:"get_inbound",category:"get_server_data",timestamp:new Date().toISOString()}})).data.inbound}catch(a){throw i.error("XUIService","–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω–±–∞—É–Ω–¥–∞",{inboundId:t},a),new Error(a.response?.data?.msg||a.response?.data?.error||a.message||`–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –∏–Ω–±–∞—É–Ω–¥ —Å ID ${t}`)}}getHistory(t={}){return ae.getHistory(t)}getMetrics(){return ae.getMetrics()}generateUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const a=Math.random()*16|0;return(t==="x"?a:a&3|8).toString(16)})}}async function ue(){if(!v)return null;try{const s=O(v,`artifacts/${M}/public/settings`),t=await re(s);if(t.exists()){const a=t.data(),r=a.n8nWebhookUrl||a.webhookUrl||null;return r&&i.debug("Dashboard","Webhook URL –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ Firestore",{webhookUrl:r}),r}}catch(s){i.warn("Dashboard","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ webhook URL –∏–∑ Firestore",null,s)}return null}const He={async loadPayments(s){if(!v||!s)return[];try{const t=pe(v,`artifacts/${M}/public/data/payments`),a=Ie(t,ke("userId","==",s)),r=await Pe(a),l=[];return r.forEach(o=>{l.push({id:o.id,...o.data()})}),l.sort((o,d)=>{const x=o.createdAt?new Date(o.createdAt).getTime():0;return(d.createdAt?new Date(d.createdAt).getTime():0)-x}),i.info("Dashboard","–ü–ª–∞—Ç–µ–∂–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã",{userId:s,count:l.length}),l}catch(t){throw i.error("Dashboard","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π",{userId:s},t),t}},async updateProfile(s,t){if(!v||!s)throw new Error("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –∏–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è");try{const a=O(v,`artifacts/${M}/public/data/users_v4`,s);return await Z(a,{name:t.name.trim(),phone:t.phone.trim(),updatedAt:new Date().toISOString()}),i.info("Dashboard","–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª–µ–Ω",{userId:s}),{name:t.name.trim(),phone:t.phone.trim()}}catch(a){throw i.error("Dashboard","–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è",{userId:s},a),a}},async deleteAccount(s){if(!v||!s||!s.id)throw new Error("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –∏–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è");try{if(s.uuid)try{{const x=V.getInstance(),g={operation:"delete_client",category:"delete_client",timestamp:new Date().toISOString(),userId:s.id,userUuid:s.uuid,userName:s.name||s.email?.split("@")[0]||"User",userEmail:s.email,inboundId:parseInt("1"),email:s.email},u=await ue();u&&(g.webhookUrl=u),await x.deleteClient(g),i.info("Dashboard","–ö–ª–∏–µ–Ω—Ç —É–¥–∞–ª–µ–Ω –∏–∑ 3x-ui",{email:s.email})}}catch(d){i.warn("Dashboard","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ 3x-ui",{email:s.email},d)}const t=O(v,`artifacts/${M}/public/data/users_v4`,s.id);await De(t),i.info("Dashboard","–î–æ–∫—É–º–µ–Ω—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–¥–∞–ª–µ–Ω –∏–∑ Firestore",{userId:s.id});const a=pe(v,`artifacts/${M}/public/data/payments`),r=Ie(a,ke("userId","==",s.id)),l=await Pe(r),o=[];l.forEach(d=>{o.push(De(O(v,`artifacts/${M}/public/data/payments`,d.id)))}),await Promise.all(o),i.info("Dashboard","–ê–∫–∫–∞—É–Ω—Ç —É–¥–∞–ª–µ–Ω",{userId:s.id,email:s.email})}catch(t){throw i.error("Dashboard","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –∞–∫–∫–∞—É–Ω—Ç–∞",{userId:s.id},t),t}},async getKey(s){if(!v||!s)throw new Error("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω");const t=V.getInstance();let a=s.uuid;if(!a||a.trim()===""){i.warn("Dashboard","UUID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ –Ω–∞–π–¥–µ–Ω, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π",{email:s.email,userId:s.id}),a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,j=>{const I=Math.random()*16|0;return(j==="x"?I:I&3|8).toString(16)});try{const j=O(v,`artifacts/${M}/public/data/users_v4`,s.id);await Z(j,{uuid:a,updatedAt:new Date().toISOString()}),i.info("Dashboard","UUID —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ Firestore",{email:s.email,userId:s.id,uuid:a})}catch(j){i.warn("Dashboard","–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è UUID –≤ Firestore",{userId:s.id},j)}}i.info("Dashboard","–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è UUID –∏–∑ –ø—Ä–æ—Ñ–∏–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{email:s.email,uuid:a});let r=0,l=s.expiresAt||0,o=s.devices||1,d="1",x=null;if(s.tariffId)try{const j=O(v,`artifacts/${M}/public/data/tariffs`,s.tariffId),I=await re(j);I.exists()?(x=I.data(),r=x.trafficGB>0?x.trafficGB:0,x.devices&&x.devices>0?o=x.devices:s.devices&&s.devices>0&&(o=s.devices),!l&&x.durationDays>0&&(l=Date.now()+x.durationDays*24*60*60*1e3),i.info("Dashboard","–¢–∞—Ä–∏—Ñ –∑–∞–≥—Ä—É–∂–µ–Ω",{tariffId:s.tariffId,totalGB:r,limitIp:o,expiryTime:l>0?new Date(l).toISOString():"–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π"})):i.warn("Dashboard","–¢–∞—Ä–∏—Ñ –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ Firestore",{tariffId:s.tariffId})}catch(j){i.warn("Dashboard","–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–∞—Ä–∏—Ñ–∞",{tariffId:s.tariffId},j)}if(!l||l===0){const j=s.firstKeyDate||s.createdAt;if(j)l=new Date(j).getTime()+1440*60*1e3,i.info("Dashboard","–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–π —Å—Ä–æ–∫ 24 —á–∞—Å–∞ –æ—Ç –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –¥–∞—Ç—ã",{firstKeyDate:new Date(j).toISOString(),expiryTime:new Date(l).toISOString()});else{l=Date.now()+1440*60*1e3;const I=new Date().toISOString();try{const P=O(v,`artifacts/${M}/public/data/users_v4`,s.id);await Z(P,{firstKeyDate:I,updatedAt:new Date().toISOString()}),i.info("Dashboard","–ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –¥–∞—Ç–∞ –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –∫–ª—é—á–∞",{userId:s.id,firstKeyDate:I})}catch(P){i.warn("Dashboard","–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è firstKeyDate",{userId:s.id},P)}i.info("Dashboard","–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–µ—Å—Ç–æ–≤—ã–π —Å—Ä–æ–∫ 24 —á–∞—Å–∞ (–ø–µ—Ä–≤–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ)",{expiryTime:new Date(l).toISOString()})}}const g=s.subId||"";g||i.warn("Dashboard","–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç subId, —ç—Ç–æ –º–æ–∂–µ—Ç –≤—ã–∑–≤–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å 3x-ui",{userId:s.id,email:s.email});const u=s.tgId||"";let m=null,b=null,c=null,S=null,f=null,D=null,k=null;try{const j=O(v,`artifacts/${M}/public/settings`),I=await re(j),F=(I.exists()?I.data():{}).servers||[];i.info("Dashboard","–ü–æ–∏—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Å —Å–µ—Å—Å–∏–µ–π –¥–ª—è getKey",{totalServers:F.length});for(const y of F)if(y.active&&y.sessionCookie&&y.sessionCookieReceivedAt){const H=Date.now()-new Date(y.sessionCookieReceivedAt).getTime(),X=3600*1e3;if(H<X){m=y.id,b=y.sessionCookie,c=y.serverIP,S=y.serverPort,f=y.randompath,D=y.protocol||(y.serverPort===443||y.serverPort===40919?"https":"http"),k=y.xuiInboundId||d,i.info("Dashboard","–ù–∞–π–¥–µ–Ω –∞–∫—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å —Å–µ—Å—Å–∏–µ–π",{serverId:m,serverName:y.name,serverInboundId:k,sessionAge:Math.round(H/1e3/60)+" –º–∏–Ω—É—Ç"});break}else i.warn("Dashboard","–°–µ—Å—Å–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –∏—Å—Ç–µ–∫–ª–∞",{serverId:y.id,serverName:y.name,sessionAge:Math.round(H/1e3/60)+" –º–∏–Ω—É—Ç"})}if(!m||!b||!c||!S)throw new Error("–ù–µ –Ω–∞–π–¥–µ–Ω –∞–∫—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Å–µ—Å—Å–∏–µ–π. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç —Å–µ—Å—Å–∏–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞.")}catch(j){throw i.error("Dashboard","–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ —Å —Å–µ—Å—Å–∏–µ–π",null,j),new Error("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å–µ—Å—Å–∏—é —Å–µ—Ä–≤–µ—Ä–∞. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç —Å–µ—Å—Å–∏–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞.")}const U=k||d,W=!s.tariffId||!s.uuid||!s.plan;try{const j={operation:"add_client",category:W?"new_subscription":"update_subscription",timestamp:new Date().toISOString(),userId:s.id,userUuid:a,userName:s.name||s.email?.split("@")[0]||"User",userEmail:s.email,email:s.name||s.email,inboundId:parseInt(U),totalGB:r,expiryTime:l,limitIp:o,clientId:a,subId:g,tgId:u,serverId:m,sessionCookie:b,serverIP:c,serverPort:S,randompath:f,protocol:D};W&&(j.subscriptionDetails={tariffName:"FREE",devices:o,period:{expiryDate3xui:l,expiryDateIso:l>0?new Date(l).toISOString():null,expiryDateUnix:l>0?Math.floor(l/1e3):0},userName:s.name||s.email?.split("@")[0]||"User",profileUuid:a});const I=await ue();I&&(j.webhookUrl=I,i.info("Dashboard","Webhook URL –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ Firestore –∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∑–∞–ø—Ä–æ—Å",{webhookUrl:I}));const P=await t.addClient(j);i.info("Dashboard","–ö–ª–∏–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –≤ 3x-ui —á–µ—Ä–µ–∑ Proxy",{email:s.email,uuid:P.vpnUuid||a,serverId:m,totalGB:r,expiryTime:l>0?new Date(l).toISOString():"–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π"});const F=s.subId||"";if(!F)throw i.error("Dashboard","–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç subId, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –ø–æ–¥–ø–∏—Å–∫–∏",{userId:s.id,email:s.email}),new Error("–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç subId –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.");const y=`https://subs.skypath.fun:3458/vk198/${F}`;return i.info("Dashboard","–°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –¥–ª—è getKey",{userId:s.id,email:s.email,subscriptionLink:y}),y}catch(j){throw i.error("Dashboard","–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –≤ 3x-ui",{email:s.email,inboundId:d,serverId:m},j),j}},async createSubscription(s,t,a=null,r=null,l=1,o=!1,d="pay_now",x=0){if(console.log("üéØ dashboardService.createSubscription: –ù–∞—á–∞–ª–æ —Ñ—É–Ω–∫—Ü–∏–∏",{userId:s?.id,userEmail:s?.email,tariffName:t?.name,tariffId:t?.id,devices:a,natrockPort:r,periodMonths:l,testPeriod:o,paymentMode:d,discount:x,hasDb:!!v,hasUser:!!s,hasTariff:!!t}),!v||!s||!t){const p=[];throw v||p.push("db"),s||p.push("user"),t||p.push("tariff"),console.error("‚ùå dashboardService.createSubscription: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ:",p),new Error(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç: ${p.join(", ")}`)}const g="1";console.log("üîÑ dashboardService.createSubscription: –ü–æ–ª—É—á–µ–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ XUIService...");const u=V.getInstance();console.log("‚úÖ dashboardService.createSubscription: XUIService –ø–æ–ª—É—á–µ–Ω",{hasXuiService:!!u});let m=s.uuid;!m||m.trim()===""?(m="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,p=>{const L=Math.random()*16|0;return(p==="x"?L:L&3|8).toString(16)}),i.info("Dashboard","UUID —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏",{email:s.email,uuid:m})):i.info("Dashboard","–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π UUID –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏",{email:s.email,uuid:m});const b=a||t.devices||s.devices||1,c=l||1,S=Date.now();let f=0,D=null,k=null,U="paid";if(o&&d==="pay_later")D=S,k=S+1440*60*1e3,f=k,U="test_period";else{const p=c*30;f=S+p*24*60*60*1e3,U="paid"}let W=null,j=null,I=null,P=null,F=null,y=null,H=null,X=null,J=null;try{const p=O(v,`artifacts/${M}/public/settings`),L=await re(p),_=(L.exists()?L.data():{}).servers||[];i.info("Dashboard","–ü–æ–∏—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ —Å —Å–µ—Å—Å–∏–µ–π –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫",{totalServers:_.length,hasSettings:L.exists()});let B=_.filter(N=>N.tariffIds&&N.tariffIds.length>0?N.tariffIds.includes(t.id):!0);B.length===0&&(B=_,i.warn("Dashboard","–ù–µ –Ω–∞–π–¥–µ–Ω–æ —Å–µ—Ä–≤–µ—Ä–æ–≤ –¥–ª—è —Ç–∞—Ä–∏—Ñ–∞, –∏—Å–ø–æ–ª—å–∑—É–µ–º –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ",{tariffId:t.id}));let T=null;for(const N of B){const A=N.sessionCookie&&N.sessionCookieReceivedAt,n=N.active!==!1;if(i.debug("Dashboard","–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞",{serverId:N.id,serverName:N.name,isActive:n,hasSession:A,hasCredentials:!!(N.xuiUsername&&N.xuiPassword),tariffIds:N.tariffIds}),A){const w=Date.now()-new Date(N.sessionCookieReceivedAt).getTime(),R=3600*1e3;if(w<R){T=N,i.info("Dashboard","–ù–∞–π–¥–µ–Ω —Å–µ—Ä–≤–µ—Ä —Å –≤–∞–ª–∏–¥–Ω–æ–π —Å–µ—Å—Å–∏–µ–π",{serverId:N.id,serverName:N.name,sessionAge:Math.round(w/1e3/60)+" –º–∏–Ω—É—Ç",inboundId:N.xuiInboundId});break}else i.debug("Dashboard","–°–µ—Å—Å–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –∏—Å—Ç–µ–∫–ª–∞",{serverId:N.id,serverName:N.name,sessionAge:Math.round(w/1e3/60)+" –º–∏–Ω—É—Ç"})}}if(!T){i.warn("Dashboard","–°–µ—Ä–≤–µ—Ä —Å –≤–∞–ª–∏–¥–Ω–æ–π —Å–µ—Å—Å–∏–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω, –∏—â–µ–º –ª—é–±–æ–π –∞–∫—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä",{});for(const N of B){const A=N.active!==!1,n=N.xuiUsername&&N.xuiPassword,w=N.serverIP&&N.serverPort;if(A&&n&&w){T=N,i.info("Dashboard","–ù–∞–π–¥–µ–Ω –∞–∫—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å credentials (—Å–µ—Å—Å–∏—è –±—É–¥–µ—Ç –ø–æ–ª—É—á–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)",{serverId:N.id,serverName:N.name,inboundId:N.xuiInboundId});break}}}if(!T){const N=_.map(A=>({id:A.id,name:A.name,active:A.active,hasSession:!!(A.sessionCookie&&A.sessionCookieReceivedAt),hasCredentials:!!(A.xuiUsername&&A.xuiPassword),hasServerInfo:!!(A.serverIP&&A.serverPort),tariffIds:A.tariffIds||[]}));throw i.error("Dashboard","–ù–µ –Ω–∞–π–¥–µ–Ω –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Å–µ—Ä–≤–µ—Ä",{availableServers:N,requestedTariffId:t.id}),new Error("–ù–µ –Ω–∞–π–¥–µ–Ω –∞–∫—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π —Å–µ—Å—Å–∏–µ–π –∏–ª–∏ —É—á–µ—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ç–∞—Ä–∏—Ñ–∞. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Ç–µ—Å—Ç —Å–µ—Å—Å–∏–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö —Å–µ—Ä–≤–µ—Ä–∞.")}if(W=T.id,j=T.sessionCookie||null,I=T.serverIP,P=T.serverPort,F=T.randompath,y=T.protocol||(T.serverPort===443||T.serverPort===40919?"https":"http"),H=T.xuiUsername,X=T.xuiPassword,J=T.xuiInboundId,i.info("Dashboard","–î–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–ª—É—á–µ–Ω—ã",{serverId:W,serverName:T.name,serverIP:I,serverPort:P,hasSession:!!j,inboundId:J}),!j&&H&&X&&i.info("Dashboard","–°–µ—Å—Å–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –Ω–æ –µ—Å—Ç—å credentials - –±—ç–∫–µ–Ω–¥ –ø–æ–ª—É—á–∏—Ç —Å–µ—Å—Å–∏—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏",{serverId:W,serverName:T.name}),!I||!P)throw new Error("–£ —Å–µ—Ä–≤–µ—Ä–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è serverIP –∏–ª–∏ serverPort");J||(i.warn("Dashboard","–£ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ —É–∫–∞–∑–∞–Ω xuiInboundId, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è",{serverId:W,inboundIdFromEnv:g}),J=g||"1")}catch(p){throw i.error("Dashboard","–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞ —Å —Å–µ—Å—Å–∏–µ–π",null,p),p}const se=J||g,h=f,C=!s.tariffId||!s.plan||s.tariffId!==t.id,K={operation:"add_client",category:C?"new_subscription":"update_subscription",timestamp:new Date().toISOString(),userId:s.id,userUuid:m,userName:s.name||s.email?.split("@")[0]||"User",userEmail:s.email,email:s.name||s.email,inboundId:parseInt(se),totalGB:o?3:t.trafficGB>0?t.trafficGB:0,expiryTime:h,limitIp:b,clientId:m,subId:s.subId||"",tgId:s.tgId||"",serverId:W,sessionCookie:j,serverIP:I,serverPort:P,randompath:F||"",protocol:y,...C?{subscriptionDetails:{tariffName:t.name||t.plan||"Unknown",devices:b,period:{months:c,expiryDate3xui:h,expiryDateIso:f>0?new Date(f).toISOString():null,expiryDateUnix:f>0?Math.floor(f/1e3):0},userName:s.name||s.email?.split("@")[0]||"User",profileUuid:m}}:{},...H&&X&&!j?{xuiUsername:H,xuiPassword:X}:{}};i.info("Dashboard","üì§ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–æ–∑–¥–∞–Ω–∏—é –∫–ª–∏–µ–Ω—Ç–∞ –≤ 3x-ui —á–µ—Ä–µ–∑ Proxy",{operation:K.operation,category:K.category,userId:s.id,email:s.email,clientId:m,inboundId:se,expiryTime:h,expiryTimeDate:f>0?new Date(f).toISOString():"–±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π",totalGB:o?3:t.trafficGB>0?t.trafficGB:0,limitIp:b,isNewSubscription:C,subscriptionDetails:K.subscriptionDetails});const q=K;i.info("Dashboard","üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –≤ 3x-ui",{...q,sessionCookieLength:q.sessionCookie?q.sessionCookie.length:0,hasPassword:!!q.xuiPassword,passwordLength:q.xuiPassword?q.xuiPassword.length:0}),i.info("Dashboard","üöÄ –ù–∞—á–∏–Ω–∞—é —Å–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –≤ 3x-ui",{testPeriod:o,paymentMode:d,expiryTime:h});let E;try{i.info("Dashboard","üìû –í—ã–∑–æ–≤ xuiService.addClient...",{baseURL:"/api/vpn",endpoint:"/add-client"});const p=await ue();p&&(q.webhookUrl=p,i.info("Dashboard","Webhook URL –∑–∞–≥—Ä—É–∂–µ–Ω –∏–∑ Firestore –∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∑–∞–ø—Ä–æ—Å",{webhookUrl:p})),E=await u.addClient(q),i.info("Dashboard","‚úÖ –ö–ª–∏–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –≤ 3x-ui —á–µ—Ä–µ–∑ Proxy",{hasResult:!!E,vpnUuid:E?.vpnUuid||m,sessionUpdated:E?.sessionUpdated||!1,responseKeys:E?Object.keys(E):[]}),(!E||!E.vpnUuid&&!E.success)&&i.warn("Dashboard","‚ö†Ô∏è –û—Ç–≤–µ—Ç –æ—Ç Proxy –ø–æ–ª—É—á–µ–Ω, –Ω–æ –±–µ–∑ UUID –∏–ª–∏ success",{result:E})}catch(p){if(i.error("Dashboard","‚ùå –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –≤ 3x-ui",{errorMessage:p.message,errorType:p.constructor.name,errorResponse:p.response?.data,errorStatus:p.response?.status,errorStatusText:p.response?.statusText,errorCode:p.code,requestURL:p.config?.url,requestMethod:p.config?.method,requestBaseURL:p.config?.baseURL,requestData:{...q,sessionCookie:q.sessionCookie?`[REDACTED:${q.sessionCookie.length} chars]`:null,xuiPassword:q.xuiPassword?"[REDACTED]":null},fullError:p.toString(),stack:p.stack},p),p.code==="ECONNREFUSED"||p.message?.includes("ECONNREFUSED")||p.message?.includes("connect")){const L=new Error(`Backend Proxy –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–ø–æ—Ä—Ç 3001). –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ backend proxy —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:3001

–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏: ${p.message}`);throw i.error("Dashboard","Backend Proxy –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω",null,L),L}throw p}if(i.info("Dashboard","‚úÖ –ö–ª–∏–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω –≤ 3x-ui —á–µ—Ä–µ–∑ Proxy",{email:s.email,uuid:E.vpnUuid||m,sessionUpdated:E.sessionUpdated||!1,inboundId:se,expiryTime:h,expiryTimeSeconds:f>0?Math.floor(f/1e3):0,testPeriod:o,paymentMode:d}),E.sessionUpdated&&E.sessionCookie&&E.serverId)try{const p=O(v,`artifacts/${M}/public/settings`),L=await re(p),B=((L.exists()?L.data():{}).servers||[]).map(T=>T.id===E.serverId?{...T,sessionCookie:E.sessionCookie,sessionCookieReceivedAt:E.sessionCookieReceivedAt||new Date().toISOString()}:T);await Z(p,{servers:B,updatedAt:new Date().toISOString()}),i.info("Dashboard","–°–µ—Å—Å–∏—è —Å–µ—Ä–≤–µ—Ä–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –≤ Firestore settings",{serverId:E.serverId})}catch(p){i.warn("Dashboard","–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏ –≤ Firestore",{serverId:E.serverId},p)}const ne=E.vpnUuid||m,be=O(v,`artifacts/${M}/public/settings`),ie=await re(be);ie.exists()&&ie.data();const G=s.subId||"";if(!G)throw i.error("Dashboard","–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç subId, –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –ø–æ–¥–ø–∏—Å–∫–∏",{userId:s.id,email:s.email}),new Error("–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç subId –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.");const te=`https://subs.skypath.fun:3458/vk198/${G}`,we=te,xe=O(v,`artifacts/${M}/public/data/users_v4`,s.id),oe={plan:t.plan,expiresAt:f>0?f:null,tariffName:t.name,tariffId:t.id,devices:b,natrockPort:r||null,periodMonths:c,paymentStatus:U,testPeriodStartDate:D,testPeriodEndDate:k,discount:x||0,vpnLink:te,subscriptionLink:te,updatedAt:new Date().toISOString()};if(U==="paid"&&(oe.unpaidStartDate=null),(!s.uuid||s.uuid.trim()==="")&&(oe.uuid=ne),await Z(xe,oe),i.info("Dashboard","–ü–æ–¥–ø–∏—Å–∫–∞ –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é",{userId:s.id,tariffId:t.id,devices:b,natrockPort:r,periodMonths:c,paymentStatus:U,testPeriod:o,expiryTime:f>0?new Date(f).toISOString():null}),d==="pay_now"&&!o){let p=0;if(t.name?.toLowerCase()==="super"||t.plan?.toLowerCase()==="super"){const Y=b*150*c,_=x>0?Y*x:0;p=Y-_}else p=t.price||0;if(p>0){const Y=pe(v,`artifacts/${M}/public/data/payments`);await Se(Y,{userId:s.id,email:s.email,tariffId:t.id,tariffName:t.name,amount:p,status:"completed",devices:b,periodMonths:c,discount:x||0,createdAt:new Date().toISOString()}),i.info("Dashboard","–ü–ª–∞—Ç–µ–∂ —Å–æ–∑–¥–∞–Ω",{userId:s.id,amount:p,devices:b,periodMonths:c,discount:x})}}else if(o){const p=pe(v,`artifacts/${M}/public/data/payments`);await Se(p,{userId:s.id,email:s.email,tariffId:t.id,tariffName:t.name,amount:0,status:"test",devices:b,periodMonths:c,testPeriodStartDate:D,testPeriodEndDate:k,createdAt:new Date().toISOString()}),i.info("Dashboard","–¢–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥ —Å–æ–∑–¥–∞–Ω",{userId:s.id,testPeriodEndDate:new Date(k).toISOString()})}const z={uuid:ne,plan:t.plan,expiresAt:f>0?f:null,tariffName:t.name,tariffId:t.id,devices:b,periodMonths:c,paymentStatus:U,testPeriodStartDate:D,testPeriodEndDate:k,discount:x||0,vpnLink:we,subscriptionLink:te};return console.log("‚úÖ dashboardService.createSubscription: –§—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç:",{hasUuid:!!z.uuid,tariffName:z.tariffName,devices:z.devices,periodMonths:z.periodMonths,paymentStatus:z.paymentStatus,hasVpnLink:!!z.vpnLink,expiresAt:z.expiresAt?new Date(z.expiresAt).toISOString():null}),z},async checkAndUpdateTestPeriod(s){if(!v||!s||!s.id||s.paymentStatus!=="test_period")return null;const t=Date.now();if(s.testPeriodEndDate&&s.testPeriodEndDate<t)try{const a=O(v,`artifacts/${M}/public/data/users_v4`,s.id),r=new Date().toISOString();return await Z(a,{paymentStatus:"unpaid",unpaidStartDate:r,updatedAt:new Date().toISOString()}),i.info("Dashboard","–¢–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥ –∏—Å—Ç–µ–∫, —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª–µ–Ω –Ω–∞ unpaid",{userId:s.id,testPeriodEndDate:new Date(s.testPeriodEndDate).toISOString(),unpaidStartDate:r}),{...s,paymentStatus:"unpaid",unpaidStartDate:r}}catch(a){return i.error("Dashboard","–û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞",{userId:s.id},a),null}return null},async checkAndDeleteUnpaidSubscription(s){if(!v||!s||!s.id||s.paymentStatus!=="unpaid")return null;const t=Date.now();let a=s.unpaidStartDate;if(!a&&s.testPeriodEndDate&&(a=s.testPeriodEndDate),!a){a=new Date().toISOString();try{const o=O(v,`artifacts/${M}/public/data/users_v4`,s.id);await Z(o,{unpaidStartDate:a,updatedAt:new Date().toISOString()}),i.info("Dashboard","–£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –¥–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–∏–æ–¥–∞ –Ω–µ–æ–ø–ª–∞—Ç—ã",{userId:s.id,unpaidStartDate:a})}catch(o){i.error("Dashboard","–û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ unpaidStartDate",{userId:s.id},o)}return{...s,unpaidStartDate:a}}const r=new Date(a).getTime(),l=(t-r)/(1440*60*1e3);if(l>=5){i.info("Dashboard","–ü–µ—Ä–∏–æ–¥ –Ω–µ–æ–ø–ª–∞—Ç—ã –ø—Ä–µ–≤—ã—Å–∏–ª 5 –¥–Ω–µ–π, —É–¥–∞–ª—è–µ–º –ø–æ–¥–ø–∏—Å–∫—É",{userId:s.id,unpaidStartDate:a,daysUnpaid:Math.ceil(l)});try{return await this.deleteSubscription(s),i.info("Dashboard","–ù–µ–æ–ø–ª–∞—á–µ–Ω–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª–µ–Ω–∞",{userId:s.id,daysUnpaid:Math.ceil(l)}),null}catch(o){return i.error("Dashboard","–û—à–∏–±–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏",{userId:s.id},o),s}}return s},getErrorMessage(s){if(!s)return"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.";const t=s.message||"";return t.includes("—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")||t.includes("already exists")?"–ö–ª—é—á —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.":t.includes("network")||t.includes("fetch")?"–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –ø—Ä–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏ –∫ VPN –ø–∞–Ω–µ–ª–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏.":t.includes("404")||t.includes("Not Found")?"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ø–∞–Ω–µ–ª–∏ VPN. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ XUI_HOST –∏ –ø—Ä–æ–∫—Å–∏ –≤ vite.config.js":t.includes("–Ω–µ –Ω–∞–π–¥–µ–Ω")||t.includes("not found")?`–û—à–∏–±–∫–∞: ${t}. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å VITE_XUI_INBOUND_ID.`:s.response?.status===404?"–ü–∞–Ω–µ–ª—å VPN –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ (404). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ XUI_HOST –∏ –ø—Ä–æ–∫—Å–∏.":t||"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑."},async sync_with_n8n(s){if(!v||!s||!s.id)throw new Error("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –∏–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è");try{i.info("Dashboard","–ù–∞—á–∞–ª–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å n8n",{userId:s.id,email:s.email});const t=V.getInstance(),a={operation:"sync_user",category:"get_user_data",timestamp:new Date().toISOString(),userId:s.id,userUuid:s.uuid,userName:s.name||s.email?.split("@")[0]||"User",userEmail:s.email,uuid:s.uuid},l=(await t.api.post("/sync-user",a)).data;if(!l||!l.success)return i.warn("Dashboard","n8n –Ω–µ –≤–µ—Ä–Ω—É–ª –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",{userId:s.id,response:l}),{success:!1,updated:!1,message:"n8n –Ω–µ –≤–µ—Ä–Ω—É–ª –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",changes:[]};const o=l.user||l.data||{},d=[],x={},g=["name","email","phone","uuid","vpnUuid","plan","expiresAt","tariffId","tariffName","devices","natrockPort","periodMonths","paymentStatus","testPeriodStartDate","testPeriodEndDate","discount","vpnLink","status"];for(const u of g){const m=s[u],b=o[u],c=D=>D==null?null:typeof D=="string"?D.trim():typeof D=="number"?D:D instanceof Date?D.toISOString():D,S=c(m),f=c(b);S!==f&&(f!=null&&f!==""?(d.push({field:u,oldValue:S,newValue:f}),x[u]=f):(S==null||S==="")&&(d.push({field:u,oldValue:S,newValue:f}),x[u]=f))}if(d.length>0){const u=O(v,`artifacts/${M}/public/data/users_v4`,s.id);return x.updatedAt=new Date().toISOString(),x.syncedWithN8nAt=new Date().toISOString(),x.lastSyncChanges=d.map(m=>m.field),await Z(u,x),i.info("Dashboard","–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å n8n",{userId:s.id,email:s.email,changesCount:d.length,changedFields:d.map(m=>m.field)}),{success:!0,updated:!0,message:`–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ: –æ–±–Ω–æ–≤–ª–µ–Ω–æ ${d.length} –ø–æ–ª–µ–π`,changes:d,updatedFields:d.map(m=>m.field),syncedAt:x.syncedWithN8nAt}}else{i.info("Dashboard","–î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–∫—Ç—É–∞–ª—å–Ω—ã, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è",{userId:s.id,email:s.email});const u=O(v,`artifacts/${M}/public/data/users_v4`,s.id);return await Z(u,{syncedWithN8nAt:new Date().toISOString(),lastSyncChanges:[]}),{success:!0,updated:!1,message:"–î–∞–Ω–Ω—ã–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è",changes:[],syncedAt:new Date().toISOString()}}}catch(t){throw i.error("Dashboard","–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å n8n",{userId:s.id,email:s.email},t),t.code==="ECONNREFUSED"||t.message?.includes("ECONNREFUSED")||t.message?.includes("connect")?new Error(`n8n –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ n8n –∑–∞–ø—É—â–µ–Ω –∏ webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω.

–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏: ${t.message}`):new Error(`–û—à–∏–±–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å n8n: ${t.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"}`)}},async deleteSubscription(s){if(console.log("üóëÔ∏è dashboardService.deleteSubscription: –ù–∞—á–∞–ª–æ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏",{userId:s?.id,userEmail:s?.email,userUuid:s?.uuid,hasDb:!!v}),!v||!s){const t=[];throw v||t.push("db"),s||t.push("user"),console.error("‚ùå dashboardService.deleteSubscription: –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –¥–∞–Ω–Ω—ã–µ:",t),new Error(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç: ${t.join(", ")}`)}if(!s.uuid)throw new Error("–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è");try{const t=V.getInstance(),a="1",r=O(v,`artifacts/${M}/public/settings`),l=await re(r),x=((l.exists()?l.data():{}).servers||[]).find(b=>b.active&&b.id);if(!x)throw new Error("–ù–µ –Ω–∞–π–¥–µ–Ω –∞–∫—Ç–∏–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞");i.info("Dashboard","–£–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ 3x-ui",{email:s.email,uuid:s.uuid,inboundId:a,serverId:x.id});const g={operation:"delete_client",category:"subscription_cancellation",timestamp:new Date().toISOString(),userId:s.id,email:s.email||s.name,inboundId:a,clientId:s.uuid,serverId:x.id,sessionCookie:x.sessionCookie||null,serverIP:x.serverIP,serverPort:x.serverPort,protocol:x.protocol||"https",xuiUsername:x.xuiUsername,xuiPassword:x.xuiPassword};let u=null;try{const b=await ue();b&&(g.webhookUrl=b),await t.deleteClient(g),i.info("Dashboard","–ö–ª–∏–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω –∏–∑ 3x-ui",{email:s.email,uuid:s.uuid})}catch(b){i.warn("Dashboard","–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ 3x-ui",{email:s.email,uuid:s.uuid,errorMessage:b.message,errorType:b.constructor.name});const c=b.message||"";c.includes("Unused Respond to Webhook")||c.includes("Respond to Webhook")||c.includes("workflow")||c.includes("n8n")?(i.warn("Dashboard","–û—à–∏–±–∫–∞ —Å–≤—è–∑–∞–Ω–∞ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π n8n workflow - –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —É–¥–∞–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö",{email:s.email,uuid:s.uuid}),u="–ü–æ–¥–ø–∏—Å–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞, –Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ VPN —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ n8n workflow. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ VPN —Å–µ—Ä–≤–µ—Ä–∞."):u="–ü–æ–¥–ø–∏—Å–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞, –Ω–æ –º–æ–≥—É—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –ø—Ä–æ–±–ª–µ–º—ã —Å —É–¥–∞–ª–µ–Ω–∏–µ–º –∏–∑ VPN —Å–µ—Ä–≤–µ—Ä–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏."}const m=O(v,`artifacts/${M}/public/data/users_v4`,s.id);return await Z(m,{uuid:null,plan:null,expiresAt:null,tariffName:null,tariffId:null,devices:null,natrockPort:null,periodMonths:null,paymentStatus:null,testPeriodStartDate:null,testPeriodEndDate:null,unpaidStartDate:null,discount:null,vpnLink:null,updatedAt:new Date().toISOString()}),i.info("Dashboard","–î–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –æ—á–∏—â–µ–Ω—ã –≤ Firestore",{userId:s.id,hasWarning:!!u}),{success:!0,message:u?"–ü–æ–¥–ø–∏—Å–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ VPN —Å–µ—Ä–≤–µ—Ä–∞":"–ü–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–º–µ–Ω–µ–Ω–∞",warning:u||null}}catch(t){if(i.error("Dashboard","–û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏",{userId:s.id,email:s.email},t),t.code==="ECONNREFUSED"||t.message?.includes("ECONNREFUSED")||t.message?.includes("connect"))throw new Error(`Backend Proxy –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (–ø–æ—Ä—Ç 3001). –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ backend proxy —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://localhost:3001

–î–µ—Ç–∞–ª–∏ –æ—à–∏–±–∫–∏: ${t.message}`);if(t.message?.includes("Unused Respond to Webhook")||t.message?.includes("workflow")){i.warn("Dashboard","–û—à–∏–±–∫–∞ n8n workflow, –Ω–æ –æ—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –≤ Firestore",{userId:s.id});try{const a=O(v,`artifacts/${M}/public/data/users_v4`,s.id);return await Z(a,{uuid:null,plan:null,expiresAt:null,tariffName:null,tariffId:null,devices:null,natrockPort:null,periodMonths:null,paymentStatus:null,testPeriodStartDate:null,testPeriodEndDate:null,unpaidStartDate:null,discount:null,vpnLink:null,updatedAt:new Date().toISOString()}),i.info("Dashboard","–î–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –æ—á–∏—â–µ–Ω—ã –≤ Firestore (–Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –æ—à–∏–±–∫—É n8n)",{userId:s.id}),{success:!0,message:"–ü–æ–¥–ø–∏—Å–∫–∞ –æ—Ç–º–µ–Ω–µ–Ω–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",warning:"–û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ workflow –≤ n8n. –ö–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –æ—Å—Ç–∞—Ç—å—Å—è –≤ VPN —Å–µ—Ä–≤–µ—Ä–µ. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è."}}catch(a){throw i.error("Dashboard","–ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –≤ Firestore",{userId:s.id},a),new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É. –û—à–∏–±–∫–∞ n8n workflow –∏ –æ—à–∏–±–∫–∞ Firestore. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.

–î–µ—Ç–∞–ª–∏: `+t.message)}}throw t}}},Ue=Object.freeze(Object.defineProperty({__proto__:null,dashboardService:He},Symbol.toStringTag,{value:"Module"})),Je=({user:s,onClose:t,clientStats:a=null,settings:r,onCopy:l,formatDate:o})=>{if(!s||!s.uuid&&!s.vpnLink&&!s.subscriptionLink)return null;const x=(()=>{if(Array.isArray(s?.subid)&&s.subid.length>0){const m=s.subid.find(b=>b&&String(b).trim()!=="");if(m)return String(m).trim()}return s?.subId&&String(s.subId).trim()!==""?String(s.subId).trim():null})(),g=s.subscriptionLink||s.vpnLink||(x?`https://subs.skypath.fun:3458/vk198/${x}`:null);if(!g)return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/60 backdrop-blur-md",onClick:t,children:e.jsx("div",{className:"bg-slate-900 border border-slate-800 w-full max-w-md rounded-2xl p-6",children:e.jsx("p",{className:"text-red-400",children:"–°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É."})})});const u=_e(s,a);return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4 bg-black/60 backdrop-blur-md",onClick:t,children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 w-full max-w-[90vw] sm:max-w-md rounded-2xl sm:rounded-[2.5rem] overflow-hidden shadow-2xl max-h-[90vh] overflow-y-auto",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 border-b border-slate-800 flex justify-between items-center gap-3",children:[e.jsxs("h3",{className:"text-[clamp(1rem,0.95rem+0.25vw,1.25rem)] sm:text-xl font-bold text-white flex items-center gap-2 sm:gap-3",children:[e.jsx(ye,{size:18,className:"sm:w-5 sm:h-5 sm:w-[22px] sm:h-[22px] text-blue-500 flex-shrink-0"}),e.jsx("span",{children:"–ù–∏–¥–µ—Ä–ª–∞–Ω–¥—ã"})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-full transition-colors flex-shrink-0 min-h-[44px] min-w-[44px] flex items-center justify-center touch-manipulation","aria-label":"–ó–∞–∫—Ä—ã—Ç—å",children:e.jsx(je,{size:20,className:"sm:w-6 sm:h-6 text-slate-400"})})]}),e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 space-y-4 sm:space-y-5 md:space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] text-slate-400 font-medium",children:"–°—Ç–∞—Ç—É—Å:"}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 sm:px-4 py-2 rounded-full font-bold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] ${u.status==="active"?"bg-green-900/30 text-green-400":u.status==="expired"?"bg-red-900/30 text-red-400":"bg-slate-800 text-slate-400"}`,children:[u.status==="active"&&e.jsx(ve,{className:"w-4 h-4 animate-pulse flex-shrink-0"}),u.status==="expired"&&e.jsx(fe,{className:"w-4 h-4 flex-shrink-0"}),u.status==="no-key"&&e.jsx(le,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:u.label})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] text-slate-400 font-medium",children:"–í–∞—à–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É:"}),e.jsx("div",{className:"bg-black/40 border border-slate-800 p-3 sm:p-4 md:p-5 rounded-2xl sm:rounded-3xl break-all font-mono text-[clamp(0.65rem,0.6rem+0.25vw,0.75rem)] sm:text-xs text-blue-400 leading-relaxed ring-1 ring-blue-500/10 word-break break-words whitespace-pre-wrap",children:g})]}),e.jsxs("button",{onClick:()=>l(g),className:"w-full min-h-[44px] bg-blue-600 hover:bg-blue-500 active:bg-blue-700 py-3 sm:py-4 md:py-5 rounded-2xl sm:rounded-3xl font-bold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] flex items-center justify-center gap-2 sm:gap-3 transition-all text-white shadow-xl shadow-blue-600/20 active:scale-95 touch-manipulation","aria-label":"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É",children:[e.jsx(Ne,{size:18,className:"sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{children:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É"})]}),e.jsxs("div",{className:"pt-3 sm:pt-4 border-t border-slate-800 space-y-2",children:[e.jsxs("p",{className:"text-slate-400 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:[e.jsx("strong",{className:"text-slate-300",children:"–ü–ª–∞–Ω:"})," ",s.plan==="premium"?"–ü—Ä–µ–º–∏—É–º":"–ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π"]}),(a?.expiryTime||s.expiresAt)&&e.jsxs("p",{className:"text-slate-400 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:[e.jsx("strong",{className:"text-slate-300",children:"–ò—Å—Ç–µ–∫–∞–µ—Ç:"})," ",a?.expiryTime&&a.expiryTime>0?o(a.expiryTime):s.expiresAt?o(s.expiresAt):"–ù–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω",a?.expiryTime&&e.jsx("span",{className:"text-slate-500 text-[clamp(0.7rem,0.65rem+0.25vw,0.75rem)] sm:text-xs ml-1",children:"(–∏–∑ 3x-ui)"})]})]})]})]})})},Ze=({tariff:s,onClose:t,onConfirm:a,isLoading:r=!1,natrockPorts:l=[],settings:o=null})=>{const[d,x]=$.useState(1),[g,u]=$.useState(""),[m,b]=$.useState(1),[c,S]=$.useState(!1),[f,D]=$.useState(null),k=s?.name?.toLowerCase()==="super"||s?.plan?.toLowerCase()==="super",U=s?.name?.toLowerCase()==="multi"||s?.plan?.toLowerCase()==="multi";$.useEffect(()=>{U&&o?.natrockPorts&&o.natrockPorts.length>0&&u(o.natrockPorts[0])},[U,o]);const W=150,I=d*W*m,P=m===12?.1:0,F=P>0?I*P:0,y=I-F,H=()=>{if(console.log("üîò TariffSelectionModal.handleConfirm –≤—ã–∑–≤–∞–Ω",{confirmed:c,paymentMode:f,isMulti:U,selectedPort:g,isSuper:k,selectedDevices:d}),U&&!g){console.warn("‚ö†Ô∏è TariffSelectionModal: –ü–æ—Ä—Ç –Ω–µ –≤—ã–±—Ä–∞–Ω –¥–ª—è Multi —Ç–∞—Ä–∏—Ñ–∞"),alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Ç—Ä–µ–∫-–ø–æ—Ä—Ç –¥–ª—è —Ç–∞—Ä–∏—Ñ–∞ Multi");return}if(!c){console.log("üìù TariffSelectionModal: –ü–µ—Ä–≤–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±–æ—Ä –æ–ø–ª–∞—Ç—ã"),S(!0);return}if(c&&!f){console.warn("‚ö†Ô∏è TariffSelectionModal: –†–µ–∂–∏–º –æ–ø–ª–∞—Ç—ã –Ω–µ –≤—ã–±—Ä–∞–Ω, –Ω–æ confirmed=true");return}const h={tariff:s,devices:k?d:s?.devices||1,natrockPort:U?g:null,totalPrice:k?y:s?.price||0,periodMonths:k?m:1,discount:P,discountAmount:F,paymentMode:f,testPeriod:f==="pay_later"};if(console.log("‚úÖ TariffSelectionModal.handleConfirm: –í—ã–∑–æ–≤ onConfirm —Å –¥–∞–Ω–Ω—ã–º–∏:",{tariffName:s?.name,tariffId:s?.id,devices:h.devices,periodMonths:h.periodMonths,paymentMode:h.paymentMode,testPeriod:h.testPeriod,totalPrice:h.totalPrice,hasOnConfirm:typeof a=="function"}),!a||typeof a!="function"){console.error("‚ùå TariffSelectionModal: onConfirm –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π!",typeof a,a),alert("–û—à–∏–±–∫–∞: –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω");return}try{a(h)}catch(C){console.error("‚ùå TariffSelectionModal: –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ onConfirm:",C),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤—ã–±–æ—Ä–∞: "+C.message)}},X=()=>{if(console.log("‚è∞ TariffSelectionModal: –í—ã–±—Ä–∞–Ω–∞ –æ–ø–ª–∞—Ç–∞ –ø–æ–∑–∂–µ (—Ç–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥)"),U&&!g){console.error("‚ùå TariffSelectionModal: –ü–æ—Ä—Ç –Ω–µ –≤—ã–±—Ä–∞–Ω –¥–ª—è Multi —Ç–∞—Ä–∏—Ñ–∞"),alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Ç—Ä–µ–∫-–ø–æ—Ä—Ç –¥–ª—è —Ç–∞—Ä–∏—Ñ–∞ Multi");return}const h={tariff:s,devices:k?d:s?.devices||1,natrockPort:U?g:null,totalPrice:k?y:s?.price||0,periodMonths:k?m:1,discount:P,discountAmount:F,paymentMode:"pay_later",testPeriod:!0};if(console.log("‚úÖ TariffSelectionModal: –í—ã–∑–æ–≤ onConfirm (pay_later) —Å –¥–∞–Ω–Ω—ã–º–∏:",{tariffName:h.tariff?.name,devices:h.devices,periodMonths:h.periodMonths,paymentMode:h.paymentMode,testPeriod:h.testPeriod,totalPrice:h.totalPrice}),D("pay_later"),S(!0),D("pay_later"),S(!0),console.log("üîÑ TariffSelectionModal.handlePayLater: –ü—Ä–æ–≤–µ—Ä–∫–∞ onConfirm –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º"),!a){console.error("‚ùå TariffSelectionModal.handlePayLater: onConfirm –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω!",a),alert("–û—à–∏–±–∫–∞: –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.");return}if(typeof a!="function"){console.error("‚ùå TariffSelectionModal.handlePayLater: onConfirm –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π!",typeof a,a),alert("–û—à–∏–±–∫–∞: –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–º–µ–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.");return}try{console.log("üöÄ TariffSelectionModal.handlePayLater: –í—ã–∑–æ–≤ onConfirm —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–¥–ø–∏—Å–∫–∏"),console.log("üìã –î–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ (pay_later):",JSON.stringify(h,null,2));const C=a(h);C&&typeof C.then=="function"?C.then(()=>{console.log("‚úÖ TariffSelectionModal.handlePayLater: onConfirm (Promise) –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ")}).catch(K=>{console.error("‚ùå TariffSelectionModal.handlePayLater: –û—à–∏–±–∫–∞ –≤ Promise onConfirm:",K),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ: "+(K.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"))}):console.log("‚úÖ TariffSelectionModal.handlePayLater: onConfirm –≤—ã–∑–≤–∞–Ω (–Ω–µ Promise)")}catch(C){console.error("‚ùå TariffSelectionModal.handlePayLater: –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ onConfirm:",C),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤—ã–±–æ—Ä–∞: "+(C.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"))}},J=()=>{if(console.log("üí∞ TariffSelectionModal.handlePayNow: –í—ã–±—Ä–∞–Ω–∞ –æ–ø–ª–∞—Ç–∞ —Å–µ–π—á–∞—Å"),U&&!g){console.error("‚ùå TariffSelectionModal.handlePayNow: –ü–æ—Ä—Ç –Ω–µ –≤—ã–±—Ä–∞–Ω –¥–ª—è Multi —Ç–∞—Ä–∏—Ñ–∞"),alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Ç—Ä–µ–∫-–ø–æ—Ä—Ç –¥–ª—è —Ç–∞—Ä–∏—Ñ–∞ Multi");return}const h={tariff:s,devices:k?d:s?.devices||1,natrockPort:U?g:null,totalPrice:k?y:s?.price||0,periodMonths:k?m:1,discount:P,discountAmount:F,paymentMode:"pay_now",testPeriod:!1};if(console.log("‚úÖ TariffSelectionModal.handlePayNow: –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–æ:",{tariffName:h.tariff?.name,tariffId:h.tariff?.id,devices:h.devices,periodMonths:h.periodMonths,paymentMode:h.paymentMode,testPeriod:h.testPeriod,totalPrice:h.totalPrice,hasOnConfirm:typeof a=="function"}),D("pay_now"),S(!0),console.log("üîÑ TariffSelectionModal.handlePayNow: –ü—Ä–æ–≤–µ—Ä–∫–∞ onConfirm –ø–µ—Ä–µ–¥ –≤—ã–∑–æ–≤–æ–º"),!a){console.error("‚ùå TariffSelectionModal.handlePayNow: onConfirm –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω!",a),alert("–û—à–∏–±–∫–∞: –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.");return}if(typeof a!="function"){console.error("‚ùå TariffSelectionModal.handlePayNow: onConfirm –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π!",typeof a,a),alert("–û—à–∏–±–∫–∞: –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏–º–µ–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.");return}try{console.log("üöÄ TariffSelectionModal.handlePayNow: –í—ã–∑–æ–≤ onConfirm —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–¥–ø–∏—Å–∫–∏"),console.log("üìã –î–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ (pay_now):",JSON.stringify(h,null,2));const C=a(h);C&&typeof C.then=="function"?C.then(()=>{console.log("‚úÖ TariffSelectionModal.handlePayNow: onConfirm (Promise) –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ")}).catch(K=>{console.error("‚ùå TariffSelectionModal.handlePayNow: –û—à–∏–±–∫–∞ –≤ Promise onConfirm:",K),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ: "+(K.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"))}):console.log("‚úÖ TariffSelectionModal.handlePayNow: onConfirm –≤—ã–∑–≤–∞–Ω (–Ω–µ Promise)")}catch(C){console.error("‚ùå TariffSelectionModal.handlePayNow: –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ onConfirm:",C),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –≤—ã–±–æ—Ä–∞: "+(C.message||"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞"))}},se=()=>{S(!1),t()};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4 bg-black/60 backdrop-blur-md",onClick:t,children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 w-full max-w-[90vw] sm:max-w-md rounded-xl sm:rounded-2xl overflow-hidden shadow-2xl max-h-[90vh] overflow-y-auto",onClick:h=>h.stopPropagation(),children:[e.jsxs("div",{className:"p-3 sm:p-4 md:p-6 border-b border-slate-800 flex justify-between items-center gap-3",children:[e.jsxs("h3",{className:"text-[clamp(1rem,0.95rem+0.25vw,1.25rem)] sm:text-xl font-bold text-white flex-1 min-w-0",children:["–í—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞ ",s?.name]}),e.jsx("button",{onClick:se,disabled:r,className:"p-2 hover:bg-slate-800 rounded-lg transition-colors disabled:opacity-50 flex-shrink-0 min-h-[44px] min-w-[44px] flex items-center justify-center touch-manipulation","aria-label":"–ó–∞–∫—Ä—ã—Ç—å",children:e.jsx(je,{size:20,className:"sm:w-6 sm:h-6 text-slate-400"})})]}),e.jsxs("div",{className:"p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-5 md:space-y-6",children:[k&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-300 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] font-medium mb-1.5 sm:mb-2",children:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤"}),e.jsx("input",{type:"number",min:"1",max:"10",value:d,onChange:h=>{const C=Math.max(1,Math.min(10,parseInt(h.target.value)||1));x(C),S(!1),D(null)},className:"w-full min-h-[44px] px-3 sm:px-4 py-2.5 sm:py-3 bg-slate-800 border border-slate-700 rounded-lg text-white text-[clamp(1rem,0.95rem+0.25vw,1.125rem)] sm:text-lg font-semibold focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all touch-manipulation",disabled:r||c})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-300 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] font-medium mb-1.5 sm:mb-2",children:"–ü–µ—Ä–∏–æ–¥ –æ–ø–ª–∞—Ç—ã"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:[{months:1,label:"1 –º–µ—Å—è—Ü"},{months:3,label:"3 –º–µ—Å—è—Ü–∞"},{months:6,label:"6 –º–µ—Å—è—Ü–µ–≤"},{months:12,label:"–ì–æ–¥",badge:"‚àí10%"}].map(h=>e.jsxs("button",{type:"button",onClick:()=>{b(h.months),S(!1),D(null)},disabled:r||c,className:`min-h-[44px] px-2 sm:px-3 py-2.5 sm:py-3 rounded-lg border-2 transition-all font-semibold text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm ${m===h.months?"border-blue-500 bg-blue-500/20 text-blue-400":"border-slate-700 bg-slate-800 text-slate-300 hover:border-slate-600"} disabled:opacity-50 disabled:cursor-not-allowed relative touch-manipulation`,children:[h.label,h.badge&&e.jsx("span",{className:"absolute -top-1.5 sm:-top-2 -right-1.5 sm:-right-2 bg-green-500 text-white text-[clamp(0.65rem,0.6rem+0.25vw,0.75rem)] sm:text-xs px-1 sm:px-1.5 py-0.5 rounded-full font-bold",children:h.badge})]},h.months))})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg sm:rounded-xl p-3 sm:p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:"–¶–µ–Ω–∞ –∑–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ (–º–µ—Å.):"}),e.jsxs("span",{className:"text-slate-300 font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:[W," ‚ÇΩ"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:"–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤:"}),e.jsx("span",{className:"text-slate-300 font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:d})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:"–ü–µ—Ä–∏–æ–¥:"}),e.jsx("span",{className:"text-slate-300 font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:m===1?"1 –º–µ—Å—è—Ü":m===3?"3 –º–µ—Å—è—Ü–∞":m===6?"6 –º–µ—Å—è—Ü–µ–≤":"–ì–æ–¥"})]}),e.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-1",children:[e.jsxs("span",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm break-words",children:["–°—Ç–æ–∏–º–æ—Å—Ç—å (",m," ",m===1?"–º–µ—Å—è—Ü":m<5?"–º–µ—Å—è—Ü–∞":"–º–µ—Å—è—Ü–µ–≤","):"]}),e.jsxs("span",{className:"text-slate-300 font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:[I.toFixed(2)," ‚ÇΩ"]})]}),P>0&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex justify-between items-center text-green-400",children:[e.jsxs("span",{className:"font-medium text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:["–°–∫–∏–¥–∫–∞ (",Math.round(P*100),"%):"]}),e.jsxs("span",{className:"font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:["‚àí",F.toFixed(2)," ‚ÇΩ"]})]})}),e.jsxs("div",{className:"border-t border-slate-700 mt-2 sm:mt-3 pt-2 sm:pt-3 flex justify-between items-center",children:[e.jsx("span",{className:"text-white font-bold text-[clamp(1rem,0.95rem+0.25vw,1.125rem)] sm:text-lg",children:"–ò—Ç–æ–≥–æ:"}),e.jsxs("span",{className:"text-blue-400 font-bold text-[clamp(1.5rem,1.3rem+1vw,2.25rem)] sm:text-2xl",children:[y.toFixed(2)," ‚ÇΩ"]})]})]}),!c&&e.jsx("p",{className:"text-slate-400 text-sm text-center",children:'–ù–∞–∂–º–∏—Ç–µ "–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å" –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è'})]}),U&&e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-slate-300 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] font-medium mb-1.5 sm:mb-2",children:"–í—ã–±–µ—Ä–∏—Ç–µ –Ω–∞—Ç—Ä–µ–∫-–ø–æ—Ä—Ç"}),l&&l.length>0?e.jsx("select",{value:g,onChange:h=>u(h.target.value),className:"w-full min-h-[44px] px-3 sm:px-4 py-2.5 sm:py-3 bg-slate-800 border border-slate-700 rounded-lg text-white text-base focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all touch-manipulation",disabled:r||c,children:l.map(h=>e.jsxs("option",{value:h,children:["–ü–æ—Ä—Ç ",h]},h))}):e.jsx("div",{className:"p-3 sm:p-4 bg-yellow-900/20 border border-yellow-800 rounded-lg",children:e.jsxs("div",{className:"flex items-start sm:items-center gap-2 text-yellow-400",children:[e.jsx(le,{size:18,className:"sm:w-5 sm:h-5 flex-shrink-0 mt-0.5 sm:mt-0"}),e.jsx("span",{className:"text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:"–°–ø–∏—Å–æ–∫ –Ω–∞—Ç—Ä–µ–∫-–ø–æ—Ä—Ç–æ–≤ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏"})]})})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:"–¢–∞—Ä–∏—Ñ:"}),e.jsx("span",{className:"text-white font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:s?.name})]}),e.jsxs("div",{className:"border-t border-slate-700 mt-2 sm:mt-3 pt-2 sm:pt-3 flex justify-between items-center",children:[e.jsx("span",{className:"text-white font-bold text-[clamp(1rem,0.95rem+0.25vw,1.125rem)] sm:text-lg",children:"–¶–µ–Ω–∞:"}),e.jsxs("span",{className:"text-blue-400 font-bold text-[clamp(1.5rem,1.3rem+1vw,2.25rem)] sm:text-2xl",children:[s?.price||0," ‚ÇΩ"]})]})]})]}),c&&!f&&e.jsxs("div",{className:"bg-blue-900/20 border border-blue-800 rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-400 mb-2",children:[e.jsx(me,{size:18,className:"sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] sm:text-base",children:"–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞"})]}),e.jsxs("p",{className:"text-slate-300 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm mb-3 sm:mb-4 break-words",children:['–í—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ –≤—ã–±–æ—Ä —Ç–∞—Ä–∏—Ñ–∞ "',s?.name,'"',k&&e.jsxs(e.Fragment,{children:[" ","–Ω–∞ ",d," ",d===1?"—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ":"—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"," ","–Ω–∞ ",m===1?"1 –º–µ—Å—è—Ü":m===3?"3 –º–µ—Å—è—Ü–∞":m===6?"6 –º–µ—Å—è—Ü–µ–≤":"–≥–æ–¥"," ","–∑–∞ ",y.toFixed(2)," ‚ÇΩ",P>0&&e.jsxs("span",{className:"text-green-400 ml-1",children:["(—Å–æ —Å–∫–∏–¥–∫–æ–π ",Math.round(P*100),"%)"]})]}),"?"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-slate-400 text-[clamp(0.7rem,0.65rem+0.25vw,0.75rem)] sm:text-xs font-medium mb-2",children:"–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã:"}),e.jsxs("button",{onClick:J,disabled:r,className:"btn-icon-only-mobile w-full min-h-[44px] px-4 py-3 bg-green-600 hover:bg-green-700 active:bg-green-800 text-white rounded-lg font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 touch-manipulation","aria-label":"–û–ø–ª–∞—Ç–∏—Ç—å —Å–µ–π—á–∞—Å",children:[e.jsx(me,{size:18,className:"sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"btn-text",children:"–û–ø–ª–∞—Ç–∏—Ç—å —Å–µ–π—á–∞—Å"})]}),e.jsxs("button",{onClick:X,disabled:r,className:"btn-icon-only-mobile w-full min-h-[44px] px-4 py-3 bg-slate-700 hover:bg-slate-600 active:bg-slate-500 text-white rounded-lg font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 touch-manipulation","aria-label":"–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–∑–∂–µ, —Ç–µ—Å—Ç 24 —á–∞—Å–∞",children:[e.jsx(ce,{size:18,className:"sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"btn-text",children:"–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–∑–∂–µ (—Ç–µ—Å—Ç 24 —á–∞—Å–∞)"})]}),e.jsx("p",{className:"text-slate-500 text-[clamp(0.7rem,0.65rem+0.25vw,0.75rem)] sm:text-xs text-center mt-2 break-words",children:'–ü—Ä–∏ –≤—ã–±–æ—Ä–µ "–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–∑–∂–µ" –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –¥–æ—Å—Ç—É–ø –Ω–∞ 24 —á–∞—Å–∞ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è'})]})]}),c&&f==="pay_later"&&e.jsxs("div",{className:"bg-yellow-900/20 border border-yellow-800 rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 mb-2",children:[e.jsx(ce,{size:18,className:"sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] sm:text-base",children:"–¢–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥ –±—É–¥–µ—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω"})]}),e.jsx("p",{className:"text-slate-300 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm break-words",children:"–ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤–∞–º –±—É–¥–µ—Ç –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω —Ç–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥ –Ω–∞ 24 —á–∞—Å–∞. –í —Ç–µ—á–µ–Ω–∏–µ —ç—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ VPN –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω–æ. –ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –±—É–¥–µ—Ç –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ –æ–ø–ª–∞—Ç—ã."})]}),!c&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 pt-3 sm:pt-4",children:[e.jsx("button",{onClick:se,disabled:r,className:"btn-icon-only-mobile min-h-[44px] flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 active:bg-slate-500 text-white rounded-lg font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center touch-manipulation","aria-label":"–û—Ç–º–µ–Ω–∞",children:e.jsx("span",{className:"btn-text",children:"–û—Ç–º–µ–Ω–∞"})}),e.jsx("button",{onClick:H,disabled:r||U&&!g||k&&d<1,className:"btn-icon-only-mobile min-h-[44px] flex-1 px-4 py-3 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white rounded-lg font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 touch-manipulation","aria-label":"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å",children:r?e.jsxs(e.Fragment,{children:[e.jsx(Re,{size:18,className:"sm:w-5 sm:h-5 animate-spin flex-shrink-0"}),e.jsx("span",{className:"btn-text",children:"–û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ..."})]}):e.jsx("span",{className:"btn-text",children:"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"})})]}),c&&f&&e.jsx("div",{className:"flex gap-3 pt-3 sm:pt-4",children:e.jsx("button",{onClick:()=>{S(!1),D(null)},disabled:r,className:"min-h-[44px] flex-1 px-4 py-3 bg-slate-700 hover:bg-slate-600 active:bg-slate-500 text-white rounded-lg font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all disabled:opacity-50 disabled:cursor-not-allowed touch-manipulation","aria-label":"–ù–∞–∑–∞–¥",children:"–ù–∞–∑–∞–¥"})})]})]})})},Qe=({vpnLink:s,onClose:t,onCopy:a,tariffName:r="",devices:l=1,periodMonths:o=1,expiresAt:d=null,paymentStatus:x="paid",testPeriod:g=!1})=>{const[u,m]=$.useState(!1),b=()=>{a&&s&&(a(s),m(!0),setTimeout(()=>m(!1),2e3))},c={windows:"https://github.com/MatsuriDayo/nekoray/releases",android:"https://play.google.com/store/apps/details?id=com.v2ray.ang",ios:"https://apps.apple.com/app/v2rayng/id1534545688",macos:"https://github.com/MatsuriDayo/nekoray/releases"};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4 bg-black/60 backdrop-blur-md",onClick:t,children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 w-full max-w-[90vw] sm:max-w-2xl rounded-xl sm:rounded-2xl overflow-hidden shadow-2xl max-h-[90vh] overflow-y-auto",onClick:S=>S.stopPropagation(),children:[e.jsxs("div",{className:"p-3 sm:p-4 md:p-6 border-b border-slate-800 flex justify-between items-start sm:items-center gap-3",children:[e.jsxs("div",{className:"flex items-start sm:items-center gap-2 sm:gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"p-1.5 sm:p-2 bg-green-500/20 rounded-lg flex-shrink-0",children:e.jsx(me,{className:"w-5 h-5 sm:w-6 sm:h-6 text-green-400"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-[clamp(1rem,0.95rem+0.25vw,1.25rem)] sm:text-xl font-bold text-white",children:"–ü–æ–¥–ø–∏—Å–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞!"}),e.jsxs("p",{className:"text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm text-slate-400 mt-0.5 sm:mt-1",children:["–¢–∞—Ä–∏—Ñ: ",e.jsx("span",{className:"text-white font-semibold",children:r}),l>1&&` ‚Ä¢ ${l} —É—Å—Ç—Ä–æ–π—Å—Ç–≤`,o>0&&` ‚Ä¢ ${o} ${o===1?"–º–µ—Å—è—Ü":o<5?"–º–µ—Å—è—Ü–∞":"–º–µ—Å—è—Ü–µ–≤"}`]})]})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-slate-800 rounded-lg transition-colors flex-shrink-0 min-h-[44px] min-w-[44px] flex items-center justify-center touch-manipulation","aria-label":"–ó–∞–∫—Ä—ã—Ç—å",children:e.jsx(je,{size:20,className:"text-slate-400 sm:w-6 sm:h-6"})})]}),e.jsxs("div",{className:"p-3 sm:p-4 md:p-6 space-y-4 sm:space-y-5 md:space-y-6",children:[e.jsxs("div",{className:"bg-blue-900/20 border border-blue-800 rounded-lg sm:rounded-xl p-3 sm:p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-400 mb-2",children:[e.jsx(ye,{size:18,className:"sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] sm:text-base",children:"–í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:gap-3 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-0.5 sm:mb-1",children:"–¢–∞—Ä–∏—Ñ"}),e.jsx("p",{className:"text-white font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] break-words",children:r||"–ù–µ —É–∫–∞–∑–∞–Ω"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-0.5 sm:mb-1",children:"–£—Å—Ç—Ä–æ–π—Å—Ç–≤"}),e.jsx("p",{className:"text-white font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:l})]}),o>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-0.5 sm:mb-1",children:"–ü–µ—Ä–∏–æ–¥"}),e.jsxs("p",{className:"text-white font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:[o," ",o===1?"–º–µ—Å—è—Ü":o<5?"–º–µ—Å—è—Ü–∞":"–º–µ—Å—è—Ü–µ–≤"]})]}),d&&e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 mb-0.5 sm:mb-1",children:"–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ"}),e.jsx("p",{className:"text-white font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] break-words",children:new Date(d).toLocaleDateString("ru-RU",{year:"numeric",month:"long",day:"numeric"})})]})]}),g&&e.jsxs("div",{className:"mt-2 sm:mt-3 pt-2 sm:pt-3 border-t border-blue-800",children:[e.jsxs("div",{className:"flex items-center gap-2 text-yellow-400",children:[e.jsx(ce,{size:14,className:"sm:w-4 sm:h-4 flex-shrink-0"}),e.jsx("span",{className:"text-[clamp(0.7rem,0.65rem+0.25vw,0.75rem)] sm:text-xs font-semibold",children:"–¢–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥: 24 —á–∞—Å–∞"})]}),d&&e.jsxs("p",{className:"text-slate-400 text-[clamp(0.7rem,0.65rem+0.25vw,0.75rem)] sm:text-xs mt-1",children:["–û–∫–æ–Ω—á–∞–Ω–∏–µ: ",new Date(d).toLocaleString("ru-RU")]}),e.jsx("p",{className:"text-slate-400 text-[clamp(0.7rem,0.65rem+0.25vw,0.75rem)] sm:text-xs mt-1",children:"–ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –±—É–¥–µ—Ç –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ –æ–ø–ª–∞—Ç—ã"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-slate-300 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] font-medium",children:"–í–∞—à–∞ —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É (—Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É):"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsx("div",{className:"flex-1 min-w-0 bg-slate-950 border border-slate-800 p-3 sm:p-4 rounded-lg sm:rounded-xl overflow-x-auto",children:e.jsx("code",{className:"text-blue-400 text-[clamp(0.65rem,0.6rem+0.25vw,0.75rem)] sm:text-xs font-mono break-all select-all whitespace-pre-wrap word-break break-words",children:s||"–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Å—ã–ª–∫–∏ –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É..."})}),e.jsx("button",{onClick:b,className:"btn-icon-only-mobile min-h-[44px] w-full sm:w-auto sm:min-w-[120px] px-3 sm:px-4 py-2.5 sm:py-3 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all flex items-center justify-center gap-2 touch-manipulation",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É","aria-label":"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É",children:u?e.jsxs(e.Fragment,{children:[e.jsx(me,{size:18,className:"sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"btn-text whitespace-nowrap",children:"–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ"})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{size:18,className:"sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"btn-text whitespace-nowrap",children:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å"})]})})]})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[e.jsxs("h4",{className:"text-slate-300 font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] sm:text-base flex items-center gap-2",children:[e.jsx(Fe,{size:18,className:"sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{children:"–°–∫–∞—á–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è VPN"})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3",children:[e.jsxs("a",{href:c.windows,target:"_blank",rel:"noopener noreferrer",className:"btn-icon-only-mobile flex flex-col items-center justify-center gap-1 sm:gap-2 p-3 sm:p-4 bg-slate-800 hover:bg-slate-700 active:bg-slate-600 rounded-lg sm:rounded-xl transition-all group min-h-[44px] touch-manipulation","aria-label":"–°–∫–∞—á–∞—Ç—å –¥–ª—è Windows",title:"–°–∫–∞—á–∞—Ç—å –¥–ª—è Windows",children:[e.jsx(Ce,{className:"w-6 h-6 sm:w-8 sm:h-8 text-blue-400 group-hover:scale-110 transition-transform flex-shrink-0"}),e.jsx("span",{className:"btn-text text-white font-medium text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:"Windows"}),e.jsx(he,{size:12,className:"sm:w-3.5 sm:h-3.5 text-slate-400 flex-shrink-0"})]}),e.jsxs("a",{href:c.android,target:"_blank",rel:"noopener noreferrer",className:"btn-icon-only-mobile flex flex-col items-center justify-center gap-1 sm:gap-2 p-3 sm:p-4 bg-slate-800 hover:bg-slate-700 active:bg-slate-600 rounded-lg sm:rounded-xl transition-all group min-h-[44px] touch-manipulation","aria-label":"–°–∫–∞—á–∞—Ç—å –¥–ª—è Android",title:"–°–∫–∞—á–∞—Ç—å –¥–ª—è Android",children:[e.jsx(Oe,{className:"w-6 h-6 sm:w-8 sm:h-8 text-green-400 group-hover:scale-110 transition-transform flex-shrink-0"}),e.jsx("span",{className:"btn-text text-white font-medium text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:"Android"}),e.jsx(he,{size:12,className:"sm:w-3.5 sm:h-3.5 text-slate-400 flex-shrink-0"})]}),e.jsxs("a",{href:c.ios,target:"_blank",rel:"noopener noreferrer",className:"btn-icon-only-mobile flex flex-col items-center justify-center gap-1 sm:gap-2 p-3 sm:p-4 bg-slate-800 hover:bg-slate-700 active:bg-slate-600 rounded-lg sm:rounded-xl transition-all group min-h-[44px] touch-manipulation","aria-label":"–°–∫–∞—á–∞—Ç—å –¥–ª—è iOS",title:"–°–∫–∞—á–∞—Ç—å –¥–ª—è iOS",children:[e.jsx(ze,{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-400 group-hover:scale-110 transition-transform flex-shrink-0"}),e.jsx("span",{className:"btn-text text-white font-medium text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:"iOS"}),e.jsx(he,{size:12,className:"sm:w-3.5 sm:h-3.5 text-slate-400 flex-shrink-0"})]}),e.jsxs("a",{href:c.macos,target:"_blank",rel:"noopener noreferrer",className:"btn-icon-only-mobile flex flex-col items-center justify-center gap-1 sm:gap-2 p-3 sm:p-4 bg-slate-800 hover:bg-slate-700 active:bg-slate-600 rounded-lg sm:rounded-xl transition-all group min-h-[44px] touch-manipulation","aria-label":"–°–∫–∞—á–∞—Ç—å –¥–ª—è macOS",title:"–°–∫–∞—á–∞—Ç—å –¥–ª—è macOS",children:[e.jsx(Ce,{className:"w-6 h-6 sm:w-8 sm:h-8 text-gray-300 group-hover:scale-110 transition-transform flex-shrink-0"}),e.jsx("span",{className:"btn-text text-white font-medium text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm",children:"macOS"}),e.jsx(he,{size:12,className:"sm:w-3.5 sm:h-3.5 text-slate-400 flex-shrink-0"})]})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg sm:rounded-xl p-3 sm:p-4",children:[e.jsx("p",{className:"text-slate-300 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] mb-2 sm:mb-3",children:e.jsx("strong",{className:"text-white",children:"–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:"})}),e.jsxs("ol",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] sm:text-sm space-y-1.5 sm:space-y-2 list-decimal list-inside",children:[e.jsx("li",{children:"–°–∫–∞—á–∞–π—Ç–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –≤–∞—à–µ–π –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"}),e.jsx("li",{children:'–û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –Ω–∞–∂–º–∏—Ç–µ "–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É" –∏–ª–∏ "Subscribe"'}),e.jsx("li",{children:"–í—Å—Ç–∞–≤—å—Ç–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ –ø–æ–¥–ø–∏—Å–∫—É"}),e.jsx("li",{children:"–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ø–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ VPN —Å–µ—Ä–≤–µ—Ä—É"})]})]}),e.jsx("button",{onClick:t,className:"w-full min-h-[44px] px-4 sm:px-5 py-2.5 sm:py-3 bg-green-600 hover:bg-green-700 active:bg-green-800 text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all touch-manipulation","aria-label":"–ì–æ—Ç–æ–≤–æ, –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ",children:"–ì–æ—Ç–æ–≤–æ, –Ω–∞—á–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ"})]})]})})},as=({currentUser:s,view:t,onSetView:a,onLogout:r,tariffs:l,loadTariffs:o,dashboardTab:d,onSetDashboardTab:x,editingProfile:g,onSetEditingProfile:u,profileData:m,onSetProfileData:b,creatingSubscription:c,onHandleCreateSubscription:S,onHandleRenewSubscription:f,onHandleDeleteSubscription:D,onHandleUpdateProfile:k,onHandleDeleteAccount:U,onProfileNameChange:W,onProfilePhoneChange:j,payments:I,paymentsLoading:P,loadPayments:F,formatDate:y,formatTraffic:H,settings:X,onCopy:J,showKeyModal:se,onSetShowKeyModal:h,showLogger:C,onSetShowLogger:K,onGetKey:q})=>{const[E,ne]=$.useState(null),[be,ie]=$.useState(!1),[G,te]=$.useState(null),[we,xe]=$.useState(!1),[oe,z]=$.useState(!1),[p,L]=$.useState(!1),Y=s?.uuid&&s?.tariffId&&(s?.expiresAt&&new Date(s.expiresAt).getTime()>Date.now()||s?.paymentStatus==="test_period"&&s?.testPeriodEndDate&&new Date(s.testPeriodEndDate).getTime()>Date.now()||s?.paymentStatus==="unpaid"&&(s.unpaidStartDate?(Date.now()-new Date(s.unpaidStartDate).getTime())/(1440*60*1e3)<5:!0)),_=_e(s),B=l.find(n=>n.id===s?.tariffId);$.useEffect(()=>{(async()=>{if(!(!s||!s.id))try{const{dashboardService:w}=await Me(async()=>{const{dashboardService:R}=await Promise.resolve().then(()=>Ue);return{dashboardService:R}},void 0);if(s?.paymentStatus==="test_period"){const R=await w.checkAndUpdateTestPeriod(s);if(R&&R.paymentStatus==="unpaid"){window.location.reload();return}}if(s?.paymentStatus==="unpaid"&&await w.checkAndDeleteUnpaidSubscription(s)===null){window.location.reload();return}}catch(w){console.warn("–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Å n8n:",w)}})()},[s?.id]),$.useEffect(()=>{l.length===0&&o()},[l.length,o]),$.useEffect(()=>{if(!s)return;const n=async()=>{try{const{dashboardService:R}=await Me(async()=>{const{dashboardService:ee}=await Promise.resolve().then(()=>Ue);return{dashboardService:ee}},void 0);if(s.paymentStatus==="test_period"){const ee=Date.now();if(s.testPeriodEndDate&&s.testPeriodEndDate<ee){const Q=await R.checkAndUpdateTestPeriod(s);if(Q&&Q.paymentStatus==="unpaid"){window.location.reload();return}}}if(s.paymentStatus==="unpaid"&&await R.checkAndDeleteUnpaidSubscription(s)===null){window.location.reload();return}}catch(R){console.error("–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–¥–ø–∏—Å–∫–∏:",R)}};n();const w=setInterval(n,60*1e3);return()=>clearInterval(w)},[s?.paymentStatus,s?.testPeriodEndDate,s?.unpaidStartDate,s?.id]);const T=n=>{ne(n),ie(!0)},N=async n=>{if(console.log("üéØ Dashboard.handleTariffConfirm: –§–£–ù–ö–¶–ò–Ø –í–´–ó–í–ê–ù–ê",{timestamp:new Date().toISOString(),tariffName:n?.tariff?.name,tariffId:n?.tariff?.id,devices:n?.devices,periodMonths:n?.periodMonths,paymentMode:n?.paymentMode,testPeriod:n?.testPeriod,hasSubscriptionData:!!n,hasTariff:!!n?.tariff}),!n){console.error("‚ùå Dashboard.handleTariffConfirm: subscriptionData –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω!"),alert("–û—à–∏–±–∫–∞: –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–µ –ø–æ–ª—É—á–µ–Ω—ã");return}if(!n.tariff){console.error("‚ùå Dashboard.handleTariffConfirm: subscriptionData.tariff –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç!",n),alert("–û—à–∏–±–∫–∞: —Ç–∞—Ä–∏—Ñ –Ω–µ –≤—ã–±—Ä–∞–Ω");return}if(!S){console.error("‚ùå Dashboard.handleTariffConfirm: onHandleCreateSubscription –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω —á–µ—Ä–µ–∑ props!"),alert("–û—à–∏–±–∫–∞: —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.");return}if(typeof S!="function"){console.error("‚ùå Dashboard.handleTariffConfirm: onHandleCreateSubscription –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–µ–π!",typeof S),alert("–û—à–∏–±–∫–∞: —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –∏–º–µ–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–∏–ø. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.");return}try{console.log("üîÑ Dashboard.handleTariffConfirm: –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ç–∞—Ä–∏—Ñ–∞"),ie(!1),console.log("üì§ Dashboard.handleTariffConfirm: –í—ã–∑–æ–≤ onHandleCreateSubscription —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:",{tariff:{id:n.tariff.id,name:n.tariff.name},devices:n.devices,natrockPort:n.natrockPort,periodMonths:n.periodMonths||1,testPeriod:n.testPeriod||!1,paymentMode:n.paymentMode||"pay_now",discount:n.discount||0});const w=await S(n.tariff,n.devices,n.natrockPort,n.periodMonths||1,n.testPeriod||!1,n.paymentMode||"pay_now",n.discount||0);console.log("‚úÖ Dashboard.handleTariffConfirm: onHandleCreateSubscription –≤–µ—Ä–Ω—É–ª —Ä–µ–∑—É–ª—å—Ç–∞—Ç:",{hasResult:!!w,result:w}),w?(console.log("üéâ Dashboard.handleTariffConfirm: –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —É—Å–ø–µ—Ö–∞ —Å –¥–∞–Ω–Ω—ã–º–∏:",{hasVpnLink:!!w.vpnLink,tariffName:w.tariffName,devices:w.devices,periodMonths:w.periodMonths}),te({vpnLink:w.vpnLink||null,tariffName:w.tariffName||n.tariff.name,devices:w.devices||n.devices||1,periodMonths:w.periodMonths||n.periodMonths||1,expiresAt:w.expiresAt||null,paymentStatus:w.paymentStatus||(n.testPeriod?"test_period":"paid"),testPeriod:w.testPeriod!==void 0?w.testPeriod:n.testPeriod||!1}),xe(!0)):console.warn("‚ö†Ô∏è Dashboard.handleTariffConfirm: onHandleCreateSubscription –≤–µ—Ä–Ω—É–ª –ø—É—Å—Ç–æ–π/undefined —Ä–µ–∑—É–ª—å—Ç–∞—Ç")}catch(w){console.error("‚ùå Dashboard.handleTariffConfirm: –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏:",{errorMessage:w.message,errorType:w.constructor.name,errorStack:w.stack,errorResponse:w.response?.data,errorStatus:w.response?.status})}},A=async()=>{if(!D){console.error("‚ùå Dashboard: onHandleDeleteSubscription –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω"),z(!1);return}try{L(!0),await D(),z(!1)}catch(n){console.error("‚ùå Dashboard: –û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏:",n)}finally{L(!1)}};return e.jsxs("div",{className:"min-h-screen bg-slate-950 flex flex-col lg:flex-row lg:h-screen lg:overflow-hidden",children:[e.jsx(Ae,{currentUser:s,view:t,onSetView:a,onLogout:r}),e.jsxs("div",{className:"flex-1 w-full min-w-0 p-3 sm:p-4 md:p-6 lg:p-8 pt-14 sm:pt-16 lg:pt-6 lg:pt-8 lg:overflow-y-auto",children:[e.jsxs("div",{className:"mb-4 sm:mb-5 md:mb-6",children:[e.jsx("h1",{className:"text-[clamp(1.25rem,1.1rem+0.75vw,1.875rem)] font-bold text-white mb-1.5 sm:mb-2",children:"–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç"}),e.jsx("p",{className:"text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] text-slate-400",children:"–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–æ–π, –ø—Ä–æ—Ñ–∏–ª–µ–º –∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4 mb-4 sm:mb-5 md:mb-6",children:[e.jsxs("div",{className:"bg-slate-900 rounded-lg sm:rounded-xl p-4 sm:p-5 border border-slate-800",children:[e.jsx("p",{className:"text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] text-slate-400 mb-1.5 sm:mb-2",children:"–°—Ç–∞—Ç—É—Å"}),e.jsxs("div",{className:`inline-flex items-center gap-2 ${_.color} font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]`,children:[_.status==="active"&&e.jsx(ve,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),_.status==="expired"&&e.jsx(fe,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),_.status==="no-key"&&e.jsx(le,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{children:_.label})]})]}),e.jsxs("div",{className:"bg-slate-900 rounded-lg sm:rounded-xl p-4 sm:p-5 border border-slate-800",children:[e.jsx("p",{className:"text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] text-slate-400 mb-1.5 sm:mb-2",children:"–¢–∞—Ä–∏—Ñ"}),e.jsx("p",{className:"text-white font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:s.tariffName||"–ù–µ –≤—ã–±—Ä–∞–Ω"})]}),e.jsxs("div",{className:"bg-slate-900 rounded-lg sm:rounded-xl p-4 sm:p-5 border border-slate-800",children:[e.jsx("p",{className:"text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] text-slate-400 mb-1.5 sm:mb-2",children:"–ö–ª—é—á"}),e.jsx("p",{className:"text-white font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:s.uuid?"–ê–∫—Ç–∏–≤–µ–Ω":"–ù–µ –ø–æ–ª—É—á–µ–Ω"})]})]}),e.jsxs("div",{className:"flex gap-2 sm:gap-4 mb-4 sm:mb-5 md:mb-6 border-b border-slate-800 overflow-x-auto scrollbar-hide -mx-1 sm:mx-0",children:[e.jsxs("button",{onClick:()=>x("subscription"),className:`min-h-[44px] flex items-center justify-center gap-1.5 sm:gap-2 px-3 sm:px-4 md:px-6 py-3 sm:py-3.5 md:py-4 font-semibold transition-all whitespace-nowrap flex-shrink-0 min-w-fit touch-manipulation ${d==="subscription"?"text-blue-400 border-b-2 border-blue-400":"text-slate-400 hover:text-slate-300 active:text-slate-200"}`,"aria-label":"–ü–æ–¥–ø–∏—Å–∫–∞","aria-selected":d==="subscription",children:[e.jsx(de,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] sm:text-base",children:"–ü–æ–¥–ø–∏—Å–∫–∞"})]}),e.jsxs("button",{onClick:()=>x("profile"),className:`min-h-[44px] flex items-center justify-center gap-1.5 sm:gap-2 px-3 sm:px-4 md:px-6 py-3 sm:py-3.5 md:py-4 font-semibold transition-all whitespace-nowrap flex-shrink-0 min-w-fit touch-manipulation ${d==="profile"?"text-blue-400 border-b-2 border-blue-400":"text-slate-400 hover:text-slate-300 active:text-slate-200"}`,"aria-label":"–ü—Ä–æ—Ñ–∏–ª—å","aria-selected":d==="profile",children:[e.jsx(qe,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] sm:text-base",children:"–ü—Ä–æ—Ñ–∏–ª—å"})]}),e.jsxs("button",{onClick:()=>x("payments"),className:`min-h-[44px] flex items-center justify-center gap-1.5 sm:gap-2 px-3 sm:px-4 md:px-6 py-3 sm:py-3.5 md:py-4 font-semibold transition-all whitespace-nowrap flex-shrink-0 min-w-fit touch-manipulation ${d==="payments"?"text-blue-400 border-b-2 border-blue-400":"text-slate-400 hover:text-slate-300 active:text-slate-200"}`,"aria-label":"–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π","aria-selected":d==="payments",children:[e.jsx(We,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] sm:text-base",children:"–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π"})]})]}),d==="subscription"&&e.jsx("div",{className:"bg-slate-900 rounded-lg sm:rounded-xl shadow-xl border border-slate-800 p-4 sm:p-5 md:p-6",children:Y?e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4 sm:mb-5 md:mb-6",children:[e.jsx("h2",{className:"text-[clamp(1.125rem,1rem+0.625vw,1.5rem)] font-bold text-white",children:"–¢–µ–∫—É—â–∞—è –ø–æ–¥–ø–∏—Å–∫–∞"}),s?.uuid&&D&&e.jsxs("button",{onClick:()=>z(!0),disabled:p||c,className:"btn-icon-only-mobile min-h-[44px] w-full sm:w-auto px-4 sm:px-5 py-2.5 sm:py-3 bg-red-600/90 hover:bg-red-700 active:bg-red-800 disabled:bg-slate-700 disabled:opacity-50 disabled:cursor-not-allowed text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all flex items-center justify-center gap-2 touch-manipulation","aria-label":"–û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É",children:[e.jsx(Ee,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"btn-text",children:p?"–û—Ç–º–µ–Ω–∞...":"–û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"})]})]}),e.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[e.jsxs("div",{className:"bg-gradient-to-br from-slate-800 via-slate-800 to-slate-900 rounded-xl sm:rounded-2xl p-5 sm:p-6 md:p-8 border border-slate-700 shadow-lg",children:[e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 mb-6",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-[clamp(1.5rem,1.3rem+1vw,2rem)] font-bold text-white",children:s.tariffName||"–ù–µ —É–∫–∞–∑–∞–Ω"}),s.tariffName?.toLowerCase()==="super"&&e.jsx("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-blue-600 text-white text-xs sm:text-sm font-bold rounded-full",children:"PREMIUM"})]}),e.jsxs("div",{className:`inline-flex items-center gap-2 px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg ${_.color} font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]`,children:[_.status==="active"&&e.jsx(ve,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),_.status==="expired"&&e.jsx(fe,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),_.status==="unpaid"&&e.jsx(fe,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),_.status==="test_period"&&e.jsx(ce,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),_.status==="no-key"&&e.jsx(le,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{children:_.label})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-5 mb-6",children:[e.jsxs("div",{className:"bg-slate-900/50 rounded-xl p-4 sm:p-5 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Oe,{className:"w-5 h-5 text-blue-400 flex-shrink-0"}),e.jsx("p",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] font-medium",children:"–£—Å—Ç—Ä–æ–π—Å—Ç–≤"})]}),e.jsx("p",{className:"text-white font-bold text-[clamp(1.25rem,1.1rem+0.75vw,1.75rem)]",children:s.devices||B?.devices||1})]}),s.periodMonths&&e.jsxs("div",{className:"bg-slate-900/50 rounded-xl p-4 sm:p-5 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{className:"w-5 h-5 text-green-400 flex-shrink-0"}),e.jsx("p",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] font-medium",children:"–ü–µ—Ä–∏–æ–¥"})]}),e.jsxs("p",{className:"text-white font-bold text-[clamp(1.125rem,1rem+0.625vw,1.5rem)]",children:[s.periodMonths," ",s.periodMonths===1?"–º–µ—Å—è—Ü":s.periodMonths<5?"–º–µ—Å—è—Ü–∞":"–º–µ—Å—è—Ü–µ–≤"]})]}),(B||s?.paymentStatus)&&e.jsxs("div",{className:"bg-slate-900/50 rounded-xl p-4 sm:p-5 border border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Be,{className:"w-5 h-5 text-yellow-400 flex-shrink-0"}),e.jsx("p",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] font-medium",children:"–¢—Ä–∞—Ñ–∏–∫"})]}),e.jsx("p",{className:"text-white font-bold text-[clamp(1.125rem,1rem+0.625vw,1.5rem)]",children:s?.paymentStatus==="test_period"?"3 GB":B?B.trafficGB&&B.trafficGB>0?`${B.trafficGB} GB`:"–ë–µ–∑–ª–∏–º–∏—Ç":(s?.tariffId&&console.warn("‚ö†Ô∏è Dashboard: –¢–∞—Ä–∏—Ñ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è tariffId:",s.tariffId,"–î–æ—Å—Ç—É–ø–Ω—ã–µ —Ç–∞—Ä–∏—Ñ—ã:",l.map(n=>({id:n.id,name:n.name}))),"–ë–µ–∑–ª–∏–º–∏—Ç")})]})]}),e.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[s.expiresAt&&e.jsxs("div",{className:"flex items-start sm:items-center gap-3 p-4 bg-slate-900/50 rounded-xl border border-slate-700",children:[e.jsx(ge,{className:"w-5 h-5 text-purple-400 flex-shrink-0 mt-0.5 sm:mt-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] mb-1",children:"–î–µ–π—Å—Ç–≤—É–µ—Ç –¥–æ"}),e.jsx("p",{className:"text-white font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:y(s.expiresAt)}),new Date(s.expiresAt)>new Date&&e.jsxs("p",{className:"text-slate-500 text-xs mt-1",children:["–û—Å—Ç–∞–ª–æ—Å—å: ",Math.ceil((new Date(s.expiresAt)-new Date)/(1e3*60*60*24))," –¥–Ω–µ–π"]})]})]}),e.jsxs("div",{className:"flex items-start sm:items-center gap-3 p-4 bg-slate-900/50 rounded-xl border border-slate-700",children:[e.jsx(de,{className:"w-5 h-5 text-indigo-400 flex-shrink-0 mt-0.5 sm:mt-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-slate-400 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] mb-1",children:"–°—Ç–∞—Ç—É—Å –æ–ø–ª–∞—Ç—ã"}),e.jsx("p",{className:`font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] ${s.paymentStatus==="paid"?"text-green-400":s.paymentStatus==="test_period"?"text-yellow-400":s.paymentStatus==="unpaid"?"text-red-400":"text-slate-300"}`,children:s.paymentStatus==="paid"?"–û–ø–ª–∞—á–µ–Ω–æ":s.paymentStatus==="test_period"?"–¢–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥":s.paymentStatus==="unpaid"?"–ù–µ –æ–ø–ª–∞—á–µ–Ω–æ":"–ù–µ —É–∫–∞–∑–∞–Ω"})]})]}),s?.paymentStatus==="test_period"&&s?.testPeriodEndDate&&e.jsx("div",{className:"p-4 bg-yellow-900/20 border border-yellow-800/50 rounded-xl",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ce,{className:"w-5 h-5 text-yellow-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-yellow-400 font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] mb-1",children:"–¢–µ—Å—Ç–æ–≤—ã–π –ø–µ—Ä–∏–æ–¥ –∞–∫—Ç–∏–≤–µ–Ω"}),e.jsxs("p",{className:"text-yellow-300/90 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)]",children:["–û–∫–æ–Ω—á–∞–Ω–∏–µ: ",y(s.testPeriodEndDate)]}),e.jsx("p",{className:"text-yellow-300/70 text-xs mt-2 mb-3",children:"–ü–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –±—É–¥–µ—Ç –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ –æ–ø–ª–∞—Ç—ã"}),f&&e.jsxs("button",{onClick:f,disabled:c,className:"min-h-[40px] px-4 py-2 bg-green-600 hover:bg-green-700 active:bg-green-800 disabled:bg-slate-700 disabled:cursor-not-allowed text-white rounded-lg font-semibold text-sm transition-all flex items-center justify-center gap-2 touch-manipulation","aria-label":"–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É",children:[e.jsx(de,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:c?"–û–±—Ä–∞–±–æ—Ç–∫–∞...":"–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"})]})]})]})}),s?.paymentStatus==="unpaid"&&(()=>{const n=s.unpaidStartDate||s.testPeriodEndDate,R=5-(n?Math.floor((Date.now()-new Date(n).getTime())/(1440*60*1e3)):0),ee=R<=2&&R>0,Q=R<=0;return e.jsx("div",{className:`p-4 border rounded-xl ${Q||ee?"bg-red-900/30 border-red-800/70":"bg-red-900/20 border-red-800/50"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(le,{className:`w-5 h-5 flex-shrink-0 mt-0.5 ${Q||ee?"text-red-400 animate-pulse":"text-red-400"}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-red-400 font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] mb-1",children:Q?"–ü–æ–¥–ø–∏—Å–∫–∞ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞":"–¢—Ä–µ–±—É–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞"}),e.jsx("p",{className:"text-red-300/90 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] mb-2",children:Q?"–ü—Ä–æ—à–ª–æ –±–æ–ª–µ–µ 5 –¥–Ω–µ–π —Å –º–æ–º–µ–Ω—Ç–∞ –Ω–µ–æ–ø–ª–∞—Ç—ã. –ü–æ–¥–ø–∏—Å–∫–∞ –±—É–¥–µ—Ç —É–¥–∞–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.":`–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –æ–ø–ª–∞—Ç—É. –û—Å—Ç–∞–ª–æ—Å—å ${R} ${R===1?"–¥–µ–Ω—å":R<5?"–¥–Ω—è":"–¥–Ω–µ–π"} –¥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏.`}),!Q&&e.jsxs("button",{onClick:f,disabled:c,className:"mt-2 min-h-[40px] px-4 py-2 bg-green-600 hover:bg-green-700 active:bg-green-800 disabled:bg-slate-700 disabled:cursor-not-allowed text-white rounded-lg font-semibold text-sm transition-all flex items-center justify-center gap-2 touch-manipulation","aria-label":"–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É",children:[e.jsx(de,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{children:c?"–û–±—Ä–∞–±–æ—Ç–∫–∞...":"–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"})]})]})]})})})()]}),e.jsxs("div",{className:"mt-6 p-5 bg-slate-900/50 rounded-xl border border-slate-700",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-300 font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] mb-1",children:"UUID / –ö–ª—é—á –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"}),s.uuid&&e.jsx("p",{className:"text-slate-500 text-xs",children:"–í–∞—à —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –¥–ª—è VPN –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è"})]}),s.uuid?e.jsxs("button",{onClick:()=>h(!0),className:"btn-icon-only-mobile min-h-[44px] w-full sm:w-auto px-4 sm:px-5 py-2.5 sm:py-3 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] rounded-lg sm:rounded-xl transition-all flex items-center justify-center gap-2 touch-manipulation whitespace-nowrap","aria-label":"–ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é",children:[e.jsx(ye,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"btn-text",children:"–ü–æ–∫–∞–∑–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é"})]}):e.jsxs("button",{onClick:q,className:"btn-icon-only-mobile min-h-[44px] w-full sm:w-auto px-4 sm:px-5 py-2.5 sm:py-3 bg-green-600 hover:bg-green-700 active:bg-green-800 text-white text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] rounded-lg sm:rounded-xl transition-all flex items-center justify-center gap-2 touch-manipulation whitespace-nowrap","aria-label":"–ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á",children:[e.jsx(Ve,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{className:"btn-text",children:"–ü–æ–ª—É—á–∏—Ç—å –∫–ª—é—á"})]})]}),s.uuid&&e.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[e.jsx("code",{className:"flex-1 bg-slate-950 p-3 sm:p-4 rounded-lg text-slate-300 text-xs sm:text-sm font-mono break-all min-w-0 border border-slate-800",children:s.uuid}),e.jsxs("button",{onClick:()=>J(s.uuid),className:"btn-icon-only-mobile min-h-[44px] min-w-[44px] px-4 py-2.5 bg-slate-700 hover:bg-slate-600 active:bg-slate-500 text-white rounded-lg transition-all flex items-center justify-center touch-manipulation sm:w-auto w-full",title:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å UUID","aria-label":"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å UUID",children:[e.jsx(Ne,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"btn-text sm:hidden ml-2",children:"–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å"})]})]})]}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3",children:[_.status==="expired"&&e.jsxs("button",{onClick:f,disabled:c,className:"flex-1 min-h-[44px] px-5 sm:px-6 py-3 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 disabled:bg-slate-700 disabled:cursor-not-allowed text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all flex items-center justify-center gap-2 touch-manipulation","aria-label":"–ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É",children:[e.jsx(ge,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{children:c?"–ü—Ä–æ–¥–ª–µ–Ω–∏–µ...":"–ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"})]}),s?.paymentStatus==="unpaid"&&(()=>{const n=s.unpaidStartDate||s.testPeriodEndDate;return 5-(n?Math.floor((Date.now()-new Date(n).getTime())/(1440*60*1e3)):0)>0?e.jsxs("button",{onClick:f,disabled:c,className:"flex-1 min-h-[44px] px-5 sm:px-6 py-3 bg-green-600 hover:bg-green-700 active:bg-green-800 disabled:bg-slate-700 disabled:cursor-not-allowed text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all flex items-center justify-center gap-2 touch-manipulation","aria-label":"–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É",children:[e.jsx(de,{className:"w-4 h-4 sm:w-5 sm:h-5 flex-shrink-0"}),e.jsx("span",{children:c?"–û–±—Ä–∞–±–æ—Ç–∫–∞...":"–û–ø–ª–∞—Ç–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"})]}):null})()]})]}),_.status==="expired"&&e.jsx("button",{onClick:f,disabled:c,className:"w-full min-h-[44px] px-5 sm:px-6 py-2.5 sm:py-3 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 disabled:bg-slate-700 disabled:cursor-not-allowed text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all flex items-center justify-center touch-manipulation","aria-label":"–ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É",children:c?"–ü—Ä–æ–¥–ª–µ–Ω–∏–µ...":"–ü—Ä–æ–¥–ª–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"})]})]}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-[clamp(1.125rem,1rem+0.625vw,1.5rem)] font-bold text-slate-200 mb-3 sm:mb-4 md:mb-5",children:"–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-5 md:gap-6",children:l.filter(n=>n.active&&(n.name==="Super"||n.name==="MULTI")).map(n=>{const w=n.name==="Super",R=w?[`${n.devices} ${n.devices===1?"–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ":"–£—Å—Ç—Ä–æ–π—Å—Ç–≤"}`,"–û–±—Ö–æ–¥ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞","–ü—Ä–æ—Ç–æ–∫–æ–ª VLESS"]:[`${n.devices} ${n.devices===1?"–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ":"–£—Å—Ç—Ä–æ–π—Å—Ç–≤"}`,"–í—ã—Å–æ–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å —Ç—Ä–∞—Ñ–∏–∫–∞","–ë–µ–∑ –æ–±—Ö–æ–¥–∞ –±–µ–ª–æ–≥–æ —Å–ø–∏—Å–∫–∞"];return e.jsxs("div",{className:"bg-slate-800 rounded-lg sm:rounded-xl p-5 sm:p-6 border border-slate-700 flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-5",children:[e.jsx("h3",{className:"text-[clamp(1.5rem,1.3rem+1vw,2.25rem)] font-bold text-white",children:n.name}),w&&e.jsx("span",{className:"px-2.5 sm:px-3 py-1 sm:py-1.5 bg-blue-600 text-white text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] font-bold rounded-full",children:"–•–ò–¢"})]}),e.jsxs("div",{className:"mb-4 sm:mb-5",children:[e.jsx("span",{className:"text-[clamp(2rem,1.8rem+1vw,3rem)] font-bold text-blue-400",children:n.price}),e.jsx("span",{className:"text-slate-400 ml-2 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:"‚ÇΩ/–º–µ—Å"})]}),e.jsx("ul",{className:"space-y-2 sm:space-y-2.5 mb-6 sm:mb-7 flex-1",children:R.map((ee,Q)=>e.jsxs("li",{className:"flex items-center gap-2 text-slate-300 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)]",children:[e.jsx(me,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400 flex-shrink-0"}),e.jsx("span",{children:ee})]},Q))}),e.jsxs("button",{onClick:()=>T(n),disabled:c,className:"w-full min-h-[44px] px-5 sm:px-6 py-2.5 sm:py-3 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 disabled:bg-slate-700 disabled:cursor-not-allowed text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all flex items-center justify-center touch-manipulation mt-auto","aria-label":`–í—ã–±—Ä–∞—Ç—å —Ç–∞—Ä–∏—Ñ ${n.name}`,children:["–í—ã–±—Ä–∞—Ç—å ",n.name==="Super"?"Super":n.name]})]},n.id)})})]})}),d==="profile"&&e.jsxs("div",{className:"bg-slate-900 rounded-lg sm:rounded-xl shadow-xl border border-slate-800 p-4 sm:p-5 md:p-6",children:[e.jsx("h2",{className:"text-[clamp(1.125rem,1rem+0.625vw,1.5rem)] font-bold text-slate-200 mb-4 sm:mb-5 md:mb-6",children:"–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è"}),e.jsxs("div",{className:"space-y-4 sm:space-y-5 md:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"profile-email",className:"block text-slate-300 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] font-bold mb-1.5 sm:mb-2",children:"Email"}),e.jsx("input",{id:"profile-email",name:"profile-email",type:"email",value:s.email,disabled:!0,className:"w-full min-h-[44px] px-3 sm:px-4 py-2.5 sm:py-3 bg-slate-900 border border-slate-700 rounded-lg sm:rounded-xl text-slate-400 text-base cursor-not-allowed"},"profile-email-input-disabled"),e.jsx("p",{className:"text-slate-500 text-[clamp(0.75rem,0.7rem+0.25vw,0.875rem)] mt-1.5",children:"Email –Ω–µ–ª—å–∑—è –∏–∑–º–µ–Ω–∏—Ç—å"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"profile-name",className:"block text-slate-300 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] font-bold mb-1.5 sm:mb-2",children:"–ò–º—è"}),g?e.jsx("input",{id:"profile-name",name:"profile-name",type:"text",value:m.name||"",onChange:W,placeholder:"–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è",className:"w-full min-h-[44px] px-3 sm:px-4 py-2.5 sm:py-3 bg-slate-900 border border-slate-700 rounded-lg sm:rounded-xl text-slate-200 text-base focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all touch-manipulation",autoFocus:!1},"profile-name-input"):e.jsx("div",{className:"min-h-[44px] px-3 sm:px-4 py-2.5 sm:py-3 bg-slate-900 border border-slate-700 rounded-lg sm:rounded-xl text-slate-200 text-base flex items-center",children:s.name||e.jsx("span",{className:"text-slate-500",children:"–ù–µ —É–∫–∞–∑–∞–Ω–æ"})})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"profile-phone",className:"block text-slate-300 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] font-bold mb-1.5 sm:mb-2",children:"–ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞"}),g?e.jsx("input",{id:"profile-phone",name:"profile-phone",type:"tel",value:m.phone||"",onChange:j,placeholder:"+7 (999) 123-45-67",className:"w-full min-h-[44px] px-3 sm:px-4 py-2.5 sm:py-3 bg-slate-900 border border-slate-700 rounded-lg sm:rounded-xl text-slate-200 text-base focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all touch-manipulation",autoFocus:!1},"profile-phone-input"):e.jsx("div",{className:"min-h-[44px] px-3 sm:px-4 py-2.5 sm:py-3 bg-slate-900 border border-slate-700 rounded-lg sm:rounded-xl text-slate-200 text-base flex items-center",children:s.phone||e.jsx("span",{className:"text-slate-500",children:"–ù–µ —É–∫–∞–∑–∞–Ω–æ"})})]}),e.jsx("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:g?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:k,className:"min-h-[44px] w-full sm:w-auto px-5 sm:px-6 py-2.5 sm:py-3 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all flex items-center justify-center touch-manipulation","aria-label":"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ—Ñ–∏–ª—å",children:"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"}),e.jsx("button",{onClick:()=>u(!1),className:"min-h-[44px] w-full sm:w-auto px-5 sm:px-6 py-2.5 sm:py-3 bg-slate-700 hover:bg-slate-600 active:bg-slate-500 text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all flex items-center justify-center touch-manipulation","aria-label":"–û—Ç–º–µ–Ω–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è",children:"–û—Ç–º–µ–Ω–∞"})]}):e.jsx("button",{onClick:()=>u(!0),className:"min-h-[44px] w-full sm:w-auto px-5 sm:px-6 py-2.5 sm:py-3 bg-blue-600 hover:bg-blue-700 active:bg-blue-800 text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all flex items-center justify-center touch-manipulation","aria-label":"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å",children:"–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å"})}),e.jsxs("div",{className:"border-t border-slate-800 pt-4 sm:pt-5 md:pt-6",children:[e.jsx("h3",{className:"text-[clamp(1rem,0.95rem+0.25vw,1.125rem)] sm:text-lg font-semibold text-red-400 mb-3 sm:mb-4",children:"–û–ø–∞—Å–Ω–∞—è –∑–æ–Ω–∞"}),e.jsx("button",{onClick:U,className:"min-h-[44px] w-full sm:w-auto px-5 sm:px-6 py-2.5 sm:py-3 bg-red-600 hover:bg-red-700 active:bg-red-800 text-white rounded-lg sm:rounded-xl font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all flex items-center justify-center touch-manipulation","aria-label":"–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç",children:"–£–¥–∞–ª–∏—Ç—å –∞–∫–∫–∞—É–Ω—Ç"})]})]})]}),d==="payments"&&e.jsxs("div",{className:"bg-slate-900 rounded-lg sm:rounded-xl shadow-xl border border-slate-800 p-4 sm:p-5 md:p-6",children:[e.jsx("h2",{className:"text-[clamp(1.125rem,1rem+0.625vw,1.5rem)] font-bold text-slate-200 mb-4 sm:mb-5 md:mb-6",children:"–ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π"}),P?e.jsx("div",{className:"flex items-center justify-center py-8 sm:py-10 md:py-12",children:e.jsx("div",{className:"w-7 h-7 sm:w-8 sm:h-8 border-2 border-slate-600 border-t-blue-600 rounded-full animate-spin"})}):I.length===0?e.jsx("p",{className:"text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] text-slate-400 text-center py-8 sm:py-10 md:py-12",children:"–ù–µ—Ç –ø–ª–∞—Ç–µ–∂–µ–π"}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"md:hidden space-y-3",children:I.map(n=>e.jsx("div",{className:"bg-slate-800 rounded-lg p-4 border border-slate-700",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase",children:"–î–∞—Ç–∞"}),e.jsx("p",{className:"text-slate-200 mt-0.5 text-sm",children:y(n.createdAt)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase",children:"–¢–∞—Ä–∏—Ñ"}),e.jsx("p",{className:"text-slate-200 mt-0.5 text-sm",children:n.tariffName||"–ù–µ —É–∫–∞–∑–∞–Ω"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase",children:"–°—É–º–º–∞"}),e.jsxs("p",{className:"text-slate-200 font-semibold mt-0.5 text-sm",children:[n.amount," ‚ÇΩ"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-slate-400 uppercase",children:"–°—Ç–∞—Ç—É—Å"}),e.jsx("div",{className:"mt-0.5",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${n.status==="completed"?"bg-green-900/30 text-green-400":"bg-slate-700 text-slate-400"}`,children:n.status==="completed"?"–û–ø–ª–∞—á–µ–Ω–æ":n.status})})]})]})},n.id))}),e.jsx("div",{className:"hidden md:block overflow-x-auto -mx-2 sm:mx-0",children:e.jsx("div",{className:"inline-block min-w-full align-middle",children:e.jsxs("table",{className:"min-w-full divide-y divide-slate-800",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-slate-800",children:[e.jsx("th",{className:"text-left py-3 px-2 sm:px-4 text-slate-400 font-semibold text-xs sm:text-sm",children:"–î–∞—Ç–∞"}),e.jsx("th",{className:"text-left py-3 px-2 sm:px-4 text-slate-400 font-semibold text-xs sm:text-sm",children:"–¢–∞—Ä–∏—Ñ"}),e.jsx("th",{className:"text-left py-3 px-2 sm:px-4 text-slate-400 font-semibold text-xs sm:text-sm",children:"–°—É–º–º–∞"}),e.jsx("th",{className:"text-left py-3 px-2 sm:px-4 text-slate-400 font-semibold text-xs sm:text-sm",children:"–°—Ç–∞—Ç—É—Å"})]})}),e.jsx("tbody",{children:I.map(n=>e.jsxs("tr",{className:"border-b border-slate-800 hover:bg-slate-800/50",children:[e.jsx("td",{className:"py-3 px-2 sm:px-4 text-slate-300 text-xs sm:text-sm",children:y(n.createdAt)}),e.jsx("td",{className:"py-3 px-2 sm:px-4 text-slate-300 text-xs sm:text-sm",children:n.tariffName||"–ù–µ —É–∫–∞–∑–∞–Ω"}),e.jsxs("td",{className:"py-3 px-2 sm:px-4 text-slate-300 font-semibold text-xs sm:text-sm",children:[n.amount," ‚ÇΩ"]}),e.jsx("td",{className:"py-3 px-2 sm:px-4",children:e.jsx("span",{className:`px-2 sm:px-3 py-1 rounded-full text-xs font-semibold ${n.status==="completed"?"bg-green-900/30 text-green-400":"bg-slate-800 text-slate-400"}`,children:n.status==="completed"?"–û–ø–ª–∞—á–µ–Ω–æ":n.status})})]},n.id))})]})})})]})]}),se&&s&&e.jsx(Je,{user:s,onClose:()=>h(!1),settings:X,onCopy:J,formatDate:y}),be&&E&&e.jsx(Ze,{tariff:E,onClose:()=>{ie(!1),ne(null)},onConfirm:N,isLoading:c,natrockPorts:X?.natrockPorts||[],settings:X}),we&&G&&e.jsx(Qe,{vpnLink:G.vpnLink,onClose:()=>{xe(!1),te(null)},onCopy:J,tariffName:G.tariffName||s.tariffName||"–ù–µ —É–∫–∞–∑–∞–Ω",devices:G.devices||s.devices||1,periodMonths:G.periodMonths||s.periodMonths||1,expiresAt:G.expiresAt||s.expiresAt||null,paymentStatus:G.paymentStatus||s.paymentStatus||"paid",testPeriod:G.testPeriod||G.paymentStatus==="test_period"||!1}),oe&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-2 sm:p-4 bg-black/60 backdrop-blur-md",onClick:()=>z(!1),children:e.jsxs("div",{className:"bg-slate-900 border border-slate-800 w-full max-w-md rounded-xl sm:rounded-2xl overflow-hidden shadow-2xl",onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"p-4 sm:p-5 md:p-6 border-b border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-red-500/20 rounded-lg",children:e.jsx(le,{className:"w-6 h-6 text-red-400"})}),e.jsx("h3",{className:"text-[clamp(1.125rem,1rem+0.625vw,1.5rem)] font-bold text-white",children:"–û—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É?"})]}),e.jsx("p",{className:"text-slate-300 text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] mt-3",children:"–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞–ª–∏—Ç –≤–∞—à—É VPN –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∏ –ø—Ä–µ–∫—Ä–∞—Ç–∏—Ç –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–∏—Å—É."}),e.jsx("div",{className:"mt-4 p-3 bg-yellow-900/20 border border-yellow-800/50 rounded-lg",children:e.jsxs("p",{className:"text-yellow-300 text-xs sm:text-sm",children:[e.jsx("strong",{children:"–í–Ω–∏–º–∞–Ω–∏–µ:"})," –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å. –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ñ–æ—Ä–º–∏—Ç—å –Ω–æ–≤—É—é –ø–æ–¥–ø–∏—Å–∫—É –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞."]})})]}),e.jsxs("div",{className:"p-4 sm:p-5 md:p-6 flex flex-col sm:flex-row gap-3",children:[e.jsx("button",{onClick:()=>z(!1),disabled:p,className:"flex-1 min-h-[44px] px-4 py-3 bg-slate-700 hover:bg-slate-600 active:bg-slate-500 text-white rounded-lg font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all disabled:opacity-50 disabled:cursor-not-allowed touch-manipulation","aria-label":"–û—Ç–º–µ–Ω–∞",children:"–û—Ç–º–µ–Ω–∞"}),e.jsx("button",{onClick:A,disabled:p||c,className:"flex-1 min-h-[44px] px-4 py-3 bg-red-600 hover:bg-red-700 active:bg-red-800 text-white rounded-lg font-semibold text-[clamp(0.875rem,0.8rem+0.375vw,1rem)] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 touch-manipulation","aria-label":"–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ",children:p||c?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-4 h-4 sm:w-5 sm:h-5 animate-spin"}),e.jsx("span",{children:"–£–¥–∞–ª–µ–Ω–∏–µ..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Ee,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{children:"–î–∞, –æ—Ç–º–µ–Ω–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"})]})})]})]})})]}),C&&e.jsx(Le,{onClose:()=>K(!1)})]})};export{as as D,Me as _,Ue as a,He as d};
