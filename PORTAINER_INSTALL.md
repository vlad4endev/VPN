# üê≥ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —á–µ—Ä–µ–∑ Portainer - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

> –ü—Ä–æ—Å—Ç–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è SkyPuth VPN —á–µ—Ä–µ–∑ Portainer Stack

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (3 —à–∞–≥–∞)

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ Portainer

1. –í–æ–π–¥–∏—Ç–µ –≤ Portainer UI (–æ–±—ã—á–Ω–æ `http://your-server:9000`)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Stacks** (–≤ –º–µ–Ω—é —Å–ª–µ–≤–∞)
3. –ù–∞–∂–º–∏—Ç–µ **Add stack**

---

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Stack

‚ö†Ô∏è **–ï—Å–ª–∏ –ø–æ–ª—É—á–∞–µ—Ç–µ –æ—à–∏–±–∫—É "–Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Å—Å—ã–ª–∫—É ¬´main¬ª"**, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Web Editor** (—Å–º. –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± –Ω–∏–∂–µ).

**–í–∞—Ä–∏–∞–Ω—Ç A: –ò–∑ Git Repository**

1. **Name**: `skyputh-vpn`

2. **Build method**: –í—ã–±–µ—Ä–∏—Ç–µ **Repository**

3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   ```
   Repository URL: https://github.com/vlad4endev/VPN.git
   Reference: main
   Compose path: portainer-stack.yml
   ```
   
   ‚ö†Ô∏è **–í–∞–∂–Ω–æ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–µ—Ç–∫–∞ `main` –∑–∞–ø—É—à–µ–Ω–∞ –Ω–∞ GitHub:
   ```bash
   git push -u origin main
   ```

**–í–∞—Ä–∏–∞–Ω—Ç B: Web Editor (–µ—Å–ª–∏ Repository –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)**

1. **Name**: `skyputh-vpn`
2. **Build method**: –í—ã–±–µ—Ä–∏—Ç–µ **Web editor**
3. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `portainer-stack.yml` –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞
4. –í—Å—Ç–∞–≤—å—Ç–µ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä Portainer
5. –ò–∑–º–µ–Ω–∏—Ç–µ `build.context` –Ω–∞ –ø—É—Ç—å –∫ –∫–æ–¥—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/opt/skyputh-vpn`)
6. –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑: –∑–∞–º–µ–Ω–∏—Ç–µ `build:` –Ω–∞ `image: skyputh-vpn:latest`

4. **Auto-update**: –í–∫–ª—é—á–∏—Ç–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

5. –ù–∞–∂–º–∏—Ç–µ **Next**

---

### –®–∞–≥ 3: –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–í —Ä–∞–∑–¥–µ–ª–µ **Environment variables** –¥–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:

```
XUI_HOST=http://your-3xui-server:2053
XUI_USERNAME=admin
XUI_PASSWORD=your_password
XUI_INBOUND_ID=1

VITE_FIREBASE_API_KEY=AIza...
VITE_FIREBASE_AUTH_DOMAIN=your-project.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=your-project-id
VITE_FIREBASE_STORAGE_BUCKET=your-project.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=123456789
VITE_FIREBASE_APP_ID=1:123456789:web:abc123

ALLOWED_ORIGINS=https://yourdomain.com
FRONTEND_URL=https://yourdomain.com
```

#### –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ:

```
VITE_LOG_LEVEL=warn
VITE_RECAPTCHA_SITE_KEY=your_key
```

---

### –®–∞–≥ 4: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

1. –ù–∞–∂–º–∏—Ç–µ **Deploy the stack**
2. –î–æ–∂–¥–∏—Ç–µ—Å—å —Å–±–æ—Ä–∫–∏ (–æ–±—ã—á–Ω–æ 2-5 –º–∏–Ω—É—Ç)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: **Stacks** ‚Üí `skyputh-vpn` ‚Üí **Containers**

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏

1. **Stacks** ‚Üí `skyputh-vpn`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - **Status**: Active (–∑–µ–ª–µ–Ω—ã–π)
   - –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä `skyputh-vpn`: **Running** (–∑–µ–ª–µ–Ω—ã–π)
   - **Health**: Healthy (–∑–µ–ª–µ–Ω—ã–π)

3. –û—Ç–∫—Ä–æ–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   - `http://your-server-ip:3001`
   - `https://yourdomain.com` (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω Nginx)

---

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

- **XUI_*** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (–ë–ï–ó –ø—Ä–µ—Ñ–∏–∫—Å–∞ VITE_) ‚Äî –¥–ª—è backend
- **VITE_*** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ‚Äî –¥–ª—è frontend (—Å–æ–±–∏—Ä–∞—é—Ç—Å—è –≤ build time)

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:

–ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω **Auto-update**, Portainer –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç Stack –ø—Ä–∏ push –≤ Git.

### –õ–æ–≥–∏:

- **Stacks** ‚Üí `skyputh-vpn` ‚Üí **Logs**
- –ò–ª–∏ **Containers** ‚Üí `skyputh-vpn` ‚Üí **Logs**

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Stack

1. **Stacks** ‚Üí `skyputh-vpn` ‚Üí **Pull and redeploy**
2. –ò–ª–∏ **Editor** ‚Üí –≤–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Üí **Update the stack**

---

## üÜò –ü—Ä–æ–±–ª–µ–º—ã?

### –û—à–∏–±–∫–∞: "Dockerfile: —Ç–∞–∫–æ–≥–æ —Ñ–∞–π–ª–∞ –∏–ª–∏ –∫–∞—Ç–∞–ª–æ–≥–∞ –Ω–µ—Ç"

**–ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ**:
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Dockerfile –∑–∞–ø—É—à–µ–Ω –Ω–∞ GitHub:
   ```bash
   git add Dockerfile
   git commit -m "Update Dockerfile"
   git push origin main
   ```
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ GitHub, —á—Ç–æ Dockerfile –≤–∏–¥–µ–Ω –≤ –∫–æ—Ä–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
3. –ï—Å–ª–∏ Repository –º–µ—Ç–æ–¥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Web Editor**:
   - –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä: `git clone https://github.com/vlad4endev/VPN.git /opt/skyputh-vpn`
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `portainer-stack-web-editor.yml` —Å –ø—É—Ç–µ–º `/opt/skyputh-vpn`
   - –°–º. –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ `PORTAINER_DOCKERFILE_FIX.md`

### –û—à–∏–±–∫–∞: "–Ω–µ —É–¥–∞–ª–æ—Å—å –Ω–∞–π—Ç–∏ —Å—Å—ã–ª–∫—É ¬´main¬ª"

**–†–µ—à–µ–Ω–∏–µ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **Web Editor** –º–µ—Ç–æ–¥ –≤–º–µ—Å—Ç–æ Repository:
1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `portainer-stack.yml`
2. **Build method**: **Web editor**
3. –í—Å—Ç–∞–≤—å—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞
4. –°–º. –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –≤ `PORTAINER_FIX.md`

–ò–ª–∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–µ—Ç–∫–∞ `main` –∑–∞–ø—É—à–µ–Ω–∞ –Ω–∞ GitHub:
```bash
git push -u origin main
```

### Stack –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: **Containers** ‚Üí `skyputh-vpn` ‚Üí **Logs**
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã

### Build failed:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—É—Ç—å `portainer-stack.yml` –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Dockerfile –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏
4. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Web Editor: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –≤ `build.context`

---

**–ì–æ—Ç–æ–≤–æ!** –í–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ —á–µ—Ä–µ–∑ Portainer. üéâ
