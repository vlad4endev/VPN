# üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ n8n Workflow –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞

## –û—à–∏–±–∫–∞: "Unused Respond to Webhook node found in the workflow"

–≠—Ç–∞ –æ—à–∏–±–∫–∞ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –≤ n8n workflow –µ—Å—Ç—å —É–∑–µ–ª **"Respond to Webhook"**, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ü–µ–ø–æ—á–∫–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

## –†–µ—à–µ–Ω–∏–µ

### –®–∞–≥ 1: –û—Ç–∫—Ä–æ–π—Ç–µ workflow –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ n8n: `https://n8n.skypath.fun`
2. –ù–∞–π–¥–∏—Ç–µ workflow, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ VPN
3. –û—Ç–∫—Ä–æ–π—Ç–µ –µ–≥–æ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ü–µ–ø–æ—á–∫—É —É–∑–ª–æ–≤

Workflow –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```
[Webhook] ‚Üí [HTTP Request / Delete Client in 3x-ui] ‚Üí [Respond to Webhook]
```

**–í–∞–∂–Ω–æ:**
- –£–∑–µ–ª **"Respond to Webhook"** –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–≤ –∫–æ–Ω—Ü–µ —Ü–µ–ø–æ—á–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**
- –û–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–ø–æ–¥–∫–ª—é—á–µ–Ω** –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —É–∑–ª—É (–Ω–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–º)
- –£–∑–µ–ª –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –æ—Ç–≤–µ—Ç –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –®–∞–≥ 3: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ "Respond to Webhook"

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É–∑–µ–ª "Respond to Webhook" –Ω–∞—Ö–æ–¥–∏—Ç—Å—è **–ø–æ—Å–ª–µ** —É–∑–ª–∞, –∫–æ—Ç–æ—Ä—ã–π —É–¥–∞–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ 3x-ui
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ —É–∑–µ–ª –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É —É–∑–ª—É (–ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Å—Ç—Ä–µ–ª–∫—É)
3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –æ—Ç–≤–µ—Ç:
   - **Response Code**: `200` –¥–ª—è —É—Å–ø–µ—à–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
   - **Response Body**: JSON —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º
   - –ü—Ä–∏–º–µ—Ä:
     ```json
     {
       "success": true,
       "message": "–ö–ª–∏–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω"
     }
     ```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É–∑–ª–æ–≤

- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —É–∑–ª—ã –≤ workflow **–ø–æ–¥–∫–ª—é—á–µ–Ω—ã** –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É
- –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —É–∑–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–≤—è–∑–∞–Ω—ã —Å –æ—Å–Ω–æ–≤–Ω—ã–º –ø–æ—Ç–æ–∫–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –ï—Å–ª–∏ –µ—Å—Ç—å —É–∑–ª—ã "Respond to Webhook", –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è, **—É–¥–∞–ª–∏—Ç–µ –∏—Ö**

### –®–∞–≥ 5: –ê–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ Workflow

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ workflow **–ê–ö–¢–ò–í–ï–ù** (–∑–µ–ª–µ–Ω–∞—è –∫–Ω–æ–ø–∫–∞ "Active")
2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ workflow (Ctrl+S / Cmd+S)

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ workflow

–ï—Å–ª–∏ —É –≤–∞—Å –æ—Ç–¥–µ–ª—å–Ω—ã–π workflow –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:

1. Webhook –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –º–µ—Ç–æ–¥ **POST**
2. –ü—É—Ç—å webhook —É–∫–∞–∑–∞–Ω –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:
   ```env
   N8N_WEBHOOK_DELETE_CLIENT=https://n8n.skypath.fun/webhook/your-webhook-id
   ```
3. Workflow –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–ø–µ—Ä–∞—Ü–∏—é `delete_client`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Backend Proxy

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ webhook:

```bash
curl -X POST http://localhost:3001/api/vpn/delete-client \
  -H "Content-Type: application/json" \
  -d '{
    "clientId": "test-uuid",
    "email": "test@example.com",
    "inboundId": 1
  }'
```

–ï—Å–ª–∏ workflow –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤—ã –¥–æ–ª–∂–Ω—ã –ø–æ–ª—É—á–∏—Ç—å —É—Å–ø–µ—à–Ω—ã–π –æ—Ç–≤–µ—Ç.

## –ß—Ç–æ –¥–æ–ª–∂–µ–Ω –¥–µ–ª–∞—Ç—å n8n workflow

Workflow –¥–æ–ª–∂–µ–Ω:
1. –ü—Ä–∏–Ω—è—Ç—å POST –∑–∞–ø—Ä–æ—Å –Ω–∞ webhook –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
2. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:
   - `operation`: "delete_client"
   - `category`: "subscription_cancellation"
   - `clientId`: UUID –∫–ª–∏–µ–Ω—Ç–∞ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è
   - `inboundId`: ID –∏–Ω–±–∞—É–Ω–¥–∞ 3x-ui
   - `serverIP`, `serverPort`: –î–∞–Ω–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä–∞
   - `xuiUsername`, `xuiPassword`: –£—á–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è 3x-ui
   - `sessionCookie`: –°–µ—Å—Å–∏—è (–º–æ–∂–µ—Ç –±—ã—Ç—å null)
3. –£–¥–∞–ª–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞ –∏–∑ 3x-ui —á–µ—Ä–µ–∑ API
4. –í–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç —á–µ—Ä–µ–∑ —É–∑–µ–ª "Respond to Webhook":
   ```json
   {
     "success": true,
     "message": "–ö–ª–∏–µ–Ω—Ç —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω"
   }
   ```

## –í–∞–∂–Ω–æ

- –£–∑–µ–ª "Respond to Webhook" –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å **–≤ –∫–æ–Ω—Ü–µ** —Ü–µ–ø–æ—á–∫–∏
- –ù–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —É–∑–ª–æ–≤ "Respond to Webhook" –≤ –æ–¥–Ω–æ–º workflow
- –í—Å–µ —É–∑–ª—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–ø–æ–¥–∫–ª—é—á–µ–Ω—ã** –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É
