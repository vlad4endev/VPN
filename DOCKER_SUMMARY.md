# üê≥ Docker Summary - SkyPuth VPN

## ‚úÖ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **Dockerfile** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π multi-stage build
2. **.dockerignore** ‚Äî –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –Ω–µ–Ω—É–∂–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ build context
3. **docker-compose.example.yml** ‚Äî –ø—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Docker Compose
4. **DOCKER_GUIDE.md** ‚Äî –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Docker
5. **DOCKER_README.md** ‚Äî –∫—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

## üéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ Dockerfile

### Multi-Stage Build (3 —Å—Ç–∞–¥–∏–∏)

1. **builder-frontend** (Node.js 20 Alpine)
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–≤–∫–ª—é—á–∞—è dev)
   - –°–æ–±–∏—Ä–∞–µ—Ç React/Vite frontend
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: `dist/` –ø–∞–ø–∫–∞ —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ —Ñ–∞–π–ª–∞–º–∏

2. **builder-backend** (Node.js 20 Alpine)
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ production –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è backend
   - –†–µ–∑—É–ª—å—Ç–∞—Ç: `node_modules/` –¥–ª—è server/

3. **production** (Node.js 20 Alpine)
   - –ö–æ–ø–∏—Ä—É–µ—Ç —Å–æ–±—Ä–∞–Ω–Ω—ã–π frontend
   - –ö–æ–ø–∏—Ä—É–µ—Ç backend –∫–æ–¥ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
   - –ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä: ~200MB

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

- ‚úÖ **Alpine Linux** ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑ (~50MB –≤–º–µ—Å—Ç–æ ~900MB)
- ‚úÖ **Layer caching** ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–ª–æ–µ–≤ –¥–ª—è –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ **Production only** ‚Äî —É–¥–∞–ª–µ–Ω—ã dev –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- ‚úÖ **–ù–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å** ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å (nodejs:1001)
- ‚úÖ **dumb-init** ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–≥–Ω–∞–ª–æ–≤ (graceful shutdown)
- ‚úÖ **Healthcheck** ‚Äî –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
- ‚úÖ **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã** ‚Äî Express –æ–±—Å–ª—É–∂–∏–≤–∞–µ—Ç frontend –∏–∑ `dist/`

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

```bash
docker build -t skyputh-vpn:latest .
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```bash
docker run -d \
  --name skyputh-vpn \
  -p 3001:3001 \
  --env-file .env.production \
  --restart unless-stopped \
  skyputh-vpn:latest
```

### Docker Compose

```bash
cp docker-compose.example.yml docker-compose.yml
docker-compose up -d
```

## üìä –†–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞

- **–ë–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑**: ~50MB (alpine)
- **Frontend build**: ~5-10MB (—Å–æ–±—Ä–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã)
- **Backend dependencies**: ~50MB (production —Ç–æ–ª—å–∫–æ)
- **Node.js runtime**: ~40MB
- **–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–∫–µ—Ç—ã**: ~5MB
- **–ò—Ç–æ–≥–æ**: ~200MB

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ù–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–∑ (–º–µ–Ω—å—à–µ attack surface)
- ‚úÖ –°–µ–∫—Ä–µ—Ç—ã —á–µ—Ä–µ–∑ environment variables
- ‚úÖ `.env` —Ñ–∞–π–ª—ã –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ –æ–±—Ä–∞–∑–∞
- ‚úÖ Graceful shutdown —á–µ—Ä–µ–∑ dumb-init

## üìù –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä

1. **Backend Proxy Server** (–ø–æ—Ä—Ç 3001)
   - –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç API –∑–∞–ø—Ä–æ—Å—ã –∫ 3x-ui
   - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–ª–∞—Ç–µ–∂–∏ —á–µ—Ä–µ–∑ n8n
   - –û–±—Å–ª—É–∂–∏–≤–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã frontend

2. **Frontend** (—á–µ—Ä–µ–∑ Express static)
   - –û—Ç–¥–∞–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –∏–∑ `dist/`
   - SPA —Ä–æ—É—Ç–∏–Ω–≥ (React Router)
   - API –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ–∫—Å–∏—Ä—É—é—Ç—Å—è –Ω–∞ backend

## üéØ –ì–æ—Ç–æ–≤–æ –∫ production!

–í—Å–µ —Ñ–∞–π–ª—ã —Å–æ–∑–¥–∞–Ω—ã –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã. –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é —á–µ—Ä–µ–∑ Docker.
